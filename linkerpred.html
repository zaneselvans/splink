
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://moj-analytical-services.github.io/splink/linkerpred.html">
      
      
        <link rel="prev" href="linkerest.html">
      
      
        <link rel="next" href="linkermodelviz.html">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="feed_rss_updated.xml">
      
      <link rel="icon" href="img/favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.2">
    
    
      
        <title>Predicting results - Splink</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/timeago.css">
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="css/custom.css">
    
      <link rel="stylesheet" href="css/neoteroi-mkdocs.css">
    
      <link rel="stylesheet" href="css/ansi-colours.css">
    
      <link rel="stylesheet" href="css/jupyter-cells.css">
    
      <link rel="stylesheet" href="css/pandas-dataframe.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-L6JT8NK528"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-L6JT8NK528",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-L6JT8NK528",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#documentation-for-linker-object-methods-related-to-link-prediction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Splink" class="md-header__button md-logo" aria-label="Splink" data-md-component="logo">
      
  <img src="img/favicon.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Splink
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Predicting results
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="purple" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/moj-analytical-services/splink" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="getting_started.html" class="md-tabs__link">
        
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="demos/tutorials/00_Tutorial_Introduction.html" class="md-tabs__link">
          
  
    
  
  Tutorial

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="demos/examples/examples_index.html" class="md-tabs__link">
          
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="topic_guides/topic_guides_index.html" class="md-tabs__link">
          
  
    
  
  Topic Guides

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="documentation_index.html" class="md-tabs__link">
          
  
    
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="dev_guides/index.html" class="md-tabs__link">
          
  
    
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="blog/index.html" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Splink" class="md-nav__button md-logo" aria-label="Splink" data-md-component="logo">
      
  <img src="img/favicon.ico" alt="logo">

    </a>
    Splink
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/moj-analytical-services/splink" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="getting_started.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/tutorials/00_Tutorial_Introduction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/tutorials/01_Prerequisites.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Data prep prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/tutorials/02_Exploratory_analysis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Exploratory analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/tutorials/03_Blocking.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Blocking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/tutorials/04_Estimating_model_parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Estimating model parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/tutorials/05_Predicting_results.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Predicting results
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/tutorials/06_Visualising_predictions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Visualising predictions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/tutorials/07_Evaluation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Evaluation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/examples_index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DuckDB
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            DuckDB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/deduplicate_50k_synthetic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deduplicate 50k rows historical persons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/transactions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linking financial transactions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/link_only.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linking two tables of persons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/real_time_record_linkage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Real time record linkage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/accuracy_analysis_from_labels_column.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluation from ground truth column
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/pairwise_labels.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estimating m probabilities from labels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/quick_and_dirty_persons.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick and dirty persons model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/deterministic_dedupe.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deterministic dedupe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/febrl3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Febrl3 Dedupe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/duckdb/febrl4.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Febrl4 link-only
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PySpark
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            PySpark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/spark/deduplicate_1k_synthetic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deduplication using Pyspark
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Athena
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Athena
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/athena/deduplicate_50k_synthetic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deduplicate 50k rows historical persons
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    SQLite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            SQLite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="demos/examples/sqlite/deduplicate_50k_synthetic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deduplicate 50k rows historical persons
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Topic Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Topic Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/topic_guides_index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Record Linkage Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Record Linkage Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/theory/record_linkage.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why do we need record linkage?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/theory/probabilistic_vs_deterministic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probabilistic vs Deterministic linkage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/theory/fellegi_sunter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Fellegi-Sunter Model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Linkage Models in Splink
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Linkage Models in Splink
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3_1" >
        
          
          <label class="md-nav__link" for="__nav_5_3_1" id="__nav_5_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Splink's SQL backends - Spark, DuckDB etc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3_1">
            <span class="md-nav__icon md-icon"></span>
            Splink's SQL backends - Spark, DuckDB etc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/splink_fundamentals/backends/backends.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backends overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/splink_fundamentals/backends/postgres.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostgreSQL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/splink_fundamentals/link_type.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Link type - linking vs deduping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/splink_fundamentals/settings.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining Splink models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/splink_fundamentals/querying_splink_results.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Retrieving and querying Splink results
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Preparation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Data Preparation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/data_preparation/feature_engineering.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Engineering
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blocking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Blocking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/blocking/blocking_rules.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What are Blocking Rules?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/blocking/predictions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prediction Blocking Rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/blocking/model_training.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Training Blocking Rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/blocking/performance.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Computational Performance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Comparing Records
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Comparing Records
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/customising_comparisons.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining and customising comparisons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/comparison_templates.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Out-of-the-box comparisons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6_3" >
        
          
          <label class="md-nav__link" for="__nav_5_6_3" id="__nav_5_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Comparing strings
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6_3">
            <span class="md-nav__icon md-icon"></span>
            Comparing strings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/choosing_comparators.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Choosing comparators and thresholds
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/comparators.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    String comparators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/phonetic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phonetic transformations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/regular_expressions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regular Expressions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/term-frequency.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Term-Frequency adjustments
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Evaluation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Evaluation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/evaluation/overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/evaluation/model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_3" >
        
          
          <label class="md-nav__link" for="__nav_5_7_3" id="__nav_5_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Edges (Links)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7_3">
            <span class="md-nav__icon md-icon"></span>
            Edges (Links)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/evaluation/edge_overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/evaluation/edge_metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Edge Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/evaluation/labelling.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clerical Labelling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/evaluation/clusters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clusters
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Performance
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Performance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/performance/drivers_of_performance.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run times, performance and linking large data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8_2" >
        
          
          <label class="md-nav__link" for="__nav_5_8_2" id="__nav_5_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Spark Performance
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_2">
            <span class="md-nav__icon md-icon"></span>
            Spark Performance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/performance/optimising_spark.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimising Spark performance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/performance/salting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Salting blocking rules
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8_3" >
        
          
          <label class="md-nav__link" for="__nav_5_8_3" id="__nav_5_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DuckDB Performance
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_3">
            <span class="md-nav__icon md-icon"></span>
            DuckDB Performance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/performance/optimising_duckdb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimising DuckDB performance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="documentation_index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" checked>
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_6_2_1" id="__nav_6_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Linker API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_2_1">
            <span class="md-nav__icon md-icon"></span>
            Linker API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linker.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Full API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linkerexp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exploratory analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linkerbloc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blocking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linkerest.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estimating model parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Predicting results
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="linkerpred.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Predicting results
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker" class="md-nav__link">
    <span class="md-ellipsis">
      Linker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.__deepcopy__" class="md-nav__link">
    <span class="md-ellipsis">
      __deepcopy__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.accuracy_chart_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      accuracy_chart_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.accuracy_chart_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      accuracy_chart_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.cluster_pairwise_predictions_at_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      cluster_pairwise_predictions_at_threshold
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.cluster_studio_dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      cluster_studio_dashboard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.compare_two_records" class="md-nav__link">
    <span class="md-ellipsis">
      compare_two_records
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.comparison_viewer_dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      comparison_viewer_dashboard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.completeness_chart" class="md-nav__link">
    <span class="md-ellipsis">
      completeness_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.compute_graph_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      compute_graph_metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.compute_tf_table" class="md-nav__link">
    <span class="md-ellipsis">
      compute_tf_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.confusion_matrix_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.confusion_matrix_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.count_num_comparisons_from_blocking_rule" class="md-nav__link">
    <span class="md-ellipsis">
      count_num_comparisons_from_blocking_rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.count_num_comparisons_from_blocking_rules_for_prediction" class="md-nav__link">
    <span class="md-ellipsis">
      count_num_comparisons_from_blocking_rules_for_prediction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.cumulative_comparisons_from_blocking_rules_records" class="md-nav__link">
    <span class="md-ellipsis">
      cumulative_comparisons_from_blocking_rules_records
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.cumulative_num_comparisons_from_blocking_rules_chart" class="md-nav__link">
    <span class="md-ellipsis">
      cumulative_num_comparisons_from_blocking_rules_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.deterministic_link" class="md-nav__link">
    <span class="md-ellipsis">
      deterministic_link
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_m_from_label_column" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_m_from_label_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_m_from_pairwise_labels" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_m_from_pairwise_labels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_parameters_using_expectation_maximisation" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_parameters_using_expectation_maximisation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_probability_two_random_records_match" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_probability_two_random_records_match
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_u_using_random_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_u_using_random_sampling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.find_matches_to_new_records" class="md-nav__link">
    <span class="md-ellipsis">
      find_matches_to_new_records
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.initialise_settings" class="md-nav__link">
    <span class="md-ellipsis">
      initialise_settings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.invalidate_cache" class="md-nav__link">
    <span class="md-ellipsis">
      invalidate_cache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.labelling_tool_for_specific_record" class="md-nav__link">
    <span class="md-ellipsis">
      labelling_tool_for_specific_record
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.load_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.load_settings" class="md-nav__link">
    <span class="md-ellipsis">
      load_settings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.load_settings_from_json" class="md-nav__link">
    <span class="md-ellipsis">
      load_settings_from_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.m_u_parameters_chart" class="md-nav__link">
    <span class="md-ellipsis">
      m_u_parameters_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.match_weights_chart" class="md-nav__link">
    <span class="md-ellipsis">
      match_weights_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.match_weights_histogram" class="md-nav__link">
    <span class="md-ellipsis">
      match_weights_histogram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.missingness_chart" class="md-nav__link">
    <span class="md-ellipsis">
      missingness_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.parameter_estimate_comparisons_chart" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_estimate_comparisons_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.precision_recall_chart_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      precision_recall_chart_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.precision_recall_chart_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      precision_recall_chart_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.prediction_errors_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      prediction_errors_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.prediction_errors_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      prediction_errors_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.profile_columns" class="md-nav__link">
    <span class="md-ellipsis">
      profile_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.query_sql" class="md-nav__link">
    <span class="md-ellipsis">
      query_sql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.register_table" class="md-nav__link">
    <span class="md-ellipsis">
      register_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.register_table_input_nodes_concat_with_tf" class="md-nav__link">
    <span class="md-ellipsis">
      register_table_input_nodes_concat_with_tf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.roc_chart_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      roc_chart_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.roc_chart_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      roc_chart_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.save_model_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      save_model_to_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.save_settings_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      save_settings_to_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.tf_adjustment_chart" class="md-nav__link">
    <span class="md-ellipsis">
      tf_adjustment_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.truth_space_table_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      truth_space_table_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.truth_space_table_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      truth_space_table_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.unlinkables_chart" class="md-nav__link">
    <span class="md-ellipsis">
      unlinkables_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.waterfall_chart" class="md-nav__link">
    <span class="md-ellipsis">
      waterfall_chart
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linkermodelviz.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visualisation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linkereval.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2_2" id="__nav_6_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Comparisons Library API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_2">
            <span class="md-nav__icon md-icon"></span>
            Comparisons Library API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="comparison_template_library.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison Template Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="comparison_library.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="comparison_level_library.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison Level Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="comparison_level_composition.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison Composition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="comparison_helpers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison Helpers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_3" >
        
          
          <label class="md-nav__link" for="__nav_6_2_3" id="__nav_6_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blocking Rule Library API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_3">
            <span class="md-nav__icon md-icon"></span>
            Blocking Rule Library API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="blocking_rule_library.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blocking Rule Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="blocking_rule_composition.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blocking Rule Composition
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="em_training_session.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EM Training Session API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SplinkDataFrame.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SplinkDataFrame API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_6" >
        
          
          <label class="md-nav__link" for="__nav_6_2_6" id="__nav_6_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Comparisons API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_6">
            <span class="md-nav__icon md-icon"></span>
            Comparisons API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="comparison.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="comparison_level.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comparison Level
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="charts/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Charts Gallery
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Charts Gallery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_2" >
        
          
          <label class="md-nav__link" for="__nav_6_3_2" id="__nav_6_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Exploratory Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_2">
            <span class="md-nav__icon md-icon"></span>
            Exploratory Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/completeness_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    completeness chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/missingness_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    missingness chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/profile_columns.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    profile columns
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3_3" id="__nav_6_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blocking
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_3">
            <span class="md-nav__icon md-icon"></span>
            Blocking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/cumulative_num_comparisons_from_blocking_rules_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cumulative num comparisons from blocking rules chart
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_4" >
        
          
          <label class="md-nav__link" for="__nav_6_3_4" id="__nav_6_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Comparison Helpers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_4">
            <span class="md-nav__icon md-icon"></span>
            Comparison Helpers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/choosing_comparators.html#comparing-string-similarity-and-distance-scores" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    comparator score chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/choosing_comparators.html#choosing-thresholds" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    comparator score threshold chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topic_guides/comparisons/choosing_comparators.html#phonetic-matching" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    phonetic match chart
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_5" >
        
          
          <label class="md-nav__link" for="__nav_6_3_5" id="__nav_6_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model Training
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_5">
            <span class="md-nav__icon md-icon"></span>
            Model Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/comparison_viewer_dashboard.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    comparison viewer dashboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/match_weights_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    match weights chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/m_u_parameters_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    m u parameters chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/parameter_estimate_comparisons_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parameter estimate comparisons chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/tf_adjustment_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tf adjustment chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/unlinkables_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    unlinkables chart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/waterfall_chart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    waterfall chart
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_6" >
        
          
          <label class="md-nav__link" for="__nav_6_3_6" id="__nav_6_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Clustering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_6">
            <span class="md-nav__icon md-icon"></span>
            Clustering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/cluster_studio_dashboard.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cluster studio dashboard
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_7" >
        
          
          <label class="md-nav__link" for="__nav_6_3_7" id="__nav_6_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model Evaluation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_7">
            <span class="md-nav__icon md-icon"></span>
            Model Evaluation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/accuracy_chart_from_labels_table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    accuracy chart from labels table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/confusion_matrix_from_labels_table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    confusion matrix from labels table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/precision_recall_chart_from_labels_table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    precision recall chart from labels table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="charts/roc_chart_from_labels_table.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    roc chart fromm labels table
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    In-built datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Settings
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Settings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="settings_dict_guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings Dictionary Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="settingseditor/editor.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interactive Settings Editor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="dev_guides/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contributing to Splink
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Contributing to Splink
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="CONTRIBUTING.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributor Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/changing_splink/building_env_locally.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building a Virtual Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/changing_splink/lint_and_format.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linting and Formatting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/changing_splink/testing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/changing_splink/build_docs_locally.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building Docs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/changing_splink/releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releasing a Package Version
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/changing_splink/blog_posts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing to the Splink Blog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How Splink works
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            How Splink works
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/debug_modes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding and debugging Splink
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/transpilation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transpilation using sqlglot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3_3" id="__nav_7_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Performance and caching
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3_3">
            <span class="md-nav__icon md-icon"></span>
            Performance and caching
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/caching.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Caching and pipelining
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/spark_pipelining_and_caching.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark caching
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_4" >
        
          
          <label class="md-nav__link" for="__nav_7_3_4" id="__nav_7_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Comparison and comparison level libraries
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3_4">
            <span class="md-nav__icon md-icon"></span>
            Comparison and comparison level libraries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/comparisons/new_library_comparisons_and_levels.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating new comparisons and comparison levels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/comparisons/extending_library_comparisons_and_levels.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending existing comparisons and comparison levels
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_5" >
        
          
          <label class="md-nav__link" for="__nav_7_3_5" id="__nav_7_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Charts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3_5">
            <span class="md-nav__icon md-icon"></span>
            Charts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/charts/understanding_and_editing_charts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding and editing charts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/charts/building_charts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building new charts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/udfs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User-Defined Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3_7" >
        
          
          <label class="md-nav__link" for="__nav_7_3_7" id="__nav_7_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Settings Validation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3_7">
            <span class="md-nav__icon md-icon"></span>
            Settings Validation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/settings_validation/settings_validation_overview.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings Validation Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/settings_validation/extending_settings_validator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending the Settings Validator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_guides/dependency_management.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Splink Dependency Management
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="blog/index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="blog/category/ethics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ethics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="blog/category/feature-updates.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Updates
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker" class="md-nav__link">
    <span class="md-ellipsis">
      Linker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.__deepcopy__" class="md-nav__link">
    <span class="md-ellipsis">
      __deepcopy__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.accuracy_chart_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      accuracy_chart_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.accuracy_chart_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      accuracy_chart_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.cluster_pairwise_predictions_at_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      cluster_pairwise_predictions_at_threshold
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.cluster_studio_dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      cluster_studio_dashboard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.compare_two_records" class="md-nav__link">
    <span class="md-ellipsis">
      compare_two_records
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.comparison_viewer_dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      comparison_viewer_dashboard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.completeness_chart" class="md-nav__link">
    <span class="md-ellipsis">
      completeness_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.compute_graph_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      compute_graph_metrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.compute_tf_table" class="md-nav__link">
    <span class="md-ellipsis">
      compute_tf_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.confusion_matrix_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.confusion_matrix_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      confusion_matrix_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.count_num_comparisons_from_blocking_rule" class="md-nav__link">
    <span class="md-ellipsis">
      count_num_comparisons_from_blocking_rule
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.count_num_comparisons_from_blocking_rules_for_prediction" class="md-nav__link">
    <span class="md-ellipsis">
      count_num_comparisons_from_blocking_rules_for_prediction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.cumulative_comparisons_from_blocking_rules_records" class="md-nav__link">
    <span class="md-ellipsis">
      cumulative_comparisons_from_blocking_rules_records
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.cumulative_num_comparisons_from_blocking_rules_chart" class="md-nav__link">
    <span class="md-ellipsis">
      cumulative_num_comparisons_from_blocking_rules_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.deterministic_link" class="md-nav__link">
    <span class="md-ellipsis">
      deterministic_link
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_m_from_label_column" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_m_from_label_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_m_from_pairwise_labels" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_m_from_pairwise_labels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_parameters_using_expectation_maximisation" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_parameters_using_expectation_maximisation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_probability_two_random_records_match" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_probability_two_random_records_match
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.estimate_u_using_random_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_u_using_random_sampling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.find_matches_to_new_records" class="md-nav__link">
    <span class="md-ellipsis">
      find_matches_to_new_records
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.initialise_settings" class="md-nav__link">
    <span class="md-ellipsis">
      initialise_settings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.invalidate_cache" class="md-nav__link">
    <span class="md-ellipsis">
      invalidate_cache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.labelling_tool_for_specific_record" class="md-nav__link">
    <span class="md-ellipsis">
      labelling_tool_for_specific_record
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.load_model" class="md-nav__link">
    <span class="md-ellipsis">
      load_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.load_settings" class="md-nav__link">
    <span class="md-ellipsis">
      load_settings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.load_settings_from_json" class="md-nav__link">
    <span class="md-ellipsis">
      load_settings_from_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.m_u_parameters_chart" class="md-nav__link">
    <span class="md-ellipsis">
      m_u_parameters_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.match_weights_chart" class="md-nav__link">
    <span class="md-ellipsis">
      match_weights_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.match_weights_histogram" class="md-nav__link">
    <span class="md-ellipsis">
      match_weights_histogram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.missingness_chart" class="md-nav__link">
    <span class="md-ellipsis">
      missingness_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.parameter_estimate_comparisons_chart" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_estimate_comparisons_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.precision_recall_chart_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      precision_recall_chart_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.precision_recall_chart_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      precision_recall_chart_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.prediction_errors_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      prediction_errors_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.prediction_errors_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      prediction_errors_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.profile_columns" class="md-nav__link">
    <span class="md-ellipsis">
      profile_columns
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.query_sql" class="md-nav__link">
    <span class="md-ellipsis">
      query_sql
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.register_table" class="md-nav__link">
    <span class="md-ellipsis">
      register_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.register_table_input_nodes_concat_with_tf" class="md-nav__link">
    <span class="md-ellipsis">
      register_table_input_nodes_concat_with_tf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.roc_chart_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      roc_chart_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.roc_chart_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      roc_chart_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.save_model_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      save_model_to_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.save_settings_to_json" class="md-nav__link">
    <span class="md-ellipsis">
      save_settings_to_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.tf_adjustment_chart" class="md-nav__link">
    <span class="md-ellipsis">
      tf_adjustment_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.truth_space_table_from_labels_column" class="md-nav__link">
    <span class="md-ellipsis">
      truth_space_table_from_labels_column
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.truth_space_table_from_labels_table" class="md-nav__link">
    <span class="md-ellipsis">
      truth_space_table_from_labels_table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.unlinkables_chart" class="md-nav__link">
    <span class="md-ellipsis">
      unlinkables_chart
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splink.linker.Linker.waterfall_chart" class="md-nav__link">
    <span class="md-ellipsis">
      waterfall_chart
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">API</span>
    
  
    
    
    
      <span class="md-tag">Prediction</span>
    
  
</nav>


  
    <a href="https://github.com/moj-analytical-services/splink/edit/master/docs/linkerpred.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<div><h1 id="documentation-for-linker-object-methods-related-to-link-prediction">Documentation for <code>Linker</code> object methods related to link prediction<a class="headerlink" href="#documentation-for-linker-object-methods-related-to-link-prediction" title="Permanent link"></a></h1>


<div class="doc doc-object doc-class">



<a id="splink.linker.Linker"></a>
  <div class="doc doc-contents first">

  
      <p>The Linker object manages the data linkage process and holds the data linkage
model.</p>
<p>Most of Splink's functionality can  be accessed by calling methods (functions)
on the linker, such as <code>linker.predict()</code>, <code>linker.profile_columns()</code> etc.</p>
<p>The Linker class is intended for subclassing for specific backends, e.g.
a <code>DuckDBLinker</code>.</p>

            <details class="quote">
              <summary>Source code in <code>splink/linker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span>
<span class="normal">3005</span>
<span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span>
<span class="normal">3035</span>
<span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span>
<span class="normal">3057</span>
<span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span>
<span class="normal">3094</span>
<span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span>
<span class="normal">3134</span>
<span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span>
<span class="normal">3140</span>
<span class="normal">3141</span>
<span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span>
<span class="normal">3172</span>
<span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span>
<span class="normal">3176</span>
<span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span>
<span class="normal">3180</span>
<span class="normal">3181</span>
<span class="normal">3182</span>
<span class="normal">3183</span>
<span class="normal">3184</span>
<span class="normal">3185</span>
<span class="normal">3186</span>
<span class="normal">3187</span>
<span class="normal">3188</span>
<span class="normal">3189</span>
<span class="normal">3190</span>
<span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span>
<span class="normal">3195</span>
<span class="normal">3196</span>
<span class="normal">3197</span>
<span class="normal">3198</span>
<span class="normal">3199</span>
<span class="normal">3200</span>
<span class="normal">3201</span>
<span class="normal">3202</span>
<span class="normal">3203</span>
<span class="normal">3204</span>
<span class="normal">3205</span>
<span class="normal">3206</span>
<span class="normal">3207</span>
<span class="normal">3208</span>
<span class="normal">3209</span>
<span class="normal">3210</span>
<span class="normal">3211</span>
<span class="normal">3212</span>
<span class="normal">3213</span>
<span class="normal">3214</span>
<span class="normal">3215</span>
<span class="normal">3216</span>
<span class="normal">3217</span>
<span class="normal">3218</span>
<span class="normal">3219</span>
<span class="normal">3220</span>
<span class="normal">3221</span>
<span class="normal">3222</span>
<span class="normal">3223</span>
<span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span>
<span class="normal">3228</span>
<span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span>
<span class="normal">3235</span>
<span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span>
<span class="normal">3239</span>
<span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span>
<span class="normal">3249</span>
<span class="normal">3250</span>
<span class="normal">3251</span>
<span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span>
<span class="normal">3261</span>
<span class="normal">3262</span>
<span class="normal">3263</span>
<span class="normal">3264</span>
<span class="normal">3265</span>
<span class="normal">3266</span>
<span class="normal">3267</span>
<span class="normal">3268</span>
<span class="normal">3269</span>
<span class="normal">3270</span>
<span class="normal">3271</span>
<span class="normal">3272</span>
<span class="normal">3273</span>
<span class="normal">3274</span>
<span class="normal">3275</span>
<span class="normal">3276</span>
<span class="normal">3277</span>
<span class="normal">3278</span>
<span class="normal">3279</span>
<span class="normal">3280</span>
<span class="normal">3281</span>
<span class="normal">3282</span>
<span class="normal">3283</span>
<span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span>
<span class="normal">3335</span>
<span class="normal">3336</span>
<span class="normal">3337</span>
<span class="normal">3338</span>
<span class="normal">3339</span>
<span class="normal">3340</span>
<span class="normal">3341</span>
<span class="normal">3342</span>
<span class="normal">3343</span>
<span class="normal">3344</span>
<span class="normal">3345</span>
<span class="normal">3346</span>
<span class="normal">3347</span>
<span class="normal">3348</span>
<span class="normal">3349</span>
<span class="normal">3350</span>
<span class="normal">3351</span>
<span class="normal">3352</span>
<span class="normal">3353</span>
<span class="normal">3354</span>
<span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span>
<span class="normal">3358</span>
<span class="normal">3359</span>
<span class="normal">3360</span>
<span class="normal">3361</span>
<span class="normal">3362</span>
<span class="normal">3363</span>
<span class="normal">3364</span>
<span class="normal">3365</span>
<span class="normal">3366</span>
<span class="normal">3367</span>
<span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span>
<span class="normal">3372</span>
<span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span>
<span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span>
<span class="normal">3417</span>
<span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span>
<span class="normal">3464</span>
<span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span>
<span class="normal">3470</span>
<span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span>
<span class="normal">3488</span>
<span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span>
<span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span>
<span class="normal">3616</span>
<span class="normal">3617</span>
<span class="normal">3618</span>
<span class="normal">3619</span>
<span class="normal">3620</span>
<span class="normal">3621</span>
<span class="normal">3622</span>
<span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span>
<span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span>
<span class="normal">3639</span>
<span class="normal">3640</span>
<span class="normal">3641</span>
<span class="normal">3642</span>
<span class="normal">3643</span>
<span class="normal">3644</span>
<span class="normal">3645</span>
<span class="normal">3646</span>
<span class="normal">3647</span>
<span class="normal">3648</span>
<span class="normal">3649</span>
<span class="normal">3650</span>
<span class="normal">3651</span>
<span class="normal">3652</span>
<span class="normal">3653</span>
<span class="normal">3654</span>
<span class="normal">3655</span>
<span class="normal">3656</span>
<span class="normal">3657</span>
<span class="normal">3658</span>
<span class="normal">3659</span>
<span class="normal">3660</span>
<span class="normal">3661</span>
<span class="normal">3662</span>
<span class="normal">3663</span>
<span class="normal">3664</span>
<span class="normal">3665</span>
<span class="normal">3666</span>
<span class="normal">3667</span>
<span class="normal">3668</span>
<span class="normal">3669</span>
<span class="normal">3670</span>
<span class="normal">3671</span>
<span class="normal">3672</span>
<span class="normal">3673</span>
<span class="normal">3674</span>
<span class="normal">3675</span>
<span class="normal">3676</span>
<span class="normal">3677</span>
<span class="normal">3678</span>
<span class="normal">3679</span>
<span class="normal">3680</span>
<span class="normal">3681</span>
<span class="normal">3682</span>
<span class="normal">3683</span>
<span class="normal">3684</span>
<span class="normal">3685</span>
<span class="normal">3686</span>
<span class="normal">3687</span>
<span class="normal">3688</span>
<span class="normal">3689</span>
<span class="normal">3690</span>
<span class="normal">3691</span>
<span class="normal">3692</span>
<span class="normal">3693</span>
<span class="normal">3694</span>
<span class="normal">3695</span>
<span class="normal">3696</span>
<span class="normal">3697</span>
<span class="normal">3698</span>
<span class="normal">3699</span>
<span class="normal">3700</span>
<span class="normal">3701</span>
<span class="normal">3702</span>
<span class="normal">3703</span>
<span class="normal">3704</span>
<span class="normal">3705</span>
<span class="normal">3706</span>
<span class="normal">3707</span>
<span class="normal">3708</span>
<span class="normal">3709</span>
<span class="normal">3710</span>
<span class="normal">3711</span>
<span class="normal">3712</span>
<span class="normal">3713</span>
<span class="normal">3714</span>
<span class="normal">3715</span>
<span class="normal">3716</span>
<span class="normal">3717</span>
<span class="normal">3718</span>
<span class="normal">3719</span>
<span class="normal">3720</span>
<span class="normal">3721</span>
<span class="normal">3722</span>
<span class="normal">3723</span>
<span class="normal">3724</span>
<span class="normal">3725</span>
<span class="normal">3726</span>
<span class="normal">3727</span>
<span class="normal">3728</span>
<span class="normal">3729</span>
<span class="normal">3730</span>
<span class="normal">3731</span>
<span class="normal">3732</span>
<span class="normal">3733</span>
<span class="normal">3734</span>
<span class="normal">3735</span>
<span class="normal">3736</span>
<span class="normal">3737</span>
<span class="normal">3738</span>
<span class="normal">3739</span>
<span class="normal">3740</span>
<span class="normal">3741</span>
<span class="normal">3742</span>
<span class="normal">3743</span>
<span class="normal">3744</span>
<span class="normal">3745</span>
<span class="normal">3746</span>
<span class="normal">3747</span>
<span class="normal">3748</span>
<span class="normal">3749</span>
<span class="normal">3750</span>
<span class="normal">3751</span>
<span class="normal">3752</span>
<span class="normal">3753</span>
<span class="normal">3754</span>
<span class="normal">3755</span>
<span class="normal">3756</span>
<span class="normal">3757</span>
<span class="normal">3758</span>
<span class="normal">3759</span>
<span class="normal">3760</span>
<span class="normal">3761</span>
<span class="normal">3762</span>
<span class="normal">3763</span>
<span class="normal">3764</span>
<span class="normal">3765</span>
<span class="normal">3766</span>
<span class="normal">3767</span>
<span class="normal">3768</span>
<span class="normal">3769</span>
<span class="normal">3770</span>
<span class="normal">3771</span>
<span class="normal">3772</span>
<span class="normal">3773</span>
<span class="normal">3774</span>
<span class="normal">3775</span>
<span class="normal">3776</span>
<span class="normal">3777</span>
<span class="normal">3778</span>
<span class="normal">3779</span>
<span class="normal">3780</span>
<span class="normal">3781</span>
<span class="normal">3782</span>
<span class="normal">3783</span>
<span class="normal">3784</span>
<span class="normal">3785</span>
<span class="normal">3786</span>
<span class="normal">3787</span>
<span class="normal">3788</span>
<span class="normal">3789</span>
<span class="normal">3790</span>
<span class="normal">3791</span>
<span class="normal">3792</span>
<span class="normal">3793</span>
<span class="normal">3794</span>
<span class="normal">3795</span>
<span class="normal">3796</span>
<span class="normal">3797</span>
<span class="normal">3798</span>
<span class="normal">3799</span>
<span class="normal">3800</span>
<span class="normal">3801</span>
<span class="normal">3802</span>
<span class="normal">3803</span>
<span class="normal">3804</span>
<span class="normal">3805</span>
<span class="normal">3806</span>
<span class="normal">3807</span>
<span class="normal">3808</span>
<span class="normal">3809</span>
<span class="normal">3810</span>
<span class="normal">3811</span>
<span class="normal">3812</span>
<span class="normal">3813</span>
<span class="normal">3814</span>
<span class="normal">3815</span>
<span class="normal">3816</span>
<span class="normal">3817</span>
<span class="normal">3818</span>
<span class="normal">3819</span>
<span class="normal">3820</span>
<span class="normal">3821</span>
<span class="normal">3822</span>
<span class="normal">3823</span>
<span class="normal">3824</span>
<span class="normal">3825</span>
<span class="normal">3826</span>
<span class="normal">3827</span>
<span class="normal">3828</span>
<span class="normal">3829</span>
<span class="normal">3830</span>
<span class="normal">3831</span>
<span class="normal">3832</span>
<span class="normal">3833</span>
<span class="normal">3834</span>
<span class="normal">3835</span>
<span class="normal">3836</span>
<span class="normal">3837</span>
<span class="normal">3838</span>
<span class="normal">3839</span>
<span class="normal">3840</span>
<span class="normal">3841</span>
<span class="normal">3842</span>
<span class="normal">3843</span>
<span class="normal">3844</span>
<span class="normal">3845</span>
<span class="normal">3846</span>
<span class="normal">3847</span>
<span class="normal">3848</span>
<span class="normal">3849</span>
<span class="normal">3850</span>
<span class="normal">3851</span>
<span class="normal">3852</span>
<span class="normal">3853</span>
<span class="normal">3854</span>
<span class="normal">3855</span>
<span class="normal">3856</span>
<span class="normal">3857</span>
<span class="normal">3858</span>
<span class="normal">3859</span>
<span class="normal">3860</span>
<span class="normal">3861</span>
<span class="normal">3862</span>
<span class="normal">3863</span>
<span class="normal">3864</span>
<span class="normal">3865</span>
<span class="normal">3866</span>
<span class="normal">3867</span>
<span class="normal">3868</span>
<span class="normal">3869</span>
<span class="normal">3870</span>
<span class="normal">3871</span>
<span class="normal">3872</span>
<span class="normal">3873</span>
<span class="normal">3874</span>
<span class="normal">3875</span>
<span class="normal">3876</span>
<span class="normal">3877</span>
<span class="normal">3878</span>
<span class="normal">3879</span>
<span class="normal">3880</span>
<span class="normal">3881</span>
<span class="normal">3882</span>
<span class="normal">3883</span>
<span class="normal">3884</span>
<span class="normal">3885</span>
<span class="normal">3886</span>
<span class="normal">3887</span>
<span class="normal">3888</span>
<span class="normal">3889</span>
<span class="normal">3890</span>
<span class="normal">3891</span>
<span class="normal">3892</span>
<span class="normal">3893</span>
<span class="normal">3894</span>
<span class="normal">3895</span>
<span class="normal">3896</span>
<span class="normal">3897</span>
<span class="normal">3898</span>
<span class="normal">3899</span>
<span class="normal">3900</span>
<span class="normal">3901</span>
<span class="normal">3902</span>
<span class="normal">3903</span>
<span class="normal">3904</span>
<span class="normal">3905</span>
<span class="normal">3906</span>
<span class="normal">3907</span>
<span class="normal">3908</span>
<span class="normal">3909</span>
<span class="normal">3910</span>
<span class="normal">3911</span>
<span class="normal">3912</span>
<span class="normal">3913</span>
<span class="normal">3914</span>
<span class="normal">3915</span>
<span class="normal">3916</span>
<span class="normal">3917</span>
<span class="normal">3918</span>
<span class="normal">3919</span>
<span class="normal">3920</span>
<span class="normal">3921</span>
<span class="normal">3922</span>
<span class="normal">3923</span>
<span class="normal">3924</span>
<span class="normal">3925</span>
<span class="normal">3926</span>
<span class="normal">3927</span>
<span class="normal">3928</span>
<span class="normal">3929</span>
<span class="normal">3930</span>
<span class="normal">3931</span>
<span class="normal">3932</span>
<span class="normal">3933</span>
<span class="normal">3934</span>
<span class="normal">3935</span>
<span class="normal">3936</span>
<span class="normal">3937</span>
<span class="normal">3938</span>
<span class="normal">3939</span>
<span class="normal">3940</span>
<span class="normal">3941</span>
<span class="normal">3942</span>
<span class="normal">3943</span>
<span class="normal">3944</span>
<span class="normal">3945</span>
<span class="normal">3946</span>
<span class="normal">3947</span>
<span class="normal">3948</span>
<span class="normal">3949</span>
<span class="normal">3950</span>
<span class="normal">3951</span>
<span class="normal">3952</span>
<span class="normal">3953</span>
<span class="normal">3954</span>
<span class="normal">3955</span>
<span class="normal">3956</span>
<span class="normal">3957</span>
<span class="normal">3958</span>
<span class="normal">3959</span>
<span class="normal">3960</span>
<span class="normal">3961</span>
<span class="normal">3962</span>
<span class="normal">3963</span>
<span class="normal">3964</span>
<span class="normal">3965</span>
<span class="normal">3966</span>
<span class="normal">3967</span>
<span class="normal">3968</span>
<span class="normal">3969</span>
<span class="normal">3970</span>
<span class="normal">3971</span>
<span class="normal">3972</span>
<span class="normal">3973</span>
<span class="normal">3974</span>
<span class="normal">3975</span>
<span class="normal">3976</span>
<span class="normal">3977</span>
<span class="normal">3978</span>
<span class="normal">3979</span>
<span class="normal">3980</span>
<span class="normal">3981</span>
<span class="normal">3982</span>
<span class="normal">3983</span>
<span class="normal">3984</span>
<span class="normal">3985</span>
<span class="normal">3986</span>
<span class="normal">3987</span>
<span class="normal">3988</span>
<span class="normal">3989</span>
<span class="normal">3990</span>
<span class="normal">3991</span>
<span class="normal">3992</span>
<span class="normal">3993</span>
<span class="normal">3994</span>
<span class="normal">3995</span>
<span class="normal">3996</span>
<span class="normal">3997</span>
<span class="normal">3998</span>
<span class="normal">3999</span>
<span class="normal">4000</span>
<span class="normal">4001</span>
<span class="normal">4002</span>
<span class="normal">4003</span>
<span class="normal">4004</span>
<span class="normal">4005</span>
<span class="normal">4006</span>
<span class="normal">4007</span>
<span class="normal">4008</span>
<span class="normal">4009</span>
<span class="normal">4010</span>
<span class="normal">4011</span>
<span class="normal">4012</span>
<span class="normal">4013</span>
<span class="normal">4014</span>
<span class="normal">4015</span>
<span class="normal">4016</span>
<span class="normal">4017</span>
<span class="normal">4018</span>
<span class="normal">4019</span>
<span class="normal">4020</span>
<span class="normal">4021</span>
<span class="normal">4022</span>
<span class="normal">4023</span>
<span class="normal">4024</span>
<span class="normal">4025</span>
<span class="normal">4026</span>
<span class="normal">4027</span>
<span class="normal">4028</span>
<span class="normal">4029</span>
<span class="normal">4030</span>
<span class="normal">4031</span>
<span class="normal">4032</span>
<span class="normal">4033</span>
<span class="normal">4034</span>
<span class="normal">4035</span>
<span class="normal">4036</span>
<span class="normal">4037</span>
<span class="normal">4038</span>
<span class="normal">4039</span>
<span class="normal">4040</span>
<span class="normal">4041</span>
<span class="normal">4042</span>
<span class="normal">4043</span>
<span class="normal">4044</span>
<span class="normal">4045</span>
<span class="normal">4046</span>
<span class="normal">4047</span>
<span class="normal">4048</span>
<span class="normal">4049</span>
<span class="normal">4050</span>
<span class="normal">4051</span>
<span class="normal">4052</span>
<span class="normal">4053</span>
<span class="normal">4054</span>
<span class="normal">4055</span>
<span class="normal">4056</span>
<span class="normal">4057</span>
<span class="normal">4058</span>
<span class="normal">4059</span>
<span class="normal">4060</span>
<span class="normal">4061</span>
<span class="normal">4062</span>
<span class="normal">4063</span>
<span class="normal">4064</span>
<span class="normal">4065</span>
<span class="normal">4066</span>
<span class="normal">4067</span>
<span class="normal">4068</span>
<span class="normal">4069</span>
<span class="normal">4070</span>
<span class="normal">4071</span>
<span class="normal">4072</span>
<span class="normal">4073</span>
<span class="normal">4074</span>
<span class="normal">4075</span>
<span class="normal">4076</span>
<span class="normal">4077</span>
<span class="normal">4078</span>
<span class="normal">4079</span>
<span class="normal">4080</span>
<span class="normal">4081</span>
<span class="normal">4082</span>
<span class="normal">4083</span>
<span class="normal">4084</span>
<span class="normal">4085</span>
<span class="normal">4086</span>
<span class="normal">4087</span>
<span class="normal">4088</span>
<span class="normal">4089</span>
<span class="normal">4090</span>
<span class="normal">4091</span>
<span class="normal">4092</span>
<span class="normal">4093</span>
<span class="normal">4094</span>
<span class="normal">4095</span>
<span class="normal">4096</span>
<span class="normal">4097</span>
<span class="normal">4098</span>
<span class="normal">4099</span>
<span class="normal">4100</span>
<span class="normal">4101</span>
<span class="normal">4102</span>
<span class="normal">4103</span>
<span class="normal">4104</span>
<span class="normal">4105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Linker</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""The Linker object manages the data linkage process and holds the data linkage</span>
<span class="sd">    model.</span>

<span class="sd">    Most of Splink's functionality can  be accessed by calling methods (functions)</span>
<span class="sd">    on the linker, such as `linker.predict()`, `linker.profile_columns()` etc.</span>

<span class="sd">    The Linker class is intended for subclassing for specific backends, e.g.</span>
<span class="sd">    a `DuckDBLinker`.</span>
<span class="sd">    """</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_table_or_tables</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">settings_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
        <span class="n">accepted_df_dtypes</span><span class="p">,</span>
        <span class="n">set_up_basic_logging</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">input_table_aliases</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">validate_settings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Initialise the linker object, which manages the data linkage process and</span>
<span class="sd">        holds the data linkage model.</span>

<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                Dedupe</span>
<span class="sd">                ```py</span>
<span class="sd">                df = pd.read_csv("data_to_dedupe.csv")</span>
<span class="sd">                linker = DuckDBLinker(df, settings_dict)</span>
<span class="sd">                ```</span>
<span class="sd">                Link</span>
<span class="sd">                ```py</span>
<span class="sd">                df_1 = pd.read_parquet("table_1/")</span>
<span class="sd">                df_2 = pd.read_parquet("table_2/")</span>
<span class="sd">                linker = DuckDBLinker(</span>
<span class="sd">                    [df_1, df_2],</span>
<span class="sd">                    settings_dict,</span>
<span class="sd">                    input_table_aliases=["customers", "contact_center_callers"]</span>
<span class="sd">                    )</span>
<span class="sd">                ```</span>
<span class="sd">                Dedupe with a pre-trained model read from a json file</span>
<span class="sd">                ```py</span>
<span class="sd">                df = pd.read_csv("data_to_dedupe.csv")</span>
<span class="sd">                linker = DuckDBLinker(df, "model.json")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                Dedupe</span>
<span class="sd">                ```py</span>
<span class="sd">                df = spark.read.csv("data_to_dedupe.csv")</span>
<span class="sd">                linker = SparkLinker(df, settings_dict)</span>
<span class="sd">                ```</span>
<span class="sd">                Link</span>
<span class="sd">                ```py</span>
<span class="sd">                df_1 = spark.read.parquet("table_1/")</span>
<span class="sd">                df_2 = spark.read.parquet("table_2/")</span>
<span class="sd">                linker = SparkLinker(</span>
<span class="sd">                    [df_1, df_2],</span>
<span class="sd">                    settings_dict,</span>
<span class="sd">                    input_table_aliases=["customers", "contact_center_callers"]</span>
<span class="sd">                    )</span>
<span class="sd">                ```</span>
<span class="sd">                Dedupe with a pre-trained model read from a json file</span>
<span class="sd">                ```py</span>
<span class="sd">                df = spark.read.csv("data_to_dedupe.csv")</span>
<span class="sd">                linker = SparkLinker(df, "model.json")</span>
<span class="sd">                ```</span>

<span class="sd">        Args:</span>
<span class="sd">            input_table_or_tables (Union[str, list]): Input data into the linkage model.</span>
<span class="sd">                Either a single string (the name of a table in a database) for</span>
<span class="sd">                deduplication jobs, or a list of strings  (the name of tables in a</span>
<span class="sd">                database) for link_only or link_and_dedupe.  For some linkers, such as</span>
<span class="sd">                the DuckDBLinker and the SparkLinker, it's also possible to pass in</span>
<span class="sd">                dataframes (Pandas and Spark respectively) rather than strings.</span>
<span class="sd">            settings_dict (dict | Path, optional): A Splink settings dictionary, or a</span>
<span class="sd">                path to a json defining a settingss dictionary or pre-trained model.</span>
<span class="sd">                If not provided when the object is created, can later be added using</span>
<span class="sd">                `linker.load_settings()` or `linker.load_model()` Defaults to None.</span>
<span class="sd">            set_up_basic_logging (bool, optional): If true, sets ups up basic logging</span>
<span class="sd">                so that Splink sends messages at INFO level to stdout. Defaults to True.</span>
<span class="sd">            input_table_aliases (Union[str, list], optional): Labels assigned to</span>
<span class="sd">                input tables in Splink outputs.  If the names of the tables in the</span>
<span class="sd">                input database are long or unspecific, this argument can be used</span>
<span class="sd">                to attach more easily readable/interpretable names. Defaults to None.</span>
<span class="sd">            validate_settings (bool, optional): When True, check your settings</span>
<span class="sd">                dictionary for any potential errors that may cause splink to fail.</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_db_schema</span> <span class="o">=</span> <span class="s2">"splink"</span>
        <span class="k">if</span> <span class="n">set_up_basic_logging</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
                <span class="nb">format</span><span class="o">=</span><span class="s2">"</span><span class="si">%(message)s</span><span class="s2">"</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">splink_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">"splink"</span><span class="p">)</span>
            <span class="n">splink_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span> <span class="o">=</span> <span class="n">SQLPipeline</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">CacheDictWithLogging</span><span class="p">()</span>

        <span class="n">homogenised_tables</span><span class="p">,</span> <span class="n">homogenised_aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register_input_tables</span><span class="p">(</span>
            <span class="n">input_table_or_tables</span><span class="p">,</span>
            <span class="n">input_table_aliases</span><span class="p">,</span>
            <span class="n">accepted_df_dtypes</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_input_tables_dict</span><span class="p">(</span>
            <span class="n">homogenised_tables</span><span class="p">,</span> <span class="n">homogenised_aliases</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_settings_objs</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">),</span> <span class="n">validate_settings</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_em_training_sessions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_train_u_using_random_sample_mode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_self_link_mode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_analyse_blocking_mode</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deterministic_link_mode</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">debug_mode</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_input_columns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">include_unique_id_col_names</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_additional_columns_to_retain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">InputColumn</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">"""Retrieve the column names from the input dataset(s) as InputColumns</span>

<span class="sd">        Args:</span>
<span class="sd">            include_unique_id_col_names (bool, optional): Whether to include unique ID</span>
<span class="sd">                column names. Defaults to True.</span>
<span class="sd">            include_additional_columns_to_retain (bool, optional): Whether to include</span>
<span class="sd">                additional columns to retain. Defaults to True.</span>

<span class="sd">        Raises:</span>
<span class="sd">            SplinkException: If the input frames have different sets of columns.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[InputColumn]</span>
<span class="sd">        """</span>

        <span class="n">input_dfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

        <span class="c1"># get a list of the column names for each input frame</span>
        <span class="c1"># sort it for consistent ordering, and give each frame's</span>
        <span class="c1"># columns as a tuple so we can hash it</span>
        <span class="n">column_names_by_input_df</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">([</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">input_df</span><span class="o">.</span><span class="n">columns</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">input_df</span> <span class="ow">in</span> <span class="n">input_dfs</span>
        <span class="p">]</span>
        <span class="c1"># check that the set of input columns is the same for each frame,</span>
        <span class="c1"># fail if the sets are different</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">column_names_by_input_df</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">common_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
                <span class="o">*</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">col_names</span><span class="p">)</span> <span class="k">for</span> <span class="n">col_names</span> <span class="ow">in</span> <span class="n">column_names_by_input_df</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">problem_names</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">col</span>
                <span class="k">for</span> <span class="n">frame_col_names</span> <span class="ow">in</span> <span class="n">column_names_by_input_df</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">frame_col_names</span>
                <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">common_cols</span>
            <span class="p">}</span>
            <span class="k">raise</span> <span class="n">SplinkException</span><span class="p">(</span>
                <span class="s2">"All linker input frames must have the same set of columns.  "</span>
                <span class="s2">"The following columns were not found in all input frames: "</span>
                <span class="o">+</span> <span class="s2">", "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">problem_names</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">input_dfs</span><span class="p">))</span><span class="o">.</span><span class="n">columns</span>

        <span class="n">remove_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">include_unique_id_col_names</span><span class="p">:</span>
            <span class="n">remove_columns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_unique_id_input_columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">include_additional_columns_to_retain</span><span class="p">:</span>
            <span class="n">remove_columns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_additional_columns_to_retain</span><span class="p">)</span>

        <span class="n">remove_id_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">unquote</span><span class="p">()</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">remove_columns</span><span class="p">]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span> <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">unquote</span><span class="p">()</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">remove_id_cols</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">columns</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_source_dataset_column_already_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">input_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">unquote</span><span class="p">()</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_columns</span><span class="p">()]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_source_dataset_column_name</span> <span class="ow">in</span> <span class="n">input_cols</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_cache_uid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_settings_dict"</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_cache_uid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid_no_settings</span>

    <span class="nd">@_cache_uid</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">_cache_uid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_settings_dict"</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_cache_uid</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid_no_settings</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_settings_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Settings</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"You did not provide a settings dictionary when you "</span>
                <span class="s2">"created the linker.  To continue, you need to provide a settings "</span>
                <span class="s2">"dictionary using the `load_settings()` method on your linker "</span>
                <span class="s2">"object. i.e. linker.load_settings(settings_dict)"</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_input_tablename_l</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_self_link_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__compare_two_records_left_with_tf"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_u_using_random_sample_mode</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_two_dataset_link_only</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf_sample_left"</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf_sample"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyse_blocking_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__df_concat"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_two_dataset_link_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf_left"</span>

        <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf"</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_input_tablename_r</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__df_new_records_with_tf"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_self_link_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__compare_two_records_right_with_tf"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_u_using_random_sample_mode</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_two_dataset_link_only</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf_sample_right"</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf_sample"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyse_blocking_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__df_concat"</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_two_dataset_link_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf_right"</span>
        <span class="k">return</span> <span class="s2">"__splink__df_concat_with_tf"</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_two_dataset_link_only</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Two dataset link only join is a special case where an inner join of the</span>
        <span class="c1"># two datasets is much more efficient than self-joining the vertically</span>
        <span class="c1"># concatenation of all input datasets</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_analyse_blocking_mode</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span> <span class="o">==</span> <span class="s2">"link_only"</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_sql_dialect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"No SQL dialect set on object of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">. "</span>
                <span class="s2">"Did you make sure to create a dialect-specific Linker?"</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect_</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_infinity_expression</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"infinity sql expression not available for </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_random_sample_sql</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">proportion</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unique_id</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Random sample sql not implemented for this linker"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_register_input_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_tables</span><span class="p">,</span> <span class="n">input_aliases</span><span class="p">,</span> <span class="n">accepted_df_dtypes</span><span class="p">):</span>
        <span class="c1"># 'homogenised' means all entries are strings representing tables</span>
        <span class="n">homogenised_tables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">homogenised_aliases</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">accepted_df_dtypes</span> <span class="o">=</span> <span class="n">ensure_is_tuple</span><span class="p">(</span><span class="n">accepted_df_dtypes</span><span class="p">)</span>

        <span class="n">existing_tables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">input_aliases</span><span class="p">:</span>
            <span class="c1"># Check if alias is a string (indicating a table name) and that it is not</span>
            <span class="c1"># a file path.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">".*"</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="n">alias</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">exists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_exists_in_database</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">exists</span><span class="p">:</span>
                <span class="n">existing_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">"'</span><span class="si">{</span><span class="n">alias</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">existing_tables</span><span class="p">:</span>
            <span class="n">input_tables</span> <span class="o">=</span> <span class="s2">", "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">existing_tables</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Table(s): </span><span class="si">{</span><span class="n">input_tables</span><span class="si">}</span><span class="s2"> already exists in database. "</span>
                <span class="s2">"Please remove or rename it/them before retrying"</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">input_tables</span><span class="p">,</span> <span class="n">input_aliases</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">accepted_df_dtypes</span><span class="p">):</span>
                <span class="n">alias</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"__splink__input_table_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">accepted_df_dtypes</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_table_registration</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span>
                <span class="n">table</span> <span class="o">=</span> <span class="n">alias</span>

            <span class="n">homogenised_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
            <span class="n">homogenised_aliases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">homogenised_tables</span><span class="p">,</span> <span class="n">homogenised_aliases</span>

    <span class="k">def</span> <span class="nf">_setup_settings_objs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings_dict</span><span class="p">,</span> <span class="n">validate_settings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="c1"># Always sets a default cache uid -&gt; _cache_uid_no_settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span> <span class="o">=</span> <span class="n">ascii_uid</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">settings_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"Invalid settings object supplied. Ensure this is either "</span>
                <span class="s2">"None, a dictionary or a filepath to a settings object saved "</span>
                <span class="s2">"as a json file."</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">,</span> <span class="n">validate_settings</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_for_valid_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="c1"># no settings to check</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span>
            <span class="c1"># raw tables don't yet exist in db</span>
            <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_input_tables_dict"</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_validate_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate_settings</span><span class="p">):</span>
        <span class="c1"># Vaidate our settings after plugging them through</span>
        <span class="c1"># `Settings(&lt;settings&gt;)`</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_for_valid_settings</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_input_dfs</span><span class="p">()</span>

        <span class="c1"># Run miscellaneous checks on our settings dictionary.</span>
        <span class="n">_validate_dialect</span><span class="p">(</span>
            <span class="n">settings_dialect</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_sql_dialect</span><span class="p">,</span>
            <span class="n">linker_dialect</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect</span><span class="p">,</span>
            <span class="n">linker_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Constructs output logs for our various settings inputs</span>
        <span class="n">cleaned_settings</span> <span class="o">=</span> <span class="n">SettingsColumnCleaner</span><span class="p">(</span>
            <span class="n">settings_object</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span>
            <span class="n">input_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">InvalidColumnsLogger</span><span class="p">(</span><span class="n">cleaned_settings</span><span class="p">)</span><span class="o">.</span><span class="n">construct_output_logs</span><span class="p">(</span><span class="n">validate_settings</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initialise_df_concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">materialise</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span>
        <span class="n">concat_df</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">"__splink__df_concat"</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
            <span class="n">concat_df</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_with_logging</span><span class="p">(</span><span class="s2">"__splink__df_concat"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">"__splink__df_concat_with_tf"</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
            <span class="n">concat_df</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_with_logging</span><span class="p">(</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">)</span>
            <span class="n">concat_df</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__df_concat"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">materialise</span><span class="p">:</span>
                <span class="c1"># Clear the pipeline if we are materialising</span>
                <span class="c1"># There's no reason not to do this, since when</span>
                <span class="c1"># we execute the pipeline, it'll get cleared anyway</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="n">sql</span> <span class="o">=</span> <span class="n">vertically_concatenate_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_concat"</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">materialise</span><span class="p">:</span>
                <span class="n">concat_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">()</span>
                <span class="n">cache</span><span class="p">[</span><span class="s2">"__splink__df_concat"</span><span class="p">]</span> <span class="o">=</span> <span class="n">concat_df</span>

        <span class="k">return</span> <span class="n">concat_df</span>

    <span class="k">def</span> <span class="nf">_initialise_df_concat_with_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">materialise</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span>
        <span class="n">nodes_with_tf</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">"__splink__df_concat_with_tf"</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
            <span class="n">nodes_with_tf</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_with_logging</span><span class="p">(</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># In duckdb, calls to random() in a CTE pipeline cause problems:</span>
            <span class="c1"># https://gist.github.com/RobinL/d329e7004998503ce91b68479aa41139</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">salting_required</span><span class="p">:</span>
                <span class="n">materialise</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">materialise</span><span class="p">:</span>
                <span class="c1"># Clear the pipeline if we are materialising</span>
                <span class="c1"># There's no reason not to do this, since when</span>
                <span class="c1"># we execute the pipeline, it'll get cleared anyway</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

            <span class="n">sql</span> <span class="o">=</span> <span class="n">vertically_concatenate_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_concat"</span><span class="p">)</span>

            <span class="n">sqls</span> <span class="o">=</span> <span class="n">compute_all_term_frequencies_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">materialise</span><span class="p">:</span>
                <span class="n">nodes_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">()</span>
                <span class="n">cache</span><span class="p">[</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes_with_tf</span>

        <span class="k">return</span> <span class="n">nodes_with_tf</span>

    <span class="k">def</span> <span class="nf">_table_to_splink_dataframe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">templated_name</span><span class="p">,</span> <span class="n">physical_name</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Create a SplinkDataframe from a table in the underlying database called</span>
<span class="sd">        `physical_name`.</span>

<span class="sd">        Associate a `templated_name` with this table, which signifies the purpose</span>
<span class="sd">        or 'meaning' of this table to splink. (e.g. `__splink__df_blocked`)</span>

<span class="sd">        Args:</span>
<span class="sd">            templated_name (str): The purpose of the table to Splink</span>
<span class="sd">            physical_name (str): The name of the table in the underlying databse</span>
<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">"_table_to_splink_dataframe not implemented on this linker"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_enqueue_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">output_table_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add sql to the current pipeline, but do not execute the pipeline."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">output_table_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_sql_pipeline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_dataframes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SplinkDataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
        <span class="n">use_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Execute the SQL queued in the current pipeline as a single statement</span>
<span class="sd">        e.g. `with a as (), b as , c as (), select ... from c`, then execute the</span>
<span class="sd">        pipeline, returning the resultant table as a SplinkDataFrame</span>

<span class="sd">        Args:</span>
<span class="sd">            input_dataframes (List[SplinkDataFrame], optional): A 'starting point' of</span>
<span class="sd">                SplinkDataFrames if needed. Defaults to [].</span>
<span class="sd">            use_cache (bool, optional): If true, look at whether the SQL pipeline has</span>
<span class="sd">                been executed before, and if so, use the existing result. Defaults to</span>
<span class="sd">                True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: An abstraction representing the table created by the sql</span>
<span class="sd">                pipeline</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug_mode</span><span class="p">:</span>
            <span class="n">sql_gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">_generate_pipeline</span><span class="p">(</span><span class="n">input_dataframes</span><span class="p">)</span>

            <span class="n">output_tablename_templated</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">output_table_name</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_to_splink_dataframe_checking_cache</span><span class="p">(</span>
                    <span class="n">sql_gen</span><span class="p">,</span>
                    <span class="n">output_tablename_templated</span><span class="p">,</span>
                    <span class="n">use_cache</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">e</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">dataframe</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># In debug mode, we do not pipeline the sql and print the</span>
            <span class="c1"># results of each part of the pipeline</span>
            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">_generate_pipeline_parts</span><span class="p">(</span><span class="n">input_dataframes</span><span class="p">):</span>
                <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">output_tablename</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">output_table_name</span>
                <span class="n">sql</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">sql</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"------"</span><span class="p">)</span>  <span class="c1"># noqa: T201</span>
                <span class="nb">print</span><span class="p">(</span>  <span class="c1"># noqa: T201</span>
                    <span class="sa">f</span><span class="s2">"--------Creating table: </span><span class="si">{</span><span class="n">output_tablename</span><span class="si">}</span><span class="s2">--------"</span>
                <span class="p">)</span>

                <span class="n">dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_to_splink_dataframe_checking_cache</span><span class="p">(</span>
                    <span class="n">sql</span><span class="p">,</span>
                    <span class="n">output_tablename</span><span class="p">,</span>
                    <span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">run_time</span> <span class="o">=</span> <span class="n">parse_duration</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Step ran in: </span><span class="si">{</span><span class="n">run_time</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># noqa: T201</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">dataframe</span>

    <span class="k">def</span> <span class="nf">_execute_sql_against_backend</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">templated_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">physical_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Execute a single sql SELECT statement, returning a SplinkDataFrame.</span>

<span class="sd">        Subclasses should implement this, using _log_and_run_sql_execution() within</span>
<span class="sd">        their implementation, maybe doing some SQL translation or other prep/cleanup</span>
<span class="sd">        work before/after.</span>
<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"_execute_sql_against_backend not implemented for </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_run_sql_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">final_sql</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">templated_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">physical_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""**Actually** execute the sql against the backend database.</span>

<span class="sd">        This is intended to be implemented by a subclass, but not actually called</span>
<span class="sd">        directly. Instead, call _log_and_run_sql_execution, and that will call</span>
<span class="sd">        this method.</span>

<span class="sd">        This could return something, or not. It's up to the Linker subclass to decide.</span>
<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"_run_sql_execution not implemented for </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_log_and_run_sql_execution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">final_sql</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">templated_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">physical_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Log the sql, then call _run_sql_execution(), wrapping any errors"""</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">execute_sql_logging_message_info</span><span class="p">(</span><span class="n">templated_name</span><span class="p">,</span> <span class="n">physical_name</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">log_sql</span><span class="p">(</span><span class="n">final_sql</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_sql_execution</span><span class="p">(</span><span class="n">final_sql</span><span class="p">,</span> <span class="n">templated_name</span><span class="p">,</span> <span class="n">physical_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># Parse our SQL through sqlglot to pretty print</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">final_sql</span> <span class="o">=</span> <span class="n">sqlglot</span><span class="o">.</span><span class="n">parse_one</span><span class="p">(</span>
                    <span class="n">final_sql</span><span class="p">,</span>
                    <span class="n">read</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="n">pretty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="c1"># if sqlglot produces any errors, just report the raw SQL</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">raise</span> <span class="n">SplinkException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Error executing the following sql for table "</span>
                <span class="sa">f</span><span class="s2">"`</span><span class="si">{</span><span class="n">templated_name</span><span class="si">}</span><span class="s2">`(</span><span class="si">{</span><span class="n">physical_name</span><span class="si">}</span><span class="s2">):</span><span class="se">\n</span><span class="si">{</span><span class="n">final_sql</span><span class="si">}</span><span class="s2">"</span>
                <span class="sa">f</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">Error was: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="k">def</span> <span class="nf">register_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Register a table to your backend database, to be used in one of the</span>
<span class="sd">        splink methods, or simply to allow querying.</span>

<span class="sd">        Tables can be of type: dictionary, record level dictionary,</span>
<span class="sd">        pandas dataframe, pyarrow table and in the spark case, a spark df.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            test_dict = {"a": [666,777,888],"b": [4,5,6]}</span>
<span class="sd">            linker.register_table(test_dict, "test_dict")</span>
<span class="sd">            linker.query_sql("select * from test_dict")</span>
<span class="sd">            ```</span>

<span class="sd">        Args:</span>
<span class="sd">            input: The data you wish to register. This can be either a dictionary,</span>
<span class="sd">                pandas dataframe, pyarrow table or a spark dataframe.</span>
<span class="sd">            table_name (str): The name you wish to assign to the table.</span>
<span class="sd">            overwrite (bool): Overwrite the table in the underlying database if it</span>
<span class="sd">                exists</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: An abstraction representing the table created by the sql</span>
<span class="sd">                pipeline</span>
<span class="sd">        """</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"register_table not implemented for </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_table_registration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">table_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Register a table to your backend database, to be used in one of the</span>
<span class="sd">        splink methods, or simply to allow querying.</span>

<span class="sd">        Tables can be of type: dictionary, record level dictionary,</span>
<span class="sd">        pandas dataframe, pyarrow table and in the spark case, a spark df.</span>

<span class="sd">        This function is contains no overwrite functionality, so it can be used</span>
<span class="sd">        where we don't want to allow for overwriting.</span>

<span class="sd">        Args:</span>
<span class="sd">            input: The data you wish to register. This can be either a dictionary,</span>
<span class="sd">                pandas dataframe, pyarrow table or a spark dataframe.</span>
<span class="sd">            table_name (str): The name you wish to assign to the table.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        """</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"_table_registration not implemented for </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">query_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">"pandas"</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Run a SQL query against your backend database and return</span>
<span class="sd">        the resulting output.</span>

<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = DuckDBLinker(df, settings)</span>
<span class="sd">                df_predict = linker.predict()</span>
<span class="sd">                linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = SparkLinker(df, settings)</span>
<span class="sd">                df_predict = linker.predict()</span>
<span class="sd">                linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-amazonaws: Athena"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = AthenaLinker(df, settings)</span>
<span class="sd">                df_predict = linker.predict()</span>
<span class="sd">                linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-sqlite: SQLite"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = SQLiteLinker(df, settings)</span>
<span class="sd">                df_predict = linker.predict()</span>
<span class="sd">                linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</span>
<span class="sd">            ```</span>

<span class="sd">        Args:</span>
<span class="sd">            sql (str): The SQL to be queried.</span>
<span class="sd">            output_type (str): One of splink_df/splinkdf or pandas.</span>
<span class="sd">                This determines the type of table that your results are output in.</span>
<span class="sd">        """</span>

        <span class="n">output_tablename_templated</span> <span class="o">=</span> <span class="s2">"__splink__df_sql_query"</span>

        <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_to_splink_dataframe_checking_cache</span><span class="p">(</span>
            <span class="n">sql</span><span class="p">,</span>
            <span class="n">output_tablename_templated</span><span class="p">,</span>
            <span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">output_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"splink_df"</span><span class="p">,</span> <span class="s2">"splinkdf"</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">splink_dataframe</span>
        <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">"pandas"</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">as_pandas_dataframe</span><span class="p">()</span>
            <span class="c1"># If pandas, drop the table to cleanup the db</span>
            <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">drop_table_from_database_and_remove_from_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">out</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"output_type '</span><span class="si">{</span><span class="n">output_type</span><span class="si">}</span><span class="s2">' is not supported."</span><span class="p">,</span>
                <span class="s2">"Must be one of 'splink_df'/'splinkdf' or 'pandas'"</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_sql_to_splink_dataframe_checking_cache</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">sql</span><span class="p">,</span>
        <span class="n">output_tablename_templated</span><span class="p">,</span>
        <span class="n">use_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Execute sql, or if identical sql has been run before, return cached results.</span>

<span class="sd">        This function</span>
<span class="sd">            - is used by _execute_sql_pipeline to to execute SQL</span>
<span class="sd">            - or can be used directly if you have a single SQL statement that's</span>
<span class="sd">              not in a pipeline</span>

<span class="sd">        Return a SplinkDataFrame representing the results of the SQL</span>
<span class="sd">        """</span>

        <span class="n">to_hash</span> <span class="o">=</span> <span class="p">(</span><span class="n">sql</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">)</span>
        <span class="nb">hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">to_hash</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">9</span><span class="p">]</span>
        <span class="c1"># Ensure hash is valid sql table name</span>
        <span class="n">table_name_hash</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">output_tablename_templated</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">hash</span><span class="si">}</span><span class="s2">"</span>

        <span class="k">if</span> <span class="n">use_cache</span><span class="p">:</span>
            <span class="c1"># Certain tables are put in the cache using their templated_name</span>
            <span class="c1"># An example is __splink__df_concat_with_tf</span>
            <span class="c1"># These tables are put in the cache when they are first calculated</span>
            <span class="c1"># e.g. with _initialise_df_concat_with_tf()</span>
            <span class="c1"># But they can also be put in the cache manually using</span>
            <span class="c1"># e.g. register_table_input_nodes_concat_with_tf()</span>

            <span class="c1"># Look for these 'named' tables in the cache prior</span>
            <span class="c1"># to looking for the hashed version</span>

            <span class="k">if</span> <span class="n">output_tablename_templated</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="o">.</span><span class="n">get_with_logging</span><span class="p">(</span>
                    <span class="n">output_tablename_templated</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">table_name_hash</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="o">.</span><span class="n">get_with_logging</span><span class="p">(</span><span class="n">table_name_hash</span><span class="p">)</span>

            <span class="c1"># If not in cache, fall back on checking the database</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_exists_in_database</span><span class="p">(</span><span class="n">table_name_hash</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">"Found cache for </span><span class="si">{</span><span class="n">output_tablename_templated</span><span class="si">}</span><span class="s2"> "</span>
                    <span class="sa">f</span><span class="s2">"in database using table name with physical name </span><span class="si">{</span><span class="n">table_name_hash</span><span class="si">}</span><span class="s2">"</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_to_splink_dataframe</span><span class="p">(</span>
                    <span class="n">output_tablename_templated</span><span class="p">,</span> <span class="n">table_name_hash</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug_mode</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>  <span class="c1"># noqa: T201</span>
            <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_against_backend</span><span class="p">(</span>
                <span class="n">sql</span><span class="p">,</span>
                <span class="n">output_tablename_templated</span><span class="p">,</span>
                <span class="n">output_tablename_templated</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="o">.</span><span class="n">executed_queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">splink_dataframe</span><span class="p">)</span>

            <span class="n">df_pd</span> <span class="o">=</span> <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">as_pandas_dataframe</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

                <span class="n">display</span><span class="p">(</span><span class="n">df_pd</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ModuleNotFoundError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">df_pd</span><span class="p">)</span>  <span class="c1"># noqa: T201</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_against_backend</span><span class="p">(</span>
                <span class="n">sql</span><span class="p">,</span> <span class="n">output_tablename_templated</span><span class="p">,</span> <span class="n">table_name_hash</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="o">.</span><span class="n">executed_queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">splink_dataframe</span><span class="p">)</span>

        <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">created_by_splink</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">sql_used_to_create</span> <span class="o">=</span> <span class="n">sql</span>

        <span class="n">physical_name</span> <span class="o">=</span> <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">physical_name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="n">physical_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">splink_dataframe</span>

        <span class="k">return</span> <span class="n">splink_dataframe</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""When we do EM training, we need a copy of the linker which is independent</span>
<span class="sd">        of the main linker e.g. setting parameters on the copy will not affect the</span>
<span class="sd">        main linker.  This method implements ensures linker can be deepcopied.</span>
<span class="sd">        """</span>
        <span class="n">new_linker</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new_linker</span><span class="o">.</span><span class="n">_em_training_sessions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">new_settings</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span><span class="p">)</span>
        <span class="n">new_linker</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="o">=</span> <span class="n">new_settings</span>
        <span class="k">return</span> <span class="n">new_linker</span>

    <span class="k">def</span> <span class="nf">_ensure_aliases_populated_and_is_list</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">input_table_or_tables</span><span class="p">,</span> <span class="n">input_table_aliases</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">input_table_aliases</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">input_table_aliases</span> <span class="o">=</span> <span class="n">input_table_or_tables</span>

        <span class="n">input_table_aliases</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">input_table_aliases</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">input_table_aliases</span>

    <span class="k">def</span> <span class="nf">_get_input_tables_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_table_or_tables</span><span class="p">,</span> <span class="n">input_table_aliases</span><span class="p">):</span>
        <span class="n">input_table_or_tables</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">input_table_or_tables</span><span class="p">)</span>

        <span class="n">input_table_aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_aliases_populated_and_is_list</span><span class="p">(</span>
            <span class="n">input_table_or_tables</span><span class="p">,</span> <span class="n">input_table_aliases</span>
        <span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">table_alias</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">input_table_or_tables</span><span class="p">,</span> <span class="n">input_table_aliases</span><span class="p">):</span>
            <span class="n">d</span><span class="p">[</span><span class="n">table_alias</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_to_splink_dataframe</span><span class="p">(</span><span class="n">table_alias</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>

    <span class="k">def</span> <span class="nf">_get_input_tf_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_dict</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">df_name</span><span class="p">,</span> <span class="n">df_value</span> <span class="ow">in</span> <span class="n">df_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">renamed</span> <span class="o">=</span> <span class="n">colname_to_tf_tablename</span><span class="p">(</span><span class="n">df_name</span><span class="p">)</span>
            <span class="n">d</span><span class="p">[</span><span class="n">renamed</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_to_splink_dataframe</span><span class="p">(</span><span class="n">renamed</span><span class="p">,</span> <span class="n">df_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>

    <span class="k">def</span> <span class="nf">_predict_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_is_fully_trained</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">"</span><span class="se">\n</span><span class="s2"> -- WARNING --</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"You have called predict(), but there are some parameter "</span>
                <span class="s2">"estimates which have neither been estimated or specified in your "</span>
                <span class="s2">"settings dictionary.  To produce predictions the following"</span>
                <span class="s2">" untrained trained parameters will use default values."</span>
            <span class="p">)</span>
            <span class="n">messages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_not_trained_messages</span><span class="p">()</span>

            <span class="n">warn_message</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">msg</span><span class="p">]</span> <span class="o">+</span> <span class="n">messages</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">warn_message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_table_exists_in_database</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"table_exists_in_database not implemented for </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_input_dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_input_tables_dict"</span><span class="p">):</span>
            <span class="c1"># This is only triggered where a user loads a settings dict from a</span>
            <span class="c1"># given file path.</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">df</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span> <span class="o">==</span> <span class="s2">"dedupe_only"</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s1">'If link_type = "dedupe only" then input tables must contain '</span>
                        <span class="s2">"only a single input table"</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_populate_probability_two_random_records_match_from_trained_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">recip_prop_matches_estimates</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
            <span class="mi">15</span><span class="p">,</span>
            <span class="p">(</span>
                <span class="s2">"---- Using training sessions to compute "</span>
                <span class="s2">"probability two random records match ----"</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">em_training_session</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_em_training_sessions</span><span class="p">:</span>
            <span class="n">training_lambda</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">em_training_session</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_probability_two_random_records_match</span>
            <span class="p">)</span>
            <span class="n">training_lambda_bf</span> <span class="o">=</span> <span class="n">prob_to_bayes_factor</span><span class="p">(</span><span class="n">training_lambda</span><span class="p">)</span>
            <span class="n">reverse_levels</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">em_training_session</span><span class="o">.</span><span class="n">_comparison_levels_to_reverse_blocking_rule</span>
            <span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                <span class="mi">15</span><span class="p">,</span>
                <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
                <span class="sa">f</span><span class="s2">"Probability two random records match from trained model blocking on "</span>
                <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">em_training_session</span><span class="o">.</span><span class="n">_blocking_rule_for_training</span><span class="o">.</span><span class="n">blocking_rule_sql</span><span class="si">}</span><span class="s2">: "</span>
                <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">training_lambda</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">reverse_level</span> <span class="ow">in</span> <span class="n">reverse_levels</span><span class="p">:</span>
                <span class="c1"># Get comparison level on current settings obj</span>
                <span class="n">cc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_get_comparison_by_output_column_name</span><span class="p">(</span>
                    <span class="n">reverse_level</span><span class="o">.</span><span class="n">comparison</span><span class="o">.</span><span class="n">_output_column_name</span>
                <span class="p">)</span>

                <span class="n">cl</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">_get_comparison_level_by_comparison_vector_value</span><span class="p">(</span>
                    <span class="n">reverse_level</span><span class="o">.</span><span class="n">_comparison_vector_value</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">_has_estimated_values</span><span class="p">:</span>
                    <span class="n">bf</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">_trained_m_median</span> <span class="o">/</span> <span class="n">cl</span><span class="o">.</span><span class="n">_trained_u_median</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bf</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">_bayes_factor</span>

                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="mi">15</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">"Reversing comparison level </span><span class="si">{</span><span class="n">cc</span><span class="o">.</span><span class="n">_output_column_name</span><span class="si">}</span><span class="s2">"</span>
                    <span class="sa">f</span><span class="s2">" using bayes factor </span><span class="si">{</span><span class="n">bf</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">training_lambda_bf</span> <span class="o">=</span> <span class="n">training_lambda_bf</span> <span class="o">/</span> <span class="n">bf</span>

                <span class="n">as_prob</span> <span class="o">=</span> <span class="n">bayes_factor_to_prob</span><span class="p">(</span><span class="n">training_lambda_bf</span><span class="p">)</span>

                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="mi">15</span><span class="p">,</span>
                    <span class="p">(</span>
                        <span class="s2">"This estimate of probability two random records match now: "</span>
                        <span class="sa">f</span><span class="s2">" </span><span class="si">{</span><span class="n">as_prob</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2"> "</span>
                        <span class="sa">f</span><span class="s2">"with reciprocal </span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">as_prob</span><span class="p">)</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2">"</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">---------"</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">bayes_factor_to_prob</span><span class="p">(</span><span class="n">training_lambda_bf</span><span class="p">)</span>
            <span class="n">recip_prop_matches_estimates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span>

        <span class="n">prop_matches_estimate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">median</span><span class="p">(</span><span class="n">recip_prop_matches_estimates</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_probability_two_random_records_match</span> <span class="o">=</span> <span class="n">prop_matches_estimate</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
            <span class="mi">15</span><span class="p">,</span>
            <span class="s2">"</span><span class="se">\n</span><span class="s2">Median of prop of matches estimates: "</span>
            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_probability_two_random_records_match</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2"> "</span>
            <span class="s2">"reciprocal "</span>
            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_probability_two_random_records_match</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_populate_m_u_from_trained_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ccs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">comparisons</span>

        <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">ccs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">cc</span><span class="o">.</span><span class="n">_comparison_levels_excluding_null</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">_has_estimated_u_values</span><span class="p">:</span>
                    <span class="n">cl</span><span class="o">.</span><span class="n">u_probability</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">_trained_u_median</span>
                <span class="k">if</span> <span class="n">cl</span><span class="o">.</span><span class="n">_has_estimated_m_values</span><span class="p">:</span>
                    <span class="n">cl</span><span class="o">.</span><span class="n">m_probability</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">_trained_m_median</span>

    <span class="k">def</span> <span class="nf">delete_tables_created_by_splink_from_db</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">splink_df</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">splink_df</span><span class="o">.</span><span class="n">created_by_splink</span><span class="p">:</span>
                <span class="n">splink_df</span><span class="o">.</span><span class="n">drop_table_from_database_and_remove_from_cache</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_raise_error_if_necessary_waterfall_columns_not_computed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ricc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_retain_intermediate_calculation_columns</span>
        <span class="n">rmc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_retain_matching_columns</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ricc</span> <span class="ow">and</span> <span class="n">rmc</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"retain_intermediate_calculation_columns and "</span>
                <span class="s2">"retain_matching_columns must both be set to True in your settings"</span>
                <span class="s2">" dictionary to use this function, because otherwise the necessary "</span>
                <span class="s2">"columns will not be available in the input records."</span>
                <span class="sa">f</span><span class="s2">" Their current values are </span><span class="si">{</span><span class="n">ricc</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">rmc</span><span class="si">}</span><span class="s2">, respectively. "</span>
                <span class="s2">"Please re-run your linkage with them both set to True."</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rmc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_retain_matching_columns</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">rmc</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"retain_matching_columns must be set to True in your settings"</span>
                <span class="s2">" dictionary to use this function, because otherwise the necessary "</span>
                <span class="s2">"columns will not be available in the input records."</span>
                <span class="sa">f</span><span class="s2">" Its current value is </span><span class="si">{</span><span class="n">rmc</span><span class="si">}</span><span class="s2">. "</span>
                <span class="s2">"Please re-run your linkage with it set to True."</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_settings</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">settings_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
        <span class="n">validate_settings</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Initialise settings for the linker.  To be used if settings were</span>
<span class="sd">        not passed to the linker on creation. This can either be in the form</span>
<span class="sd">        of a settings dictionary or a filepath to a json file containing a</span>
<span class="sd">        valid settings dictionary.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">            linker.load_settings(settings_dict, validate_settings=True)</span>
<span class="sd">            ```</span>

<span class="sd">        Args:</span>
<span class="sd">            settings_dict (dict | str | Path): A Splink settings dictionary or</span>
<span class="sd">                the path to your settings json file.</span>
<span class="sd">            validate_settings (bool, optional): When True, check your settings</span>
<span class="sd">                dictionary for any potential errors that may cause splink to fail.</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
            <span class="n">settings_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>

        <span class="c1"># Store the cache ID so it can be reloaded after cache invalidation</span>
        <span class="n">cache_uid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span>

        <span class="c1"># Invalidate the cache if anything currently exists. If the settings are</span>
        <span class="c1"># changing, our charts, tf tables, etc may need changing.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_cache</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_dict</span> <span class="o">=</span> <span class="n">settings_dict</span>  <span class="c1"># overwrite or add</span>

        <span class="c1"># Get the SQL dialect from settings_dict or use the default</span>
        <span class="n">sql_dialect</span> <span class="o">=</span> <span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"sql_dialect"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect</span><span class="p">)</span>
        <span class="n">settings_dict</span><span class="p">[</span><span class="s2">"sql_dialect"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sql_dialect</span>
        <span class="n">settings_dict</span><span class="p">[</span><span class="s2">"linker_uid"</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"linker_uid"</span><span class="p">,</span> <span class="n">cache_uid</span><span class="p">)</span>

        <span class="c1"># Check the user's comparisons (if they exist)</span>
        <span class="n">log_comparison_errors</span><span class="p">(</span><span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"comparisons"</span><span class="p">),</span> <span class="n">sql_dialect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
        <span class="c1"># Check the final settings object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_settings</span><span class="p">(</span><span class="n">validate_settings</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Load a pre-defined model from a json file into the linker.</span>
<span class="sd">        This is intended to be used with the output of</span>
<span class="sd">        `save_model_to_json()`.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.load_model("my_settings.json")</span>
<span class="sd">            ```</span>

<span class="sd">        Args:</span>
<span class="sd">            model_path (Path): A path to your model settings json file.</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initialise_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""*This method is now deprecated. Please use `load_settings`</span>
<span class="sd">        when loading existing settings or `load_model` when loading</span>
<span class="sd">         a pre-trained model.*</span>

<span class="sd">        Initialise settings for the linker.  To be used if settings were</span>
<span class="sd">        not passed to the linker on creation.</span>
<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = DuckDBLinker(df)</span>
<span class="sd">                linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">                linker.initialise_settings(settings_dict)</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = SparkLinker(df)</span>
<span class="sd">                linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">                linker.initialise_settings(settings_dict)</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-amazonaws: Athena"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = AthenaLinker(df)</span>
<span class="sd">                linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">                linker.initialise_settings(settings_dict)</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-sqlite: SQLite"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = SQLiteLinker(df)</span>
<span class="sd">                linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">                linker.initialise_settings(settings_dict)</span>
<span class="sd">                ```</span>
<span class="sd">        Args:</span>
<span class="sd">            settings_dict (dict): A Splink settings dictionary</span>
<span class="sd">        """</span>
        <span class="c1"># If a uid already exists in your settings object, prioritise this</span>
        <span class="n">settings_dict</span><span class="p">[</span><span class="s2">"linker_uid"</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"linker_uid"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span><span class="p">)</span>
        <span class="n">settings_dict</span><span class="p">[</span><span class="s2">"sql_dialect"</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">"sql_dialect"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_dict</span> <span class="o">=</span> <span class="n">settings_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_input_dfs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_dialect</span><span class="p">()</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">"`initialise_settings` is deprecated. We advise you use "</span>
            <span class="s2">"`linker.load_settings()` when loading in your settings or a previously "</span>
            <span class="s2">"trained model."</span><span class="p">,</span>
            <span class="n">SplinkDeprecated</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_settings_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""*This method is now deprecated. Please use `load_settings`</span>
<span class="sd">        when loading existing settings or `load_model` when loading</span>
<span class="sd">         a pre-trained model.*</span>

<span class="sd">        Load settings from a `.json` file.</span>
<span class="sd">        This `.json` file would usually be the output of</span>
<span class="sd">        `linker.save_model_to_json()`</span>
<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.load_settings_from_json("my_settings.json")</span>
<span class="sd">            ```</span>
<span class="sd">        Args:</span>
<span class="sd">            in_path (str): Path to settings json file</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="n">in_path</span><span class="p">)</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">"`load_settings_from_json` is deprecated. We advise you use "</span>
            <span class="s2">"`linker.load_settings()` when loading in your settings or a previously "</span>
            <span class="s2">"trained model."</span><span class="p">,</span>
            <span class="n">SplinkDeprecated</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">compute_tf_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Compute a term frequency table for a given column and persist to the database</span>

<span class="sd">        This method is useful if you want to pre-compute term frequency tables e.g.</span>
<span class="sd">        so that real time linkage executes faster, or so that you can estimate</span>
<span class="sd">        various models without having to recompute term frequency tables each time</span>

<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                Real time linkage</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = DuckDBLinker(df)</span>
<span class="sd">                linker.load_settings("saved_settings.json")</span>
<span class="sd">                linker.compute_tf_table("surname")</span>
<span class="sd">                linker.compare_two_records(record_left, record_right)</span>
<span class="sd">                ```</span>
<span class="sd">                Pre-computed term frequency tables</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = DuckDBLinker(df)</span>
<span class="sd">                df_first_name_tf = linker.compute_tf_table("first_name")</span>
<span class="sd">                df_first_name_tf.write.parquet("folder/first_name_tf")</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                # On subsequent data linking job, read this table rather than recompute</span>
<span class="sd">                df_first_name_tf = pd.read_parquet("folder/first_name_tf")</span>
<span class="sd">                df_first_name_tf.createOrReplaceTempView("__splink__df_tf_first_name")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                Real time linkage</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = SparkLinker(df)</span>
<span class="sd">                linker.load_settings("saved_settings.json")</span>
<span class="sd">                linker.compute_tf_table("surname")</span>
<span class="sd">                linker.compare_two_records(record_left, record_right)</span>
<span class="sd">                ```</span>
<span class="sd">                Pre-computed term frequency tables</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = SparkLinker(df)</span>
<span class="sd">                df_first_name_tf = linker.compute_tf_table("first_name")</span>
<span class="sd">                df_first_name_tf.write.parquet("folder/first_name_tf")</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                # On subsequent data linking job, read this table rather than recompute</span>
<span class="sd">                df_first_name_tf = spark.read.parquet("folder/first_name_tf")</span>
<span class="sd">                df_first_name_tf.createOrReplaceTempView("__splink__df_tf_first_name")</span>
<span class="sd">                ```</span>

<span class="sd">        Args:</span>
<span class="sd">            column_name (str): The column name in the input table</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: The resultant table as a splink data frame</span>
<span class="sd">        """</span>

        <span class="n">input_col</span> <span class="o">=</span> <span class="n">InputColumn</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">settings_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
        <span class="n">tf_tablename</span> <span class="o">=</span> <span class="n">colname_to_tf_tablename</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span>
        <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span>
        <span class="n">concat_tf_tables</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">tf_col</span><span class="o">.</span><span class="n">unquote</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>
            <span class="k">for</span> <span class="n">tf_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_term_frequency_columns</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="n">tf_tablename</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
            <span class="n">tf_df</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_with_logging</span><span class="p">(</span><span class="n">tf_tablename</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s2">"__splink__df_concat_with_tf"</span> <span class="ow">in</span> <span class="n">cache</span> <span class="ow">and</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">concat_tf_tables</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="c1"># If our df_concat_with_tf table already exists, use backwards inference to</span>
            <span class="c1"># find a given tf table</span>
            <span class="n">colname</span> <span class="o">=</span> <span class="n">InputColumn</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>
            <span class="n">sql</span> <span class="o">=</span> <span class="n">term_frequencies_from_concat_with_tf</span><span class="p">(</span><span class="n">colname</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">colname_to_tf_tablename</span><span class="p">(</span><span class="n">colname</span><span class="p">))</span>
            <span class="n">tf_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">([</span><span class="n">cache</span><span class="p">[</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">]])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="n">tf_tablename</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Clear the pipeline if we are materialising</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="n">df_concat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat</span><span class="p">()</span>
            <span class="n">input_dfs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">df_concat</span><span class="p">:</span>
                <span class="n">input_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_concat</span><span class="p">)</span>
            <span class="n">sql</span> <span class="o">=</span> <span class="n">term_frequencies_for_single_column_sql</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">tf_tablename</span><span class="p">)</span>
            <span class="n">tf_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span><span class="n">input_dfs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="n">tf_tablename</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf_df</span>

        <span class="k">return</span> <span class="n">tf_df</span>

    <span class="k">def</span> <span class="nf">deterministic_link</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Uses the blocking rules specified by</span>
<span class="sd">        `blocking_rules_to_generate_predictions` in the settings dictionary to</span>
<span class="sd">        generate pairwise record comparisons.</span>

<span class="sd">        For deterministic linkage, this should be a list of blocking rules which</span>
<span class="sd">        are strict enough to generate only true links.</span>

<span class="sd">        Deterministic linkage, however, is likely to result in missed links</span>
<span class="sd">        (false negatives).</span>

<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                from splink.duckdb.linker import DuckDBLinker</span>

<span class="sd">                settings = {</span>
<span class="sd">                    "link_type": "dedupe_only",</span>
<span class="sd">                    "blocking_rules_to_generate_predictions": [</span>
<span class="sd">                        "l.first_name = r.first_name",</span>
<span class="sd">                        "l.surname = r.surname",</span>
<span class="sd">                    ],</span>
<span class="sd">                    "comparisons": []</span>
<span class="sd">                }</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                linker = DuckDBLinker(df, settings)</span>
<span class="sd">                df = linker.deterministic_link()</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                from splink.spark.linker import SparkLinker</span>

<span class="sd">                settings = {</span>
<span class="sd">                    "link_type": "dedupe_only",</span>
<span class="sd">                    "blocking_rules_to_generate_predictions": [</span>
<span class="sd">                        "l.first_name = r.first_name",</span>
<span class="sd">                        "l.surname = r.surname",</span>
<span class="sd">                    ],</span>
<span class="sd">                    "comparisons": []</span>
<span class="sd">                }</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                linker = SparkLinker(df, settings)</span>
<span class="sd">                df = linker.deterministic_link()</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-amazonaws: Athena"</span>
<span class="sd">                ```py</span>
<span class="sd">                from splink.athena.linker import AthenaLinker</span>

<span class="sd">                settings = {</span>
<span class="sd">                    "link_type": "dedupe_only",</span>
<span class="sd">                    "blocking_rules_to_generate_predictions": [</span>
<span class="sd">                        "l.first_name = r.first_name",</span>
<span class="sd">                        "l.surname = r.surname",</span>
<span class="sd">                    ],</span>
<span class="sd">                    "comparisons": []</span>
<span class="sd">                }</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                linker = AthenaLinker(df, settings)</span>
<span class="sd">                df = linker.deterministic_link()</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-sqlite: SQLite"</span>
<span class="sd">                ```py</span>
<span class="sd">                from splink.sqlite.linker import SQLiteLinker</span>

<span class="sd">                settings = {</span>
<span class="sd">                    "link_type": "dedupe_only",</span>
<span class="sd">                    "blocking_rules_to_generate_predictions": [</span>
<span class="sd">                        "l.first_name = r.first_name",</span>
<span class="sd">                        "l.surname = r.surname",</span>
<span class="sd">                    ],</span>
<span class="sd">                    "comparisons": []</span>
<span class="sd">                }</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                linker = SQLiteLinker(df, settings)</span>
<span class="sd">                df = linker.deterministic_link()</span>
<span class="sd">                ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: A SplinkDataFrame of the pairwise comparisons.  This</span>
<span class="sd">                represents a table materialised in the database. Methods on the</span>
<span class="sd">                SplinkDataFrame allow you to access the underlying data.</span>
<span class="sd">        """</span>

        <span class="c1"># Allows clustering during a deterministic linkage.</span>
        <span class="c1"># This is used in `cluster_pairwise_predictions_at_threshold`</span>
        <span class="c1"># to set the cluster threshold to 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deterministic_link_mode</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">concat_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">()</span>
        <span class="n">exploding_br_with_id_tables</span> <span class="o">=</span> <span class="n">materialise_exploded_id_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">deterministic_link_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">([</span><span class="n">concat_with_tf</span><span class="p">])</span>
        <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">drop_materialised_id_pairs_dataframe</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">exploding_br_with_id_tables</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">deterministic_link_df</span>

    <span class="k">def</span> <span class="nf">estimate_u_using_random_sampling</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">max_pairs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">target_rows</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Estimate the u parameters of the linkage model using random sampling.</span>

<span class="sd">        The u parameters represent the proportion of record comparisons that fall</span>
<span class="sd">        into each comparison level amongst truly non-matching records.</span>

<span class="sd">        This procedure takes a sample of the data and generates the cartesian</span>
<span class="sd">        product of pairwise record comparisons amongst the sampled records.</span>
<span class="sd">        The validity of the u values rests on the assumption that the resultant</span>
<span class="sd">        pairwise comparisons are non-matches (or at least, they are very unlikely to be</span>
<span class="sd">        matches). For large datasets, this is typically true.</span>

<span class="sd">        The results of estimate_u_using_random_sampling, and therefore an entire splink</span>
<span class="sd">        model, can be made reproducible by setting the seed parameter. Setting the seed</span>
<span class="sd">        will have performance implications as additional processing is required.</span>

<span class="sd">        Args:</span>
<span class="sd">            max_pairs (int): The maximum number of pairwise record comparisons to</span>
<span class="sd">            sample. Larger will give more accurate estimates</span>
<span class="sd">            but lead to longer runtimes.  In our experience at least 1e9 (one billion)</span>
<span class="sd">            gives best results but can take a long time to compute. 1e7 (ten million)</span>
<span class="sd">            is often adequate whilst testing different model specifications, before</span>
<span class="sd">            the final model is estimated.</span>
<span class="sd">            seed (int): Seed for random sampling. Assign to get reproducible u</span>
<span class="sd">            probabilities. Note, seed for random sampling is only supported for</span>
<span class="sd">            DuckDB and Spark, for Athena and SQLite set to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.estimate_u_using_random_sampling(1e8)</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            None: Updates the estimated u parameters within the linker object</span>
<span class="sd">            and returns nothing.</span>
<span class="sd">        """</span>
        <span class="c1"># TODO: Remove this compatibility code in a future release once we drop</span>
        <span class="c1"># support for "target_rows". Deprecation warning added in 3.7.0</span>
        <span class="k">if</span> <span class="n">max_pairs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">target_rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># user supplied both</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Just use max_pairs"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">max_pairs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># user is doing it correctly</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">target_rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># user is using deprecated argument</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">"target_rows is deprecated; use max_pairs"</span><span class="p">,</span>
                <span class="n">SplinkDeprecated</span><span class="p">,</span>
                <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">max_pairs</span> <span class="o">=</span> <span class="n">target_rows</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Missing argument max_pairs"</span><span class="p">)</span>

        <span class="n">estimate_u_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_pairs</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_m_u_from_trained_values</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_columns_without_estimated_parameters_message</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">estimate_m_from_label_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_colname</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Estimate the m parameters of the linkage model from a label (ground truth)</span>
<span class="sd">        column in the input dataframe(s).</span>

<span class="sd">        The m parameters represent the proportion of record comparisons that fall</span>
<span class="sd">        into each comparison level amongst truly matching records.</span>

<span class="sd">        The ground truth column is used to generate pairwise record comparisons</span>
<span class="sd">        which are then assumed to be matches.</span>

<span class="sd">        For example, if the entity being matched is persons, and your input dataset(s)</span>
<span class="sd">        contain social security number, this could be used to estimate the m values</span>
<span class="sd">        for the model.</span>

<span class="sd">        Note that this column does not need to be fully populated.  A common case is</span>
<span class="sd">        where a unique identifier such as social security number is only partially</span>
<span class="sd">        populated.</span>

<span class="sd">        Args:</span>
<span class="sd">            label_colname (str): The name of the column containing the ground truth</span>
<span class="sd">                label in the input data.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.estimate_m_from_label_column("social_security_number")</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            Updates the estimated m parameters within the linker object</span>
<span class="sd">            and returns nothing.</span>
<span class="sd">        """</span>

        <span class="c1"># Ensure this has been run on the main linker so that it can be used by</span>
        <span class="c1"># training linked when it checks the cache</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">()</span>
        <span class="n">estimate_m_values_from_label_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span><span class="p">,</span>
            <span class="n">label_colname</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_m_u_from_trained_values</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_columns_without_estimated_parameters_message</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">estimate_parameters_using_expectation_maximisation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">blocking_rule</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">comparisons_to_deactivate</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Comparison</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">comparison_levels_to_reverse_blocking_rule</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ComparisonLevel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">estimate_without_term_frequencies</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">fix_probability_two_random_records_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">fix_m_probabilities</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">fix_u_probabilities</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">populate_probability_two_random_records_match_from_trained_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EMTrainingSession</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Estimate the parameters of the linkage model using expectation maximisation.</span>

<span class="sd">        By default, the m probabilities are estimated, but not the u probabilities,</span>
<span class="sd">        because good estimates for the u probabilities can be obtained from</span>
<span class="sd">        `linker.estimate_u_using_random_sampling()`.  You can change this by setting</span>
<span class="sd">        `fix_u_probabilities` to False.</span>

<span class="sd">        The blocking rule provided is used to generate pairwise record comparisons.</span>
<span class="sd">        Usually, this should be a blocking rule that results in a dataframe where</span>
<span class="sd">        matches are between about 1% and 99% of the comparisons.</span>

<span class="sd">        By default, m parameters are estimated for all comparisons except those which</span>
<span class="sd">        are included in the blocking rule.</span>

<span class="sd">        For example, if the blocking rule is `l.first_name = r.first_name`, then</span>
<span class="sd">        parameter esimates will be made for all comparison except those which use</span>
<span class="sd">        `first_name` in their sql_condition</span>

<span class="sd">        By default, the probability two random records match is estimated for the</span>
<span class="sd">        blocked data, and then the m and u parameters for the columns specified in the</span>
<span class="sd">        blocking rules are used to estiamte the global probability two random records</span>
<span class="sd">        match.</span>

<span class="sd">        To control which comparisons should have their parameter estimated, and the</span>
<span class="sd">        process of 'reversing out' the global probability two random records match, the</span>
<span class="sd">        user may specify `comparisons_to_deactivate` and</span>
<span class="sd">        `comparison_levels_to_reverse_blocking_rule`.   This is useful, for example</span>
<span class="sd">        if you block on the dmetaphone of a column but match on the original column.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Default behaviour</span>
<span class="sd">            ```py</span>
<span class="sd">            br_training = "l.first_name = r.first_name and l.dob = r.dob"</span>
<span class="sd">            linker.estimate_parameters_using_expectation_maximisation(br_training)</span>
<span class="sd">            ```</span>
<span class="sd">            Specify which comparisons to deactivate</span>
<span class="sd">            ```py</span>
<span class="sd">            br_training = "l.dmeta_first_name = r.dmeta_first_name"</span>
<span class="sd">            settings_obj = linker._settings_obj</span>
<span class="sd">            comp = settings_obj._get_comparison_by_output_column_name("first_name")</span>
<span class="sd">            dmeta_level = comp._get_comparison_level_by_comparison_vector_value(1)</span>
<span class="sd">            linker.estimate_parameters_using_expectation_maximisation(</span>
<span class="sd">                br_training,</span>
<span class="sd">                comparisons_to_deactivate=["first_name"],</span>
<span class="sd">                comparison_levels_to_reverse_blocking_rule=[dmeta_level],</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>

<span class="sd">        Args:</span>
<span class="sd">            blocking_rule (BlockingRule | str): The blocking rule used to generate</span>
<span class="sd">                pairwise record comparisons.</span>
<span class="sd">            comparisons_to_deactivate (list, optional): By default, splink will</span>
<span class="sd">                analyse the blocking rule provided and estimate the m parameters for</span>
<span class="sd">                all comaprisons except those included in the blocking rule.  If</span>
<span class="sd">                comparisons_to_deactivate are provided, spink will instead</span>
<span class="sd">                estimate m parameters for all comparison except those specified</span>
<span class="sd">                in the comparisons_to_deactivate list.  This list can either contain</span>
<span class="sd">                the output_column_name of the Comparison as a string, or Comparison</span>
<span class="sd">                objects.  Defaults to None.</span>
<span class="sd">            comparison_levels_to_reverse_blocking_rule (list, optional): By default,</span>
<span class="sd">                splink will analyse the blocking rule provided and adjust the</span>
<span class="sd">                global probability two random records match to account for the matches</span>
<span class="sd">                specified in the blocking rule. If provided, this argument will overrule</span>
<span class="sd">                this default behaviour. The user must provide a list of ComparisonLevel</span>
<span class="sd">                objects.  Defaults to None.</span>
<span class="sd">            estimate_without_term_frequencies (bool, optional): If True, the iterations</span>
<span class="sd">                of the EM algorithm ignore any term frequency adjustments and only</span>
<span class="sd">                depend on the comparison vectors. This allows the EM algorithm to run</span>
<span class="sd">                much faster, but the estimation of the parameters will change slightly.</span>
<span class="sd">            fix_probability_two_random_records_match (bool, optional): If True, do not</span>
<span class="sd">                update the probability two random records match after each iteration.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            fix_m_probabilities (bool, optional): If True, do not update the m</span>
<span class="sd">                probabilities after each iteration. Defaults to False.</span>
<span class="sd">            fix_u_probabilities (bool, optional): If True, do not update the u</span>
<span class="sd">                probabilities after each iteration. Defaults to True.</span>
<span class="sd">            populate_probability_two_random_records_match_from_trained_values</span>
<span class="sd">                (bool, optional): If True, derive this parameter from</span>
<span class="sd">                the blocked value. Defaults to False.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            blocking_rule = "l.first_name = r.first_name and l.dob = r.dob"</span>
<span class="sd">            linker.estimate_parameters_using_expectation_maximisation(blocking_rule)</span>
<span class="sd">            ```</span>
<span class="sd">            or using pre-built rules</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.duckdb.blocking_rule_library import block_on</span>
<span class="sd">            blocking_rule = block_on(["first_name", "surname"])</span>
<span class="sd">            linker.estimate_parameters_using_expectation_maximisation(blocking_rule)</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            EMTrainingSession:  An object containing information about the training</span>
<span class="sd">                session such as how parameters changed during the iteration history</span>

<span class="sd">        """</span>
        <span class="c1"># Ensure this has been run on the main linker so that it's in the cache</span>
        <span class="c1"># to be used by the training linkers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">()</span>

        <span class="c1"># Extract the blocking rule</span>
        <span class="c1"># Check it's a BlockingRule (not a SaltedBlockingRule, ExlpodingBlockingRule)</span>
        <span class="c1"># and raise error if not specfically a BlockingRule</span>
        <span class="n">blocking_rule</span> <span class="o">=</span> <span class="n">blocking_rule_to_obj</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">BlockingRule</span><span class="p">,</span> <span class="n">SaltedBlockingRule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">"EM blocking rules must be plain blocking rules, not "</span>
                <span class="s2">"salted or exploding blocking rules"</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">comparisons_to_deactivate</span><span class="p">:</span>
            <span class="c1"># If user provided a string, convert to Comparison object</span>
            <span class="n">comparisons_to_deactivate</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_get_comparison_by_output_column_name</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                    <span class="k">else</span> <span class="n">n</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">comparisons_to_deactivate</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">comparison_levels_to_reverse_blocking_rule</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">"</span><span class="se">\n</span><span class="s2">WARNING: </span><span class="se">\n</span><span class="s2">"</span>
                    <span class="s2">"You have provided comparisons_to_deactivate but not "</span>
                    <span class="s2">"comparison_levels_to_reverse_blocking_rule.</span><span class="se">\n</span><span class="s2">"</span>
                    <span class="s2">"If comparisons_to_deactivate is provided, then "</span>
                    <span class="s2">"you usually need to provide corresponding "</span>
                    <span class="s2">"comparison_levels_to_reverse_blocking_rule "</span>
                    <span class="s2">"because each comparison to deactivate is effectively treated "</span>
                    <span class="s2">"as an exact match."</span>
                <span class="p">)</span>

        <span class="n">em_training_session</span> <span class="o">=</span> <span class="n">EMTrainingSession</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">blocking_rule</span><span class="p">,</span>
            <span class="n">fix_u_probabilities</span><span class="o">=</span><span class="n">fix_u_probabilities</span><span class="p">,</span>
            <span class="n">fix_m_probabilities</span><span class="o">=</span><span class="n">fix_m_probabilities</span><span class="p">,</span>
            <span class="n">fix_probability_two_random_records_match</span><span class="o">=</span><span class="n">fix_probability_two_random_records_match</span><span class="p">,</span>  <span class="c1"># noqa 501</span>
            <span class="n">comparisons_to_deactivate</span><span class="o">=</span><span class="n">comparisons_to_deactivate</span><span class="p">,</span>
            <span class="n">comparison_levels_to_reverse_blocking_rule</span><span class="o">=</span><span class="n">comparison_levels_to_reverse_blocking_rule</span><span class="p">,</span>  <span class="c1"># noqa 501</span>
            <span class="n">estimate_without_term_frequencies</span><span class="o">=</span><span class="n">estimate_without_term_frequencies</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">em_training_session</span><span class="o">.</span><span class="n">_train</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_m_u_from_trained_values</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">populate_probability_two_random_records_match_from_trained_values</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_probability_two_random_records_match_from_trained_values</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_columns_without_estimated_parameters_message</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">em_training_session</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">threshold_match_probability</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">threshold_match_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">materialise_after_computing_term_frequencies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Create a dataframe of scored pairwise comparisons using the parameters</span>
<span class="sd">        of the linkage model.</span>

<span class="sd">        Uses the blocking rules specified in the</span>
<span class="sd">        `blocking_rules_to_generate_predictions` of the settings dictionary to</span>
<span class="sd">        generate the pairwise comparisons.</span>

<span class="sd">        Args:</span>
<span class="sd">            threshold_match_probability (float, optional): If specified,</span>
<span class="sd">                filter the results to include only pairwise comparisons with a</span>
<span class="sd">                match_probability above this threshold. Defaults to None.</span>
<span class="sd">            threshold_match_weight (float, optional): If specified,</span>
<span class="sd">                filter the results to include only pairwise comparisons with a</span>
<span class="sd">                match_weight above this threshold. Defaults to None.</span>
<span class="sd">            materialise_after_computing_term_frequencies (bool): If true, Splink</span>
<span class="sd">                will materialise the table containing the input nodes (rows)</span>
<span class="sd">                joined to any term frequencies which have been asked</span>
<span class="sd">                for in the settings object.  If False, this will be</span>
<span class="sd">                computed as part of one possibly gigantic CTE</span>
<span class="sd">                pipeline.   Defaults to True</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.load_settings("saved_settings.json")</span>
<span class="sd">            df = linker.predict(threshold_match_probability=0.95)</span>
<span class="sd">            df.as_pandas_dataframe(limit=5)</span>
<span class="sd">            ```</span>
<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: A SplinkDataFrame of the pairwise comparisons.  This</span>
<span class="sd">                represents a table materialised in the database. Methods on the</span>
<span class="sd">                SplinkDataFrame allow you to access the underlying data.</span>

<span class="sd">        """</span>

        <span class="c1"># If materialise_after_computing_term_frequencies=False and the user only</span>
        <span class="c1"># calls predict, it runs as a single pipeline with no materialisation</span>
        <span class="c1"># of anything.</span>

        <span class="c1"># _initialise_df_concat_with_tf returns None if the table doesn't exist</span>
        <span class="c1"># and only SQL is queued in this step.</span>
        <span class="n">nodes_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">(</span>
            <span class="n">materialise</span><span class="o">=</span><span class="n">materialise_after_computing_term_frequencies</span>
        <span class="p">)</span>

        <span class="n">input_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">nodes_with_tf</span><span class="p">:</span>
            <span class="n">input_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nodes_with_tf</span><span class="p">)</span>

        <span class="c1"># If exploded blocking rules exist, we need to materialise</span>
        <span class="c1"># the tables of ID pairs</span>
        <span class="n">exploding_br_with_id_tables</span> <span class="o">=</span> <span class="n">materialise_exploded_id_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">repartition_after_blocking</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"repartition_after_blocking"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># repartition after blocking only exists on the SparkLinker</span>
        <span class="k">if</span> <span class="n">repartition_after_blocking</span><span class="p">:</span>
            <span class="n">df_blocked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span><span class="n">input_dataframes</span><span class="p">)</span>
            <span class="n">input_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_blocked</span><span class="p">)</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="n">compute_comparison_vector_values_sql</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vectors"</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">predict_from_comparison_vectors_sqls</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span>
            <span class="n">threshold_match_probability</span><span class="p">,</span>
            <span class="n">threshold_match_weight</span><span class="p">,</span>
            <span class="n">sql_infinity_expression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_infinity_expression</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span><span class="n">input_dataframes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_predict_warning</span><span class="p">()</span>

        <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">drop_materialised_id_pairs_dataframe</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">exploding_br_with_id_tables</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">predictions</span>

    <span class="k">def</span> <span class="nf">find_matches_to_new_records</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">records_or_tablename</span><span class="p">,</span>
        <span class="n">blocking_rules</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">match_weight_threshold</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Given one or more records, find records in the input dataset(s) which match</span>
<span class="sd">        and return in order of the Splink prediction score.</span>

<span class="sd">        This effectively provides a way of searching the input datasets</span>
<span class="sd">        for given record(s)</span>

<span class="sd">        Args:</span>
<span class="sd">            records_or_tablename (List[dict]): Input search record(s) as list of dict,</span>
<span class="sd">                or a table registered to the database.</span>
<span class="sd">            blocking_rules (list, optional): Blocking rules to select</span>
<span class="sd">                which records to find and score. If [], do not use a blocking</span>
<span class="sd">                rule - meaning the input records will be compared to all records</span>
<span class="sd">                provided to the linker when it was instantiated. Defaults to [].</span>
<span class="sd">            match_weight_threshold (int, optional): Return matches with a match weight</span>
<span class="sd">                above this threshold. Defaults to -4.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.load_settings("saved_settings.json")</span>
<span class="sd">            # Pre-compute tf tables for any tables with</span>
<span class="sd">            # term frequency adjustments</span>
<span class="sd">            linker.compute_tf_table("first_name")</span>
<span class="sd">            record = {'unique_id': 1,</span>
<span class="sd">                'first_name': "John",</span>
<span class="sd">                'surname': "Smith",</span>
<span class="sd">                'dob': "1971-05-24",</span>
<span class="sd">                'city': "London",</span>
<span class="sd">                'email': "john@smith.net"</span>
<span class="sd">                }</span>
<span class="sd">            df = linker.find_matches_to_new_records([record], blocking_rules=[])</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: The pairwise comparisons.</span>
<span class="sd">        """</span>

        <span class="n">original_blocking_rules</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span>
        <span class="p">)</span>
        <span class="n">original_link_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span>

        <span class="n">blocking_rules</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">records_or_tablename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">uid</span> <span class="o">=</span> <span class="n">ascii_uid</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
            <span class="n">new_records_tablename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"__splink__df_new_records_</span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2">"</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
                <span class="n">records_or_tablename</span><span class="p">,</span> <span class="n">new_records_tablename</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_records_tablename</span> <span class="o">=</span> <span class="n">records_or_tablename</span>

        <span class="n">new_records_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_to_splink_dataframe</span><span class="p">(</span>
            <span class="s2">"__splink__df_new_records"</span><span class="p">,</span> <span class="n">new_records_tablename</span>
        <span class="p">)</span>

        <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span>
        <span class="n">input_dfs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># If our df_concat_with_tf table already exists, derive the term frequency</span>
        <span class="c1"># tables from df_concat_with_tf rather than computing them</span>
        <span class="k">if</span> <span class="s2">"__splink__df_concat_with_tf"</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
            <span class="n">concat_with_tf</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">]</span>
            <span class="n">tf_tables</span> <span class="o">=</span> <span class="n">compute_term_frequencies_from_concat_with_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="c1"># This queues up our tf tables, rather materialising them</span>
            <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">tf_tables</span><span class="p">:</span>
                <span class="c1"># if tf is a SplinkDataFrame, then the table already exists</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">SplinkDataFrame</span><span class="p">):</span>
                    <span class="n">input_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">tf</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This queues up our cols_with_tf and df_concat_with_tf tables.</span>
            <span class="n">concat_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">(</span><span class="n">materialise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">concat_with_tf</span><span class="p">:</span>
            <span class="n">input_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">concat_with_tf</span><span class="p">)</span>

        <span class="n">blocking_rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">blocking_rule_to_obj</span><span class="p">(</span><span class="n">br</span><span class="p">)</span> <span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">blocking_rules</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">br</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">):</span>
            <span class="n">br</span><span class="o">.</span><span class="n">add_preceding_rules</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="n">blocking_rules</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="n">_join_tf_to_input_df_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"__splink__df_concat"</span><span class="p">,</span> <span class="n">new_records_tablename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_new_records_with_tf_before_uid_fix"</span><span class="p">)</span>

        <span class="n">add_unique_id_and_source_dataset_cols_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_records_df</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="n">compute_comparison_vector_values_sql</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vectors"</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">predict_from_comparison_vectors_sqls</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span>
            <span class="n">sql_infinity_expression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_infinity_expression</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">        select * from __splink__df_predict</span>
<span class="s2">        where match_weight &gt; </span><span class="si">{</span><span class="n">match_weight_threshold</span><span class="si">}</span>
<span class="s2">        """</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__find_matches_predictions"</span><span class="p">)</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span>
            <span class="n">input_dataframes</span><span class="o">=</span><span class="n">input_dfs</span><span class="p">,</span> <span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">original_blocking_rules</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span> <span class="o">=</span> <span class="n">original_link_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">predictions</span>

    <span class="k">def</span> <span class="nf">compare_two_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">record_2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Use the linkage model to compare and score a pairwise record comparison</span>
<span class="sd">        based on the two input records provided</span>

<span class="sd">        Args:</span>
<span class="sd">            record_1 (dict): dictionary representing the first record.  Columns names</span>
<span class="sd">                and data types must be the same as the columns in the settings object</span>
<span class="sd">            record_2 (dict): dictionary representing the second record.  Columns names</span>
<span class="sd">                and data types must be the same as the columns in the settings object</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.load_settings("saved_settings.json")</span>
<span class="sd">            linker.compare_two_records(record_left, record_right)</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: Pairwise comparison with scored prediction</span>
<span class="sd">        """</span>
        <span class="n">original_blocking_rules</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span>
        <span class="p">)</span>
        <span class="n">original_link_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">uid</span> <span class="o">=</span> <span class="n">ascii_uid</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">df_records_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
            <span class="p">[</span><span class="n">record_1</span><span class="p">],</span> <span class="sa">f</span><span class="s2">"__splink__compare_two_records_left_</span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">df_records_left</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__compare_two_records_left"</span>

        <span class="n">df_records_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
            <span class="p">[</span><span class="n">record_2</span><span class="p">],</span> <span class="sa">f</span><span class="s2">"__splink__compare_two_records_right_</span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">df_records_right</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__compare_two_records_right"</span>

        <span class="n">sql_join_tf</span> <span class="o">=</span> <span class="n">_join_tf_to_input_df_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">sql_join_tf</span> <span class="o">=</span> <span class="n">sql_join_tf</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s2">"__splink__df_concat"</span><span class="p">,</span> <span class="s2">"__splink__compare_two_records_left"</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql_join_tf</span><span class="p">,</span> <span class="s2">"__splink__compare_two_records_left_with_tf"</span><span class="p">)</span>

        <span class="n">sql_join_tf</span> <span class="o">=</span> <span class="n">sql_join_tf</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="s2">"__splink__compare_two_records_left"</span><span class="p">,</span> <span class="s2">"__splink__compare_two_records_right"</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql_join_tf</span><span class="p">,</span> <span class="s2">"__splink__compare_two_records_right_with_tf"</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="n">compute_comparison_vector_values_sql</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vectors"</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">predict_from_comparison_vectors_sqls</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span>
            <span class="n">sql_infinity_expression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_infinity_expression</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span>
            <span class="p">[</span><span class="n">df_records_left</span><span class="p">,</span> <span class="n">df_records_right</span><span class="p">],</span> <span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">original_blocking_rules</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span> <span class="o">=</span> <span class="n">original_link_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">predictions</span>

    <span class="k">def</span> <span class="nf">_self_link</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Use the linkage model to compare and score all records in our input df with</span>
<span class="sd">            themselves.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: Scored pairwise comparisons of the input records to</span>
<span class="sd">                themselves.</span>
<span class="sd">        """</span>

        <span class="n">original_blocking_rules</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span>
        <span class="p">)</span>
        <span class="n">original_link_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span>

        <span class="c1"># Changes our sql to allow for a self link.</span>
        <span class="c1"># This is used in `_sql_gen_where_condition` in blocking.py</span>
        <span class="c1"># to remove any 'where' clauses when blocking (normally when blocking</span>
        <span class="c1"># we want to *remove* self links!)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_self_link_mode</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Block on uid i.e. create pairwise record comparisons where the uid matches</span>
        <span class="n">uid_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_unique_id_input_columns</span>
        <span class="n">uid_l</span> <span class="o">=</span> <span class="n">_composite_unique_id_from_edges_sql</span><span class="p">(</span><span class="n">uid_cols</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"l"</span><span class="p">)</span>
        <span class="n">uid_r</span> <span class="o">=</span> <span class="n">_composite_unique_id_from_edges_sql</span><span class="p">(</span><span class="n">uid_cols</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">BlockingRule</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">uid_l</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">uid_r</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">sqlglot_dialect</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">nodes_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">()</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="n">compute_comparison_vector_values_sql</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vectors"</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">predict_from_comparison_vectors_sqls</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span>
            <span class="n">sql_infinity_expression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_infinity_expression</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="n">output_table_name</span> <span class="o">=</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">]</span>
            <span class="n">output_table_name</span> <span class="o">=</span> <span class="n">output_table_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"predict"</span><span class="p">,</span> <span class="s2">"self_link"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">output_table_name</span><span class="p">)</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span>
            <span class="n">input_dataframes</span><span class="o">=</span><span class="p">[</span><span class="n">nodes_with_tf</span><span class="p">],</span> <span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">original_blocking_rules</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span> <span class="o">=</span> <span class="n">original_link_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_self_link_mode</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">predictions</span>

    <span class="k">def</span> <span class="nf">cluster_pairwise_predictions_at_threshold</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">threshold_match_probability</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pairwise_formatting</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">filter_pairwise_format_for_clusters</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Clusters the pairwise match predictions that result from `linker.predict()`</span>
<span class="sd">        into groups of connected record using the connected components graph clustering</span>
<span class="sd">        algorithm</span>

<span class="sd">        Records with an estimated `match_probability` at or above</span>
<span class="sd">        `threshold_match_probability` are considered to be a match (i.e. they represent</span>
<span class="sd">        the same entity).</span>

<span class="sd">        Args:</span>
<span class="sd">            df_predict (SplinkDataFrame): The results of `linker.predict()`</span>
<span class="sd">            threshold_match_probability (float): Filter the pairwise match predictions</span>
<span class="sd">                to include only pairwise comparisons with a match_probability at or</span>
<span class="sd">                above this threshold. This dataframe is then fed into the clustering</span>
<span class="sd">                algorithm.</span>
<span class="sd">            pairwise_formatting (bool): Whether to output the pairwise match predictions</span>
<span class="sd">                from linker.predict() with cluster IDs.</span>
<span class="sd">                If this is set to false, the output will be a list of all IDs, clustered</span>
<span class="sd">                into groups based on the desired match threshold.</span>
<span class="sd">            filter_pairwise_format_for_clusters (bool): If pairwise formatting has been</span>
<span class="sd">                selected, whether to output all columns found within linker.predict(),</span>
<span class="sd">                or just return clusters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: A SplinkDataFrame containing a list of all IDs, clustered</span>
<span class="sd">                into groups based on the desired match threshold.</span>

<span class="sd">        """</span>

        <span class="c1"># Feeding in df_predict forces materiailisation, if it exists in your database</span>
        <span class="n">concat_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">(</span><span class="n">df_predict</span><span class="p">)</span>

        <span class="n">edges_table</span> <span class="o">=</span> <span class="n">_cc_create_unique_id_cols</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">concat_with_tf</span><span class="o">.</span><span class="n">physical_name</span><span class="p">,</span>
            <span class="n">df_predict</span><span class="o">.</span><span class="n">physical_name</span><span class="p">,</span>
            <span class="n">threshold_match_probability</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cc</span> <span class="o">=</span> <span class="n">solve_connected_components</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">edges_table</span><span class="p">,</span>
            <span class="n">df_predict</span><span class="p">,</span>
            <span class="n">concat_with_tf</span><span class="p">,</span>
            <span class="n">pairwise_formatting</span><span class="p">,</span>
            <span class="n">filter_pairwise_format_for_clusters</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cc</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">"threshold_match_probability"</span><span class="p">]</span> <span class="o">=</span> <span class="n">threshold_match_probability</span>

        <span class="k">return</span> <span class="n">cc</span>

    <span class="k">def</span> <span class="nf">_compute_metrics_nodes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">df_clustered</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">threshold_match_probability</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Internal function for computing node-level metrics.</span>

<span class="sd">        Accepts outputs of `linker.predict()` and</span>
<span class="sd">        `linker.cluster_pairwise_at_threshold()`, along with the clustering threshold</span>
<span class="sd">        and produces a table of node metrics.</span>

<span class="sd">        Node metrics produced:</span>
<span class="sd">        * node_degree (absolute number of neighbouring nodes)</span>

<span class="sd">        Output table has a single row per input node, along with the cluster id (as</span>
<span class="sd">        assigned in `linker.cluster_pairwise_at_threshold()`) and the metric</span>
<span class="sd">        node_degree:</span>
<span class="sd">        |-------------------------------------------------|</span>
<span class="sd">        | composite_unique_id | cluster_id  | node_degree |</span>
<span class="sd">        |---------------------|-------------|-------------|</span>
<span class="sd">        | s1-__-10001         | s1-__-10001 | 6           |</span>
<span class="sd">        | s1-__-10002         | s1-__-10001 | 4           |</span>
<span class="sd">        | s1-__-10003         | s1-__-10003 | 2           |</span>
<span class="sd">        ...</span>
<span class="sd">        """</span>
        <span class="n">uid_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_unique_id_input_columns</span>
        <span class="c1"># need composite unique ids</span>
        <span class="n">composite_uid_edges_l</span> <span class="o">=</span> <span class="n">_composite_unique_id_from_edges_sql</span><span class="p">(</span><span class="n">uid_cols</span><span class="p">,</span> <span class="s2">"l"</span><span class="p">)</span>
        <span class="n">composite_uid_edges_r</span> <span class="o">=</span> <span class="n">_composite_unique_id_from_edges_sql</span><span class="p">(</span><span class="n">uid_cols</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">)</span>
        <span class="n">composite_uid_clusters</span> <span class="o">=</span> <span class="n">_composite_unique_id_from_nodes_sql</span><span class="p">(</span><span class="n">uid_cols</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">_node_degree_sql</span><span class="p">(</span>
            <span class="n">df_predict</span><span class="p">,</span>
            <span class="n">df_clustered</span><span class="p">,</span>
            <span class="n">composite_uid_edges_l</span><span class="p">,</span>
            <span class="n">composite_uid_edges_r</span><span class="p">,</span>
            <span class="n">composite_uid_clusters</span><span class="p">,</span>
            <span class="n">threshold_match_probability</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">df_node_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">()</span>

        <span class="n">df_node_metrics</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span>
            <span class="s2">"threshold_match_probability"</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">threshold_match_probability</span>
        <span class="k">return</span> <span class="n">df_node_metrics</span>

    <span class="k">def</span> <span class="nf">_compute_metrics_edges</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_node_metrics</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">df_clustered</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">threshold_match_probability</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Internal function for computing edge-level metrics.</span>

<span class="sd">        Accepts outputs of `linker._compute_node_metrics()`, `linker.predict()` and</span>
<span class="sd">        `linker.cluster_pairwise_at_threshold()`, along with the clustering threshold</span>
<span class="sd">        and produces a table of edge metrics.</span>

<span class="sd">        Uses `igraph` under-the-hood for calculations</span>

<span class="sd">        Edge metrics produced:</span>
<span class="sd">        * is_bridge (is the edge a bridge?)</span>

<span class="sd">        Output table has a single row per edge, and the metric is_bridge:</span>
<span class="sd">        |-------------------------------------------------------------|</span>
<span class="sd">        | composite_unique_id_l | composite_unique_id_r   | is_bridge |</span>
<span class="sd">        |-----------------------|-------------------------|-----------|</span>
<span class="sd">        | s1-__-10001           | s1-__-10003             | True      |</span>
<span class="sd">        | s1-__-10001           | s1-__-10005             | False     |</span>
<span class="sd">        | s1-__-10005           | s1-__-10009             | False     |</span>
<span class="sd">        | s1-__-10021           | s1-__-10024             | True      |</span>
<span class="sd">        ...</span>
<span class="sd">        """</span>
        <span class="n">df_edge_metrics</span> <span class="o">=</span> <span class="n">compute_edge_metrics</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">df_node_metrics</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">,</span> <span class="n">df_clustered</span><span class="p">,</span> <span class="n">threshold_match_probability</span>
        <span class="p">)</span>
        <span class="n">df_edge_metrics</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span>
            <span class="s2">"threshold_match_probability"</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">threshold_match_probability</span>
        <span class="k">return</span> <span class="n">df_edge_metrics</span>

    <span class="k">def</span> <span class="nf">_compute_metrics_clusters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_node_metrics</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Internal function for computing cluster-level metrics.</span>

<span class="sd">        Accepts output of `linker._compute_node_metrics()` (which has the relevant</span>
<span class="sd">        information from `linker.predict() and</span>
<span class="sd">        `linker.cluster_pairwise_at_threshold()`), produces a table of cluster metrics.</span>

<span class="sd">        Cluster metrics produced:</span>
<span class="sd">        * n_nodes (aka cluster size, number of nodes in cluster)</span>
<span class="sd">        * n_edges (number of edges in cluster)</span>
<span class="sd">        * density (number of edges normalised wrt maximum possible number)</span>
<span class="sd">        * cluster_centralisation (average absolute deviation from maximum node_degree</span>
<span class="sd">            normalised wrt maximum possible value)</span>

<span class="sd">        Output table has a single row per cluster, along with the cluster metrics</span>
<span class="sd">        listed above</span>
<span class="sd">        |--------------------------------------------------------------------|</span>
<span class="sd">        | cluster_id  | n_nodes | n_edges | density | cluster_centralisation |</span>
<span class="sd">        |-------------|---------|---------|---------|------------------------|</span>
<span class="sd">        | s1-__-10006 | 4       | 4       | 0.66667 | 0.6666                 |</span>
<span class="sd">        | s1-__-10008 | 6       | 5       | 0.33333 | 0.4                    |</span>
<span class="sd">        | s1-__-10013 | 11      | 19      | 0.34545 | 0.3111                 |</span>
<span class="sd">        ...</span>
<span class="sd">        """</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">_size_density_centralisation_sql</span><span class="p">(</span>
            <span class="n">df_node_metrics</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">df_cluster_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">()</span>
        <span class="n">df_cluster_metrics</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span>
            <span class="s2">"threshold_match_probability"</span>
        <span class="p">]</span> <span class="o">=</span> <span class="n">df_node_metrics</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">"threshold_match_probability"</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">df_cluster_metrics</span>

    <span class="k">def</span> <span class="nf">compute_graph_metrics</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">df_clustered</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">threshold_match_probability</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GraphMetricsResults</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Generates tables containing graph metrics (for nodes, edges and clusters),</span>
<span class="sd">        and returns a data class of Splink dataframes</span>

<span class="sd">        Args:</span>
<span class="sd">            df_predict (SplinkDataFrame): The results of `linker.predict()`</span>
<span class="sd">            df_clustered (SplinkDataFrame): The outputs of</span>
<span class="sd">                `linker.cluster_pairwise_predictions_at_threshold()`</span>
<span class="sd">            threshold_match_probability (float, optional): Filter the pairwise match</span>
<span class="sd">                predictions to include only pairwise comparisons with a</span>
<span class="sd">                match_probability at or above this threshold. If not provided, the value</span>
<span class="sd">                will be taken from metadata on `df_clustered`. If no such metadata is</span>
<span class="sd">                available, this value _must_ be provided.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GraphMetricsResult: A data class containing SplinkDataFrames</span>
<span class="sd">            of cluster IDs and selected node, edge or cluster metrics.</span>
<span class="sd">                attribute "nodes" for nodes metrics table</span>
<span class="sd">                attribute "edges" for edge metrics table</span>
<span class="sd">                attribute "clusters" for cluster metrics table</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">threshold_match_probability</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">threshold_match_probability</span> <span class="o">=</span> <span class="n">df_clustered</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s2">"threshold_match_probability"</span><span class="p">,</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="c1"># we may not have metadata if clusters have been manually registered, or</span>
            <span class="c1"># read in from a format that does not include it</span>
            <span class="k">if</span> <span class="n">threshold_match_probability</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">"As `df_clustered` has no threshold metadata associated to it, "</span>
                    <span class="s2">"to compute graph metrics you must provide "</span>
                    <span class="s2">"`threshold_match_probability` manually"</span>
                <span class="p">)</span>
        <span class="n">df_node_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_metrics_nodes</span><span class="p">(</span>
            <span class="n">df_predict</span><span class="p">,</span> <span class="n">df_clustered</span><span class="p">,</span> <span class="n">threshold_match_probability</span>
        <span class="p">)</span>
        <span class="n">df_edge_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_metrics_edges</span><span class="p">(</span>
            <span class="n">df_node_metrics</span><span class="p">,</span>
            <span class="n">df_predict</span><span class="p">,</span>
            <span class="n">df_clustered</span><span class="p">,</span>
            <span class="n">threshold_match_probability</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># don't need edges as information is baked into node metrics</span>
        <span class="n">df_cluster_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_metrics_clusters</span><span class="p">(</span><span class="n">df_node_metrics</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">GraphMetricsResults</span><span class="p">(</span>
            <span class="n">nodes</span><span class="o">=</span><span class="n">df_node_metrics</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">df_edge_metrics</span><span class="p">,</span> <span class="n">clusters</span><span class="o">=</span><span class="n">df_cluster_metrics</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">profile_columns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column_expressions</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">bottom_n</span><span class="o">=</span><span class="mi">10</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Profiles the specified columns of the dataframe initiated with the linker.</span>

<span class="sd">        This can be computationally expensive if the dataframe is large.</span>

<span class="sd">        For the provided columns with column_expressions (or for all columns if</span>
<span class="sd">         left empty) calculate:</span>
<span class="sd">        - A distribution plot that shows the count of values at each percentile.</span>
<span class="sd">        - A top n chart, that produces a chart showing the count of the top n values</span>
<span class="sd">        within the column</span>
<span class="sd">        - A bottom n chart, that produces a chart showing the count of the bottom</span>
<span class="sd">        n values within the column</span>

<span class="sd">        This should be used to explore the dataframe, determine if columns have</span>
<span class="sd">        sufficient completeness for linking, analyse the cardinality of columns, and</span>
<span class="sd">        identify the need for standardisation within a given column.</span>

<span class="sd">        Args:</span>
<span class="sd">            linker (object): The initiated linker.</span>
<span class="sd">            column_expressions (list, optional): A list of strings containing the</span>
<span class="sd">                specified column names.</span>
<span class="sd">                If left empty this will default to all columns.</span>
<span class="sd">            top_n (int, optional): The number of top n values to plot.</span>
<span class="sd">            bottom_n (int, optional): The number of bottom n values to plot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart or dict: A visualization or JSON specification describing the</span>
<span class="sd">            profiling charts.</span>

<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = DuckDBLinker(df)</span>
<span class="sd">                linker.profile_columns()</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = SparkLinker(df)</span>
<span class="sd">                linker.profile_columns()</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-amazonaws: Athena"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = AthenaLinker(df)</span>
<span class="sd">                linker.profile_columns()</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-sqlite: SQLite"</span>
<span class="sd">                ```py</span>
<span class="sd">                linker = SQLiteLinker(df)</span>
<span class="sd">                linker.profile_columns()</span>
<span class="sd">                ```</span>

<span class="sd">        Note:</span>
<span class="sd">            - The `linker` object should be an instance of the initiated linker.</span>
<span class="sd">            - The provided `column_expressions` can be a list of column names to</span>
<span class="sd">                profile. If left empty, all columns will be profiled.</span>
<span class="sd">            - The `top_n` and `bottom_n` parameters determine the number of top and</span>
<span class="sd">                 bottom values to display in the respective charts.</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="n">profile_columns</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">column_expressions</span><span class="o">=</span><span class="n">column_expressions</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span> <span class="n">bottom_n</span><span class="o">=</span><span class="n">bottom_n</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_labels_tablename_from_input</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">SplinkDataFrame</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span> <span class="n">SplinkDataFrame</span><span class="p">):</span>
            <span class="n">labels_tablename</span> <span class="o">=</span> <span class="n">labels_splinkdataframe_or_table_name</span><span class="o">.</span><span class="n">physical_name</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">labels_tablename</span> <span class="o">=</span> <span class="n">labels_splinkdataframe_or_table_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">"The 'labels_splinkdataframe_or_table_name' argument"</span>
                <span class="s2">" must be of type SplinkDataframe or a string representing a tablename"</span>
                <span class="s2">" in the input database"</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">labels_tablename</span>

    <span class="k">def</span> <span class="nf">estimate_m_from_pairwise_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Estimate the m parameters of the linkage model from a dataframe of pairwise</span>
<span class="sd">        labels.</span>

<span class="sd">        The table of labels should be in the following format, and should</span>
<span class="sd">        be registered with your database:</span>
<span class="sd">        |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|</span>
<span class="sd">        |----------------|-----------|----------------|-----------|</span>
<span class="sd">        |df_1            |1          |df_2            |2          |</span>
<span class="sd">        |df_1            |1          |df_2            |3          |</span>

<span class="sd">        Note that `source_dataset` and `unique_id` should correspond to the</span>
<span class="sd">        values specified in the settings dict, and the `input_table_aliases`</span>
<span class="sd">        passed to the `linker` object. Note that at the moment, this method does</span>
<span class="sd">        not respect values in a `clerical_match_score` column.  If provided, these</span>
<span class="sd">        are ignored and it is assumed that every row in the table of labels is a score</span>
<span class="sd">        of 1, i.e. a perfect match.</span>

<span class="sd">        Args:</span>
<span class="sd">          labels_splinkdataframe_or_table_name (str): Name of table containing labels</span>
<span class="sd">            in the database or SplinkDataframe</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            pairwise_labels = pd.read_csv("./data/pairwise_labels_to_estimate_m.csv")</span>
<span class="sd">            linker.register_table(pairwise_labels, "labels", overwrite=True)</span>
<span class="sd">            linker.estimate_m_from_pairwise_labels("labels")</span>
<span class="sd">            ```</span>
<span class="sd">        """</span>
        <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
            <span class="n">labels_splinkdataframe_or_table_name</span>
        <span class="p">)</span>
        <span class="n">estimate_m_from_pairwise_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels_tablename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">truth_space_table_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Generate truth statistics (false positive etc.) for each threshold value of</span>
<span class="sd">        match_probability, suitable for plotting a ROC chart.</span>

<span class="sd">        The table of labels should be in the following format, and should be registered</span>
<span class="sd">        with your database:</span>

<span class="sd">        |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">        |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">        |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">        |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">        Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">        specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">        `linker` object.</span>

<span class="sd">        For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">                containing labels in the database</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the ROC chart. Defaults to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">                linker.register_table(labels, "labels")</span>
<span class="sd">                linker.truth_space_table_from_labels_table("labels")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">                labels.createDataFrame("labels")</span>
<span class="sd">                linker.truth_space_table_from_labels_table("labels")</span>
<span class="sd">                ```</span>
<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame:  Table of truth statistics</span>
<span class="sd">        """</span>
        <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
            <span class="n">labels_splinkdataframe_or_table_name</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_tablename</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">roc_chart_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a ROC chart from labelled (ground truth) data.</span>

<span class="sd">        The table of labels should be in the following format, and should be registered</span>
<span class="sd">        with your database:</span>

<span class="sd">        |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">        |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">        |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">        |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">        Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">        specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">        `linker` object.</span>

<span class="sd">        For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">                containing labels in the database</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the ROC chart. Defaults to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">                linker.register_table(labels, "labels")</span>
<span class="sd">                linker.roc_chart_from_labels_table("labels")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">                labels.createDataFrame("labels")</span>
<span class="sd">                linker.roc_chart_from_labels_table("labels")</span>
<span class="sd">                ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>
        <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
            <span class="n">labels_splinkdataframe_or_table_name</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
        <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_tablename</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">roc_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">precision_recall_chart_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a precision-recall chart from labelled (ground truth) data.</span>

<span class="sd">        The table of labels should be in the following format, and should be registered</span>
<span class="sd">        as a table with your database:</span>

<span class="sd">        |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">        |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">        |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">        |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">        Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">        specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">        `linker` object.</span>

<span class="sd">        For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">                containing labels in the database</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the ROC chart. Defaults to None.</span>
<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">                linker.register_table(labels, "labels")</span>
<span class="sd">                linker.precision_recall_chart_from_labels_table("labels")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">                labels.createDataFrame("labels")</span>
<span class="sd">                linker.precision_recall_chart_from_labels_table("labels")</span>
<span class="sd">                ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>
        <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
            <span class="n">labels_splinkdataframe_or_table_name</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
        <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_tablename</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">precision_recall_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">accuracy_chart_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">add_metrics</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate an accuracy measure chart from labelled (ground truth) data.</span>

<span class="sd">        The table of labels should be in the following format, and should be registered</span>
<span class="sd">        as a table with your database:</span>

<span class="sd">        |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">        |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">        |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">        |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">        Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">        specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">        `linker` object.</span>

<span class="sd">        For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">                containing labels in the database</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the chart. Defaults to None.</span>
<span class="sd">            add_metrics (list(str), optional): Precision and recall metrics are always</span>
<span class="sd">                included. Where provided, `add_metrics` specifies additional metrics</span>
<span class="sd">                to show, with the following options:</span>

<span class="sd">                - `"specificity"`: specificity, selectivity, true negative rate (TNR)</span>
<span class="sd">                - `"npv"`: negative predictive value (NPV)</span>
<span class="sd">                - `"accuracy"`: overall accuracy (TP+TN)/(P+N)</span>
<span class="sd">                - `"f1"`/`"f2"`/`"f0_5"`: F-scores for \u03B2=1 (balanced), \u03B2=2</span>
<span class="sd">                (emphasis on recall) and \u03B2=0.5 (emphasis on precision)</span>
<span class="sd">                - `"p4"` -  an extended F1 score with specificity and NPV included</span>
<span class="sd">                - `"phi"` - \u03C6 coefficient or Matthews correlation coefficient (MCC)</span>
<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">                linker.register_table(labels, "labels")</span>
<span class="sd">                linker.accuracy_chart_from_labels_table("labels", add_metrics=["f1"])</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">                labels.createDataFrame("labels")</span>
<span class="sd">                linker.accuracy_chart_from_labels_table("labels", add_metrics=['f1'])</span>
<span class="sd">                ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>
        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"specificity"</span><span class="p">,</span> <span class="s2">"npv"</span><span class="p">,</span> <span class="s2">"accuracy"</span><span class="p">,</span> <span class="s2">"f1"</span><span class="p">,</span> <span class="s2">"f2"</span><span class="p">,</span> <span class="s2">"f0_5"</span><span class="p">,</span> <span class="s2">"p4"</span><span class="p">,</span> <span class="s2">"phi"</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_metrics</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">"add_metrics must be a list containing one or more of the following:"</span><span class="p">,</span>
                <span class="n">allowed</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Silently filter out invalid entries (except case errors - e.g. ["NPV", "F1"])</span>
        <span class="n">add_metrics</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">add_metrics</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">allowed</span><span class="p">))</span>

        <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
            <span class="n">labels_splinkdataframe_or_table_name</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
        <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_tablename</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">accuracy_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">add_metrics</span><span class="o">=</span><span class="n">add_metrics</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">confusion_matrix_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">match_weight_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate an interactive confusion matrix from labelled (ground truth) data.</span>

<span class="sd">        The table of labels should be in the following format, and should be registered</span>
<span class="sd">        as a table with your database:</span>

<span class="sd">        |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">        |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">        |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">        |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">        Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">        specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">        `linker` object.</span>

<span class="sd">        For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">                containing labels in the database</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the chart. Defaults to None.</span>
<span class="sd">            match_weight_range (list(float), optional): minimum and maximum thresholds</span>
<span class="sd">                to include in chart output. Defaults to [-15,15].</span>
<span class="sd">        Examples:</span>
<span class="sd">            === ":simple-duckdb: DuckDB"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">                linker.register_table(labels, "labels")</span>
<span class="sd">                linker.confusion_matrix_from_labels_table("labels")</span>
<span class="sd">                ```</span>
<span class="sd">            === ":simple-apachespark: Spark"</span>
<span class="sd">                ```py</span>
<span class="sd">                labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">                labels.createDataFrame("labels")</span>
<span class="sd">                linker.confusion_matrix_from_labels_table("labels")</span>
<span class="sd">                ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
            <span class="n">labels_splinkdataframe_or_table_name</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
        <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_tablename</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">match_weight_range</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">[</span><span class="s2">"truth_threshold"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">confusion_matrix_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">match_weight_range</span><span class="o">=</span><span class="n">match_weight_range</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prediction_errors_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
        <span class="n">include_false_positives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_false_negatives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a dataframe containing false positives and false negatives</span>
<span class="sd">        based on the comparison between the clerical_match_score in the labels</span>
<span class="sd">        table compared with the splink predicted match probability</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">                containing labels in the database</span>
<span class="sd">            include_false_positives (bool, optional): Defaults to True.</span>
<span class="sd">            include_false_negatives (bool, optional): Defaults to True.</span>
<span class="sd">            threshold (float, optional): Threshold above which a score is considered</span>
<span class="sd">                to be a match. Defaults to 0.5.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame:  Table containing false positives and negatives</span>
<span class="sd">        """</span>
        <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
            <span class="n">labels_splinkdataframe_or_table_name</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">prediction_errors_from_labels_table</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_tablename</span><span class="p">,</span>
            <span class="n">include_false_positives</span><span class="p">,</span>
            <span class="n">include_false_negatives</span><span class="p">,</span>
            <span class="n">threshold</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">truth_space_table_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate truth statistics (false positive etc.) for each threshold value of</span>
<span class="sd">        match_probability, suitable for plotting a ROC chart.</span>

<span class="sd">        Your labels_column_name should include the ground truth cluster (unique</span>
<span class="sd">        identifier) that groups entities which are the same</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_tablename (str): Name of table containing labels in the database</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the ROC chart. Defaults to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.truth_space_table_from_labels_column("cluster")</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame:  Table of truth statistics</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">labels_column_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">roc_chart_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a ROC chart from ground truth data, whereby the ground truth</span>
<span class="sd">        is in a column in the input dataset called `labels_column_name`</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_column_name (str): Column name containing labels in the input table</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the ROC chart. Defaults to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.roc_chart_from_labels_column("labels")</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_column_name</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">roc_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">precision_recall_chart_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a precision-recall chart from ground truth data, whereby the ground</span>
<span class="sd">        truth is in a column in the input dataset called `labels_column_name`</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_column_name (str): Column name containing labels in the input table</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the ROC chart. Defaults to None.</span>
<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.precision_recall_chart_from_labels_column("ground_truth")</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_column_name</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">precision_recall_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">accuracy_chart_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">add_metrics</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate an accuracy chart from ground truth data, whereby the ground</span>
<span class="sd">        truth is in a column in the input dataset called `labels_column_name`</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_column_name (str): Column name containing labels in the input table</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the chart. Defaults to None.</span>
<span class="sd">            add_metrics (list(str), optional): Precision and recall metrics are always</span>
<span class="sd">                included. Where provided, `add_metrics` specifies additional metrics</span>
<span class="sd">                to show, with the following options:</span>

<span class="sd">                - `"specificity"`: specificity, selectivity, true negative rate (TNR)</span>
<span class="sd">                - `"npv"`: negative predictive value (NPV)</span>
<span class="sd">                - `"accuracy"`: overall accuracy (TP+TN)/(P+N)</span>
<span class="sd">                - `"f1"`/`"f2"`/`"f0_5"`: F-scores for \u03B2=1 (balanced), \u03B2=2</span>
<span class="sd">                (emphasis on recall) and \u03B2=0.5 (emphasis on precision)</span>
<span class="sd">                - `"p4"` -  an extended F1 score with specificity and NPV included</span>
<span class="sd">                - `"phi"` - \u03C6 coefficient or Matthews correlation coefficient (MCC)</span>
<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.accuracy_chart_from_labels_column("ground_truth", add_metrics=["f1"])</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"specificity"</span><span class="p">,</span> <span class="s2">"npv"</span><span class="p">,</span> <span class="s2">"accuracy"</span><span class="p">,</span> <span class="s2">"f1"</span><span class="p">,</span> <span class="s2">"f2"</span><span class="p">,</span> <span class="s2">"f0_5"</span><span class="p">,</span> <span class="s2">"p4"</span><span class="p">,</span> <span class="s2">"phi"</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_metrics</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">"add_metrics must be a list containing one or more of the following:"</span><span class="p">,</span>
                <span class="n">allowed</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Silently filter out invalid entries (except case errors - e.g. ["NPV", "F1"])</span>
        <span class="n">add_metrics</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">add_metrics</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">allowed</span><span class="p">))</span>

        <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_column_name</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">accuracy_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">add_metrics</span><span class="o">=</span><span class="n">add_metrics</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">confusion_matrix_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">match_weight_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate an accuracy chart from ground truth data, whereby the ground</span>
<span class="sd">        truth is in a column in the input dataset called `labels_column_name`</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_column_name (str): Column name containing labels in the input table</span>
<span class="sd">            threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">                provided by the user is a probability rather than binary, this value</span>
<span class="sd">                is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">                matches or non matches. Defaults to 0.5.</span>
<span class="sd">            match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">                are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">                sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">                the number of points plotted on the chart. Defaults to None.</span>
<span class="sd">            match_weight_range (list(float), optional): minimum and maximum thresholds</span>
<span class="sd">                to include in chart output. Defaults to [-15,15].</span>
<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.confusion_matrix_from_labels_column("ground_truth")</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">labels_column_name</span><span class="p">,</span>
            <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
            <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">match_weight_range</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">[</span><span class="s2">"truth_threshold"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">confusion_matrix_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">match_weight_range</span><span class="o">=</span><span class="n">match_weight_range</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prediction_errors_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">label_colname</span><span class="p">,</span>
        <span class="n">include_false_positives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">include_false_negatives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a dataframe containing false positives and false negatives</span>
<span class="sd">        based on the comparison between the splink match probability and the</span>
<span class="sd">        labels column.  A label column is a column in the input dataset that contains</span>
<span class="sd">        the 'ground truth' cluster to which the record belongs</span>

<span class="sd">        Args:</span>
<span class="sd">            label_colname (str): Name of labels column in input data</span>
<span class="sd">            include_false_positives (bool, optional): Defaults to True.</span>
<span class="sd">            include_false_negatives (bool, optional): Defaults to True.</span>
<span class="sd">            threshold (float, optional): Threshold above which a score is considered</span>
<span class="sd">                to be a match. Defaults to 0.5.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame:  Table containing false positives and negatives</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">prediction_errors_from_label_column</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">label_colname</span><span class="p">,</span>
            <span class="n">include_false_positives</span><span class="p">,</span>
            <span class="n">include_false_negatives</span><span class="p">,</span>
            <span class="n">threshold</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">match_weights_histogram</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span> <span class="n">target_bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">250</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a histogram that shows the distribution of match weights in</span>
<span class="sd">        `df_predict`</span>

<span class="sd">        Args:</span>
<span class="sd">            df_predict (SplinkDataFrame): Output of `linker.predict()`</span>
<span class="sd">            target_bins (int, optional): Target number of bins in histogram. Defaults to</span>
<span class="sd">                30.</span>
<span class="sd">            width (int, optional): Width of output. Defaults to 600.</span>
<span class="sd">            height (int, optional): Height of output chart. Defaults to 250.</span>


<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>

<span class="sd">        """</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">histogram_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">,</span> <span class="n">target_bins</span><span class="p">)</span>
        <span class="n">recs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">match_weights_histogram</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">waterfall_chart</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">filter_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_sensitive_data</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Visualise how the final match weight is computed for the provided pairwise</span>
<span class="sd">        record comparisons.</span>

<span class="sd">        Records must be provided as a list of dictionaries. This would usually be</span>
<span class="sd">        obtained from `df.as_record_dict(limit=n)` where `df` is a SplinkDataFrame.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            df = linker.predict(threshold_match_weight=2)</span>
<span class="sd">            records = df.as_record_dict(limit=10)</span>
<span class="sd">            linker.waterfall_chart(records)</span>
<span class="sd">            ```</span>

<span class="sd">        Args:</span>
<span class="sd">            records (List[dict]): Usually be obtained from `df.as_record_dict(limit=n)`</span>
<span class="sd">                where `df` is a SplinkDataFrame.</span>
<span class="sd">            filter_nulls (bool, optional): Whether the visualiation shows null</span>
<span class="sd">                comparisons, which have no effect on final match weight. Defaults to</span>
<span class="sd">                True.</span>
<span class="sd">            remove_sensitive_data (bool, optional): When True, The waterfall chart will</span>
<span class="sd">                contain match weights only, and all of the (potentially sensitive) data</span>
<span class="sd">                from the input tables will be removed prior to the chart being created.</span>


<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>

<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_waterfall_columns_not_computed</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">waterfall_chart</span><span class="p">(</span>
            <span class="n">records</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span> <span class="n">filter_nulls</span><span class="p">,</span> <span class="n">remove_sensitive_data</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">unlinkables_chart</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x_col</span><span class="o">=</span><span class="s2">"match_weight"</span><span class="p">,</span>
        <span class="n">source_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate an interactive chart displaying the proportion of records that</span>
<span class="sd">        are "unlinkable" for a given splink score threshold and model parameters.</span>

<span class="sd">        Unlinkable records are those that, even when compared with themselves, do not</span>
<span class="sd">        contain enough information to confirm a match.</span>

<span class="sd">        Args:</span>
<span class="sd">            x_col (str, optional): Column to use for the x-axis.</span>
<span class="sd">                Defaults to "match_weight".</span>
<span class="sd">            source_dataset (str, optional): Name of the source dataset to use for</span>
<span class="sd">                the title of the output chart.</span>
<span class="sd">            as_dict (bool, optional): If True, return a dict version of the chart.</span>

<span class="sd">        Examples:</span>
<span class="sd">            For the simplest code pipeline, load a pre-trained model</span>
<span class="sd">            and run this against the test data.</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.datasets import splink_datasets</span>
<span class="sd">            df = splink_datasets.fake_1000</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.load_settings("saved_settings.json")</span>
<span class="sd">            linker.unlinkables_chart()</span>
<span class="sd">            ```</span>
<span class="sd">            For more complex code pipelines, you can run an entire pipeline</span>
<span class="sd">            that estimates your m and u values, before `unlinkables_chart().</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="c1"># Link our initial df on itself and calculate the % of unlinkable entries</span>
        <span class="n">records</span> <span class="o">=</span> <span class="n">unlinkables_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">unlinkables_chart</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">x_col</span><span class="p">,</span> <span class="n">source_dataset</span><span class="p">,</span> <span class="n">as_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">comparison_viewer_dashboard</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_example_rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">return_html_as_string</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate an interactive html visualization of the linker's predictions and</span>
<span class="sd">        save to `out_path`.  For more information see</span>
<span class="sd">        [this video](https://www.youtube.com/watch?v=DNvCMqjipis)</span>


<span class="sd">        Args:</span>
<span class="sd">            df_predict (SplinkDataFrame): The outputs of `linker.predict()`</span>
<span class="sd">            out_path (str): The path (including filename) to save the html file to.</span>
<span class="sd">            overwrite (bool, optional): Overwrite the html file if it already exists?</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            num_example_rows (int, optional): Number of example rows per comparison</span>
<span class="sd">                vector. Defaults to 2.</span>
<span class="sd">            return_html_as_string: If True, return the html as a string</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            df_predictions = linker.predict()</span>
<span class="sd">            linker.comparison_viewer_dashboard(df_predictions, "scv.html", True, 2)</span>
<span class="sd">            ```</span>

<span class="sd">            Optionally, in Jupyter, you can display the results inline</span>
<span class="sd">            Otherwise you can just load the html file in your browser</span>
<span class="sd">            ```py</span>
<span class="sd">            from IPython.display import IFrame</span>
<span class="sd">            IFrame(src="./scv.html", width="100%", height=1200)</span>
<span class="sd">            ```</span>

<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_waterfall_columns_not_computed</span><span class="p">()</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="n">comparison_vector_distribution_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vector_distribution"</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">comparison_viewer_table_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_example_rows</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">([</span><span class="n">df_predict</span><span class="p">])</span>

        <span class="n">rendered</span> <span class="o">=</span> <span class="n">render_splink_comparison_viewer_html</span><span class="p">(</span>
            <span class="n">df</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">(),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_as_completed_dict</span><span class="p">(),</span>
            <span class="n">out_path</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">return_html_as_string</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">rendered</span>

    <span class="k">def</span> <span class="nf">parameter_estimate_comparisons_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_m</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_u</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Show a chart that shows how parameter estimates have differed across</span>
<span class="sd">        the different estimation methods you have used.</span>

<span class="sd">        For example, if you have run two EM estimation sessions, blocking on</span>
<span class="sd">        different variables, and both result in parameter estimates for</span>
<span class="sd">        first_name, this chart will enable easy comparison of the different</span>
<span class="sd">        estimates</span>

<span class="sd">        Args:</span>
<span class="sd">            include_m (bool, optional): Show different estimates of m values. Defaults</span>
<span class="sd">                to True.</span>
<span class="sd">            include_u (bool, optional): Show different estimates of u values. Defaults</span>
<span class="sd">                to False.</span>

<span class="sd">        """</span>
        <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_parameter_estimates_as_records</span>

        <span class="n">to_retain</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">include_m</span><span class="p">:</span>
            <span class="n">to_retain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"m"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">include_u</span><span class="p">:</span>
            <span class="n">to_retain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"u"</span><span class="p">)</span>

        <span class="n">records</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">"m_or_u"</span><span class="p">]</span> <span class="ow">in</span> <span class="n">to_retain</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">parameter_estimate_comparisons</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">missingness_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a summary chart of the missingness (prevalence of nulls) of</span>
<span class="sd">        columns in the input datasets.  By default, missingness is assessed across</span>
<span class="sd">        all input datasets</span>

<span class="sd">        Args:</span>
<span class="sd">            input_dataset (str, optional): Name of one of the input tables in the</span>
<span class="sd">                database.  If provided, missingness will be computed for</span>
<span class="sd">                this table alone.</span>
<span class="sd">                Defaults to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.missingness_chart()</span>
<span class="sd">            ```</span>
<span class="sd">            To view offline (if you don't have an internet connection):</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.charts import save_offline_chart</span>
<span class="sd">            c = linker.missingness_chart()</span>
<span class="sd">            save_offline_chart(c.to_dict(), "test_chart.html")</span>
<span class="sd">            ```</span>
<span class="sd">            View resultant html file in Jupyter (or just load it in your browser)</span>
<span class="sd">            ```py</span>
<span class="sd">            from IPython.display import IFrame</span>
<span class="sd">            IFrame(src="./test_chart.html", width=1000, height=500</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>
        <span class="n">records</span> <span class="o">=</span> <span class="n">missingness_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dataset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">missingness_chart</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">completeness_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate a summary chart of the completeness (proportion of non-nulls) of</span>
<span class="sd">        columns in each of the input datasets. By default, completeness is assessed for</span>
<span class="sd">        all column in the input data.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_dataset (str, optional): Name of one of the input tables in the</span>
<span class="sd">                database.  If provided, completeness will be computed for this table</span>
<span class="sd">                alone. Defaults to None.</span>
<span class="sd">            cols (List[str], optional): List of column names to calculate completeness.</span>
<span class="sd">                Default to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.completeness_chart()</span>
<span class="sd">            ```</span>
<span class="sd">            To view offline (if you don't have an internet connection):</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.charts import save_offline_chart</span>
<span class="sd">            c = linker.completeness_chart()</span>
<span class="sd">            save_offline_chart(c.to_dict(), "test_chart.html")</span>
<span class="sd">            ```</span>
<span class="sd">            View resultant html file in Jupyter (or just load it in your browser)</span>
<span class="sd">            ```py</span>
<span class="sd">            from IPython.display import IFrame</span>
<span class="sd">            IFrame(src="./test_chart.html", width=1000, height=500</span>
<span class="sd">            ```</span>
<span class="sd">        """</span>
        <span class="n">records</span> <span class="o">=</span> <span class="n">completeness_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dataset</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">completeness_chart</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">count_num_comparisons_from_blocking_rule</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">blocking_rule</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">BlockingRule</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Compute the number of pairwise record comparisons that would be generated by</span>
<span class="sd">        a blocking rule</span>

<span class="sd">        Args:</span>
<span class="sd">            blocking_rule (str | BlockingRule): The blocking rule to analyse</span>
<span class="sd">            link_type (str, optional): The link type.  This is needed only if the</span>
<span class="sd">                linker has not yet been provided with a settings dictionary.  Defaults</span>
<span class="sd">                to None.</span>
<span class="sd">            unique_id_column_name (str, optional):  This is needed only if the</span>
<span class="sd">                linker has not yet been provided with a settings dictionary.  Defaults</span>
<span class="sd">                to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            br = "l.surname = r.surname"</span>
<span class="sd">            linker.count_num_comparisons_from_blocking_rule(br)</span>
<span class="sd">            ```</span>
<span class="sd">            &gt; 19387</span>

<span class="sd">            ```py</span>
<span class="sd">            br = "l.name = r.name and substr(l.dob,1,4) = substr(r.dob,1,4)"</span>
<span class="sd">            linker.count_num_comparisons_from_blocking_rule(br)</span>
<span class="sd">            ```</span>
<span class="sd">            &gt; 394</span>
<span class="sd">            Alternatively, you can use the blocking rule library functions</span>
<span class="sd">            ```py</span>
<span class="sd">            import splink.duckdb.blocking_rule_library as brl</span>
<span class="sd">            br = brl.exact_match_rule("surname")</span>
<span class="sd">            linker.count_num_comparisons_from_blocking_rule(br)</span>
<span class="sd">            ```</span>
<span class="sd">            &gt; 3167</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The number of comparisons generated by the blocking rule</span>
<span class="sd">        """</span>

        <span class="n">blocking_rule</span> <span class="o">=</span> <span class="n">blocking_rule_to_obj</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span><span class="o">.</span><span class="n">blocking_rule_sql</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="n">vertically_concatenate_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_concat"</span><span class="p">)</span>

        <span class="n">sql</span> <span class="o">=</span> <span class="n">number_of_comparisons_generated_by_blocking_rule_post_filters_sql</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">blocking_rule</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__analyse_blocking_rule"</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">()</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="s2">"count_of_pairwise_comparisons_generated"</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_count_num_comparisons_from_blocking_rule_pre_filter_conditions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">blocking_rule</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Compute the number of pairwise record comparisons that would be generated by</span>
<span class="sd">        a blocking rule, prior to any filters (non equi-join conditions) being applied</span>
<span class="sd">        by the SQL engine.</span>

<span class="sd">        For more information on what this means, see</span>
<span class="sd">        https://github.com/moj-analytical-services/splink/discussions/1391</span>

<span class="sd">        Args:</span>
<span class="sd">            blocking_rule (str): The blocking rule to analyse</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The number of comparisons generated by the blocking rule</span>
<span class="sd">        """</span>

        <span class="n">input_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">df_concat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">df_concat</span><span class="p">:</span>
            <span class="n">input_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_concat</span><span class="p">)</span>

        <span class="n">sqls</span> <span class="o">=</span> <span class="n">count_comparisons_from_blocking_rule_pre_filter_conditions_sqls</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">blocking_rule</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span><span class="n">input_dataframes</span><span class="p">)</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="s2">"count_of_pairwise_comparisons_generated"</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">cumulative_comparisons_from_blocking_rules_records</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">blocking_rules</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">BlockingRule</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Output the number of comparisons generated by each successive blocking rule.</span>

<span class="sd">        This is equivalent to the output size of df_predict and details how many</span>
<span class="sd">        comparisons each of your individual blocking rules will contribute to the</span>
<span class="sd">        total.</span>

<span class="sd">        Args:</span>
<span class="sd">            blocking_rules (str or list): The blocking rule(s) to compute comparisons</span>
<span class="sd">                for. If null, the rules set out in your settings object will be used.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Generate total comparisons from Blocking Rules defined in settings</span>
<span class="sd">            dictionary</span>
<span class="sd">            ```py</span>
<span class="sd">            linker_settings = DuckDBLinker(df, settings)</span>
<span class="sd">            # Compute the cumulative number of comparisons generated by the rules</span>
<span class="sd">            # in your settings object.</span>
<span class="sd">            linker_settings.cumulative_comparisons_from_blocking_rules_records()</span>
<span class="sd">            ```</span>

<span class="sd">            Generate total comparisons with custom blocking rules.</span>
<span class="sd">            ```py</span>
<span class="sd">            blocking_rules = [</span>
<span class="sd">               "l.surname = r.surname",</span>
<span class="sd">               "l.first_name = r.first_name</span>
<span class="sd">                and substr(l.dob,1,4) = substr(r.dob,1,4)"</span>
<span class="sd">            ]</span>

<span class="sd">            linker_settings.cumulative_comparisons_from_blocking_rules_records(</span>
<span class="sd">                blocking_rules</span>
<span class="sd">             )</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            List: A list of blocking rules and the corresponding number of</span>
<span class="sd">                comparisons it is forecast to generate.</span>
<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">blocking_rules</span><span class="p">:</span>
            <span class="n">blocking_rules</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">)</span>

        <span class="n">records</span> <span class="o">=</span> <span class="n">cumulative_comparisons_generated_by_blocking_rules</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">blocking_rules</span><span class="p">,</span> <span class="n">output_chart</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">records</span>

    <span class="k">def</span> <span class="nf">cumulative_num_comparisons_from_blocking_rules_chart</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">blocking_rules</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">BlockingRule</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Display a chart with the cumulative number of comparisons generated by a</span>
<span class="sd">        selection of blocking rules.</span>

<span class="sd">        This is equivalent to the output size of df_predict and details how many</span>
<span class="sd">        comparisons each of your individual blocking rules will contribute to the</span>
<span class="sd">        total.</span>

<span class="sd">        Args:</span>
<span class="sd">            blocking_rules (str or list): The blocking rule(s) to compute comparisons</span>
<span class="sd">                for. If null, the rules set out in your settings object will be used.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker_settings = DuckDBLinker(df, settings)</span>
<span class="sd">            # Compute the cumulative number of comparisons generated by the rules</span>
<span class="sd">            # in your settings object.</span>
<span class="sd">            linker_settings.cumulative_num_comparisons_from_blocking_rules_chart()</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            # Generate total comparisons with custom blocking rules.</span>
<span class="sd">            blocking_rules = [</span>
<span class="sd">               "l.surname = r.surname",</span>
<span class="sd">               "l.first_name = r.first_name</span>
<span class="sd">                and substr(l.dob,1,4) = substr(r.dob,1,4)"</span>
<span class="sd">            ]</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            linker_settings.cumulative_num_comparisons_from_blocking_rules_chart(</span>
<span class="sd">                blocking_rules</span>
<span class="sd">             )</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="n">blocking_rules</span><span class="p">:</span>
            <span class="n">blocking_rules</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">)</span>

        <span class="n">records</span> <span class="o">=</span> <span class="n">cumulative_comparisons_generated_by_blocking_rules</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">blocking_rules</span><span class="p">,</span> <span class="n">output_chart</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">cumulative_blocking_rule_comparisons_generated</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">count_num_comparisons_from_blocking_rules_for_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Counts the marginal number of edges created from each of the blocking rules</span>
<span class="sd">        in `blocking_rules_to_generate_predictions`</span>

<span class="sd">        This is different to `count_num_comparisons_from_blocking_rule`</span>
<span class="sd">        because it (a) analyses multiple blocking rules rather than a single rule, and</span>
<span class="sd">        (b) deduplicates any comparisons that are generated, to tell you the</span>
<span class="sd">        marginal effect of each entry in `blocking_rules_to_generate_predictions`</span>

<span class="sd">        Args:</span>
<span class="sd">            df_predict (SplinkDataFrame): SplinkDataFrame with match weights</span>
<span class="sd">            and probabilities of rows matching</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.load_model("settings.json")</span>
<span class="sd">            df_predict = linker.predict(threshold_match_probability=0.95)</span>
<span class="sd">            count_pairwise = linker.count_num_comparisons_from_blocking_rules_for_prediction(df_predict)</span>
<span class="sd">            count_pairwise.as_pandas_dataframe(limit=5)</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            SplinkDataFrame: A SplinkDataFrame of the pairwise comparisons and</span>
<span class="sd">                estimated pairwise comparisons generated by the blocking rules.</span>
<span class="sd">        """</span>  <span class="c1"># noqa: E501</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="n">count_num_comparisons_from_blocking_rules_for_prediction_sql</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">df_predict</span>
        <span class="p">)</span>
        <span class="n">match_key_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_to_splink_dataframe_checking_cache</span><span class="p">(</span>
            <span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__match_key_analysis"</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">match_key_analysis</span>

    <span class="k">def</span> <span class="nf">match_weights_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Display a chart of the (partial) match weights of the linkage model</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.match_weights_chart()</span>
<span class="sd">            ```</span>
<span class="sd">            To view offline (if you don't have an internet connection):</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.charts import save_offline_chart</span>
<span class="sd">            c = linker.match_weights_chart()</span>
<span class="sd">            save_offline_chart(c.to_dict(), "test_chart.html")</span>
<span class="sd">            ```</span>
<span class="sd">            View resultant html file in Jupyter (or just load it in your browser)</span>
<span class="sd">            ```py</span>
<span class="sd">            from IPython.display import IFrame</span>
<span class="sd">            IFrame(src="./test_chart.html", width=1000, height=500)</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">match_weights_chart</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">tf_adjustment_chart</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output_column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">n_most_freq</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">n_least_freq</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">vals_to_include</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Display a chart showing the impact of term frequency adjustments on a</span>
<span class="sd">        specific comparison level.</span>
<span class="sd">        Each value</span>

<span class="sd">        Args:</span>
<span class="sd">            output_column_name (str): Name of an output column for which term frequency</span>
<span class="sd">                 adjustment has been applied.</span>
<span class="sd">            n_most_freq (int, optional): Number of most frequent values to show. If this</span>
<span class="sd">                 or `n_least_freq` set to None, all values will be shown.</span>
<span class="sd">                Default to 10.</span>
<span class="sd">            n_least_freq (int, optional): Number of least frequent values to show. If</span>
<span class="sd">                this or `n_most_freq` set to None, all values will be shown.</span>
<span class="sd">                Default to 10.</span>
<span class="sd">            vals_to_include (list, optional): Specific values for which to show term</span>
<span class="sd">                sfrequency adjustments.</span>
<span class="sd">                Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="c1"># Comparisons with TF adjustments</span>
        <span class="n">tf_comparisons</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">c</span><span class="o">.</span><span class="n">_output_column_name</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">comparisons</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">cl</span><span class="o">.</span><span class="n">_has_tf_adjustments</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">comparison_levels</span><span class="p">])</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">output_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tf_comparisons</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">output_column_name</span><span class="si">}</span><span class="s2"> is not a valid comparison column, or does not"</span>
                <span class="sa">f</span><span class="s2">" have term frequency adjustment activated"</span>
            <span class="p">)</span>

        <span class="n">vals_to_include</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">vals_to_include</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tf_adjustment_chart</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">output_column_name</span><span class="p">,</span>
            <span class="n">n_most_freq</span><span class="p">,</span>
            <span class="n">n_least_freq</span><span class="p">,</span>
            <span class="n">vals_to_include</span><span class="p">,</span>
            <span class="n">as_dict</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">m_u_parameters_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Display a chart of the m and u parameters of the linkage model</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.m_u_parameters_chart()</span>
<span class="sd">            ```</span>
<span class="sd">            To view offline (if you don't have an internet connection):</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.charts import save_offline_chart</span>
<span class="sd">            c = linker.match_weights_chart()</span>
<span class="sd">            save_offline_chart(c.to_dict(), "test_chart.html")</span>
<span class="sd">            ```</span>
<span class="sd">            View resultant html file in Jupyter (or just load it in your browser)</span>
<span class="sd">            ```py</span>
<span class="sd">            from IPython.display import IFrame</span>
<span class="sd">            IFrame(src="./test_chart.html", width=1000, height=500)</span>
<span class="sd">            ```</span>

<span class="sd">        Returns:</span>
<span class="sd">            altair.Chart: An altair chart</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">m_u_parameters_chart</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cluster_studio_dashboard</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">df_clustered</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
        <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sampling_method</span><span class="o">=</span><span class="s2">"random"</span><span class="p">,</span>
        <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">cluster_ids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cluster_names</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">return_html_as_string</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">_df_cluster_metrics</span><span class="p">:</span> <span class="n">SplinkDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Generate an interactive html visualization of the predicted cluster and</span>
<span class="sd">        save to `out_path`.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_predict (SplinkDataFrame): The outputs of `linker.predict()`</span>
<span class="sd">            df_clustered (SplinkDataFrame): The outputs of</span>
<span class="sd">                `linker.cluster_pairwise_predictions_at_threshold()`</span>
<span class="sd">            out_path (str): The path (including filename) to save the html file to.</span>
<span class="sd">            sampling_method (str, optional): `random`, `by_cluster_size` or</span>
<span class="sd">                `lowest_density_clusters`. Defaults to `random`.</span>
<span class="sd">            sample_size (int, optional): Number of clusters to show in the dahboard.</span>
<span class="sd">                Defaults to 10.</span>
<span class="sd">            cluster_ids (list): The IDs of the clusters that will be displayed in the</span>
<span class="sd">                dashboard.  If provided, ignore the `sampling_method` and `sample_size`</span>
<span class="sd">                arguments. Defaults to None.</span>
<span class="sd">            overwrite (bool, optional): Overwrite the html file if it already exists?</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">            cluster_names (list, optional): If provided, the dashboard will display</span>
<span class="sd">                these names in the selection box. Ony works in conjunction with</span>
<span class="sd">                `cluster_ids`.  Defaults to None.</span>
<span class="sd">            return_html_as_string: If True, return the html as a string</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            df_p = linker.predict()</span>
<span class="sd">            df_c = linker.cluster_pairwise_predictions_at_threshold(df_p, 0.5)</span>
<span class="sd">            linker.cluster_studio_dashboard(</span>
<span class="sd">                df_p, df_c, [0, 4, 7], "cluster_studio.html"</span>
<span class="sd">            )</span>
<span class="sd">            ```</span>
<span class="sd">            Optionally, in Jupyter, you can display the results inline</span>
<span class="sd">            Otherwise you can just load the html file in your browser</span>
<span class="sd">            ```py</span>
<span class="sd">            from IPython.display import IFrame</span>
<span class="sd">            IFrame(src="./cluster_studio.html", width="100%", height=1200)</span>
<span class="sd">            ```</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_waterfall_columns_not_computed</span><span class="p">()</span>

        <span class="n">rendered</span> <span class="o">=</span> <span class="n">render_splink_cluster_studio_html</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">df_predict</span><span class="p">,</span>
            <span class="n">df_clustered</span><span class="p">,</span>
            <span class="n">out_path</span><span class="p">,</span>
            <span class="n">sampling_method</span><span class="o">=</span><span class="n">sampling_method</span><span class="p">,</span>
            <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
            <span class="n">cluster_ids</span><span class="o">=</span><span class="n">cluster_ids</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
            <span class="n">cluster_names</span><span class="o">=</span><span class="n">cluster_names</span><span class="p">,</span>
            <span class="n">_df_cluster_metrics</span><span class="o">=</span><span class="n">_df_cluster_metrics</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">return_html_as_string</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">rendered</span>

    <span class="k">def</span> <span class="nf">save_model_to_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""Save the configuration and parameters of the linkage model to a `.json` file.</span>

<span class="sd">        The model can later be loaded back in using `linker.load_model()`.</span>
<span class="sd">        The settings dict is also returned in case you want to save it a different way.</span>

<span class="sd">        Examples:</span>
<span class="sd">            ```py</span>
<span class="sd">            linker.save_model_to_json("my_settings.json", overwrite=True)</span>
<span class="sd">            ```</span>
<span class="sd">        Args:</span>
<span class="sd">            out_path (str, optional): File path for json file. If None, don't save to</span>
<span class="sd">                file. Defaults to None.</span>
<span class="sd">            overwrite (bool, optional): Overwrite if already exists? Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The settings as a dictionary.</span>
<span class="sd">        """</span>
        <span class="n">model_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">out_path</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">out_path</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">"The path </span><span class="si">{</span><span class="n">out_path</span><span class="si">}</span><span class="s2"> already exists. Please provide a different "</span>
                    <span class="s2">"path or set overwrite=True"</span>
                <span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model_dict</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model_dict</span>

    <span class="k">def</span> <span class="nf">save_settings_to_json</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        This function is deprecated. Use save_model_to_json() instead.</span>
<span class="sd">        """</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">"This function is deprecated. Use save_model_to_json() instead."</span><span class="p">,</span>
            <span class="n">SplinkDeprecated</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_model_to_json</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">estimate_probability_two_random_records_match</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">deterministic_matching_rules</span><span class="p">,</span> <span class="n">recall</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Estimate the model parameter `probability_two_random_records_match` using</span>
<span class="sd">        a direct estimation approach.</span>

<span class="sd">        See [here](https://github.com/moj-analytical-services/splink/issues/462)</span>
<span class="sd">        for discussion of methodology</span>

<span class="sd">        Args:</span>
<span class="sd">            deterministic_matching_rules (list): A list of deterministic matching</span>
<span class="sd">                rules that should be designed to admit very few (none if possible)</span>
<span class="sd">                false positives</span>
<span class="sd">            recall (float): A guess at the recall the deterministic matching rules</span>
<span class="sd">                will attain.  i.e. what proportion of true matches will be recovered</span>
<span class="sd">                by these deterministic rules</span>
<span class="sd">        """</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">recall</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">recall</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Estimated recall must be greater than 0 "</span>
                <span class="sa">f</span><span class="s2">"and no more than 1. Supplied value </span><span class="si">{</span><span class="n">recall</span><span class="si">}</span><span class="s2">."</span>
            <span class="p">)</span>

        <span class="c1"># If user, by error, provides a single rule as a string</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">deterministic_matching_rules</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">deterministic_matching_rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">deterministic_matching_rules</span><span class="p">]</span>

        <span class="n">records</span> <span class="o">=</span> <span class="n">cumulative_comparisons_generated_by_blocking_rules</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">deterministic_matching_rules</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">summary_record</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">num_observed_matches</span> <span class="o">=</span> <span class="n">summary_record</span><span class="p">[</span><span class="s2">"cumulative_rows"</span><span class="p">]</span>
        <span class="n">num_total_comparisons</span> <span class="o">=</span> <span class="n">summary_record</span><span class="p">[</span><span class="s2">"cartesian"</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">num_observed_matches</span> <span class="o">&gt;</span> <span class="n">num_total_comparisons</span> <span class="o">*</span> <span class="n">recall</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Deterministic matching rules led to more "</span>
                <span class="sa">f</span><span class="s2">"observed matches than is consistent with supplied recall. "</span>
                <span class="sa">f</span><span class="s2">"With these rules, recall must be at least "</span>
                <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">num_observed_matches</span><span class="o">/</span><span class="n">num_total_comparisons</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">."</span>
            <span class="p">)</span>

        <span class="n">num_expected_matches</span> <span class="o">=</span> <span class="n">num_observed_matches</span> <span class="o">/</span> <span class="n">recall</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">num_expected_matches</span> <span class="o">/</span> <span class="n">num_total_comparisons</span>

        <span class="c1"># warn about boundary values, as these will usually be in error</span>
        <span class="k">if</span> <span class="n">num_observed_matches</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"WARNING: Deterministic matching rules led to no observed matches! "</span>
                <span class="sa">f</span><span class="s2">"This means that no possible record pairs are matches, "</span>
                <span class="sa">f</span><span class="s2">"and no records are linked to one another.</span><span class="se">\n</span><span class="s2">"</span>
                <span class="sa">f</span><span class="s2">"If this is truly the case then you do not need "</span>
                <span class="sa">f</span><span class="s2">"to run the linkage model.</span><span class="se">\n</span><span class="s2">"</span>
                <span class="sa">f</span><span class="s2">"However this is usually in error; "</span>
                <span class="sa">f</span><span class="s2">"expected rules to have recall of </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">recall</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">%. "</span>
                <span class="sa">f</span><span class="s2">"Consider revising rules as they may have an error."</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">prob</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">"WARNING: Probability two random records match is estimated to be 1.</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"This means that all possible record pairs are matches, "</span>
                <span class="s2">"and all records are linked to one another.</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"If this is truly the case then you do not need "</span>
                <span class="s2">"to run the linkage model.</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"However, it is more likely that this estimate is faulty. "</span>
                <span class="s2">"Perhaps your deterministic matching rules include "</span>
                <span class="s2">"too many false positives?"</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_probability_two_random_records_match</span> <span class="o">=</span> <span class="n">prob</span>

        <span class="n">reciprocal_prob</span> <span class="o">=</span> <span class="s2">"Infinity"</span> <span class="k">if</span> <span class="n">prob</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">prob</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">"</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"Probability two random records match is estimated to be  </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">"</span>
            <span class="sa">f</span><span class="s2">"This means that amongst all possible pairwise record comparisons, one in "</span>
            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">reciprocal_prob</span><span class="si">}</span><span class="s2"> are expected to match.  "</span>
            <span class="sa">f</span><span class="s2">"With </span><span class="si">{</span><span class="n">num_total_comparisons</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> total"</span>
            <span class="s2">" possible comparisons, we expect a total of around "</span>
            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">num_expected_matches</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2"> matching pairs"</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">invalidate_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Invalidate the Splink cache.  Any previously-computed tables</span>
<span class="sd">        will be recomputed.</span>
<span class="sd">        This is useful, for example, if the input data tables have changed.</span>
<span class="sd">        """</span>

        <span class="c1"># Nothing to delete</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Before Splink executes a SQL command, it checks the cache to see</span>
        <span class="c1"># whether a table already exists with the name of the output table</span>

        <span class="c1"># This function has the effect of changing the names of the output tables</span>
        <span class="c1"># to include a different unique id</span>

        <span class="c1"># As a result, any previously cached tables will not be found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span> <span class="o">=</span> <span class="n">ascii_uid</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

        <span class="c1"># Drop any existing splink tables from the database</span>
        <span class="c1"># Note, this is not actually necessary, it's just good housekeeping</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_tables_created_by_splink_from_db</span><span class="p">()</span>

        <span class="c1"># As a result, any previously cached tables will not be found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="o">.</span><span class="n">invalidate_cache</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">register_table_input_nodes_concat_with_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Register a pre-computed version of the input_nodes_concat_with_tf table that</span>
<span class="sd">        you want to re-use e.g. that you created in a previous run</span>

<span class="sd">        This method allowed you to register this table in the Splink cache</span>
<span class="sd">        so it will be used rather than Splink computing this table anew.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data: The data you wish to register. This can be either a dictionary,</span>
<span class="sd">                pandas dataframe, pyarrow table or a spark dataframe.</span>
<span class="sd">            overwrite (bool): Overwrite the table in the underlying database if it</span>
<span class="sd">                exists</span>
<span class="sd">        """</span>

        <span class="n">table_name_physical</span> <span class="o">=</span> <span class="s2">"__splink__df_concat_with_tf_"</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span>
        <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
            <span class="n">input_data</span><span class="p">,</span> <span class="n">table_name_physical</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
        <span class="p">)</span>
        <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__df_concat_with_tf"</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">]</span> <span class="o">=</span> <span class="n">splink_dataframe</span>
        <span class="k">return</span> <span class="n">splink_dataframe</span>

    <span class="k">def</span> <span class="nf">register_table_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">table_name_physical</span> <span class="o">=</span> <span class="s2">"__splink__df_predict_"</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span>
        <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
            <span class="n">input_data</span><span class="p">,</span> <span class="n">table_name_physical</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="s2">"__splink__df_predict"</span><span class="p">]</span> <span class="o">=</span> <span class="n">splink_dataframe</span>
        <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__df_predict"</span>
        <span class="k">return</span> <span class="n">splink_dataframe</span>

    <span class="k">def</span> <span class="nf">register_term_frequency_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">input_col</span> <span class="o">=</span> <span class="n">InputColumn</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span> <span class="n">settings_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
        <span class="n">table_name_templated</span> <span class="o">=</span> <span class="n">colname_to_tf_tablename</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span>
        <span class="n">table_name_physical</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">table_name_templated</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span><span class="si">}</span><span class="s2">"</span>
        <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
            <span class="n">input_data</span><span class="p">,</span> <span class="n">table_name_physical</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="n">table_name_templated</span><span class="p">]</span> <span class="o">=</span> <span class="n">splink_dataframe</span>
        <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="n">table_name_templated</span>
        <span class="k">return</span> <span class="n">splink_dataframe</span>

    <span class="k">def</span> <span class="nf">register_labels_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">table_name_physical</span> <span class="o">=</span> <span class="s2">"__splink__df_labels_"</span> <span class="o">+</span> <span class="n">ascii_uid</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
            <span class="n">input_data</span><span class="p">,</span> <span class="n">table_name_physical</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
        <span class="p">)</span>
        <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__df_labels"</span>
        <span class="k">return</span> <span class="n">splink_dataframe</span>

    <span class="k">def</span> <span class="nf">labelling_tool_for_specific_record</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">source_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">out_path</span><span class="o">=</span><span class="s2">"labelling_tool.html"</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">match_weight_threshold</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">view_in_jupyter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">show_splink_predictions_in_interface</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Create a standalone, offline labelling dashboard for a specific record</span>
<span class="sd">        as identified by its unique id</span>

<span class="sd">        Args:</span>
<span class="sd">            unique_id (str): The unique id of the record for which to create the</span>
<span class="sd">                labelling tool</span>
<span class="sd">            source_dataset (str, optional): If there are multiple datasets, to</span>
<span class="sd">                identify the record you must also specify the source_dataset. Defaults</span>
<span class="sd">                to None.</span>
<span class="sd">            out_path (str, optional): The output path for the labelling tool. Defaults</span>
<span class="sd">                to "labelling_tool.html".</span>
<span class="sd">            overwrite (bool, optional): If true, overwrite files at the output</span>
<span class="sd">                path if they exist. Defaults to False.</span>
<span class="sd">            match_weight_threshold (int, optional): Include possible matches in the</span>
<span class="sd">                output which score above this threshold. Defaults to -4.</span>
<span class="sd">            view_in_jupyter (bool, optional): If you're viewing in the Jupyter</span>
<span class="sd">                html viewer, set this to True to extract your labels. Defaults to False.</span>
<span class="sd">            show_splink_predictions_in_interface (bool, optional): Whether to</span>
<span class="sd">                show information about the Splink model's predictions that could</span>
<span class="sd">                potentially bias the decision of the clerical labeller. Defaults to</span>
<span class="sd">                True.</span>
<span class="sd">        """</span>

        <span class="n">df_comparisons</span> <span class="o">=</span> <span class="n">generate_labelling_tool_comparisons</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">unique_id</span><span class="p">,</span>
            <span class="n">source_dataset</span><span class="p">,</span>
            <span class="n">match_weight_threshold</span><span class="o">=</span><span class="n">match_weight_threshold</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">render_labelling_tool_html</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">df_comparisons</span><span class="p">,</span>
            <span class="n">show_splink_predictions_in_interface</span><span class="o">=</span><span class="n">show_splink_predictions_in_interface</span><span class="p">,</span>
            <span class="n">out_path</span><span class="o">=</span><span class="n">out_path</span><span class="p">,</span>
            <span class="n">view_in_jupyter</span><span class="o">=</span><span class="n">view_in_jupyter</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_remove_splinkdataframe_from_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">splink_dataframe</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">):</span>
        <span class="n">keys_to_delete</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">physical_name</span> <span class="o">==</span> <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">physical_name</span><span class="p">:</span>
                <span class="n">keys_to_delete</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys_to_delete</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_find_blocking_rules_below_threshold</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">max_comparisons_per_rule</span><span class="p">,</span> <span class="n">blocking_expressions</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="n">find_blocking_rules_below_threshold_comparison_count</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">max_comparisons_per_rule</span><span class="p">,</span> <span class="n">blocking_expressions</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_detect_blocking_rules_for_prediction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_comparisons_per_rule</span><span class="p">,</span>
        <span class="n">blocking_expressions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">min_freedom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">num_runs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">num_equi_join_weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">field_freedom_weight</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">num_brs_weight</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">num_comparison_weight</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">return_as_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Find blocking rules for prediction below some given threshold of the</span>
<span class="sd">        maximum number of comparisons that can be generated per blocking rule</span>
<span class="sd">        (max_comparisons_per_rule).</span>
<span class="sd">        Uses a heuristic cost algorithm to identify the 'best' set of blocking rules</span>
<span class="sd">        Args:</span>
<span class="sd">            max_comparisons_per_rule (int): The maximum number of comparisons that</span>
<span class="sd">                each blocking rule is allowed to generate</span>
<span class="sd">            blocking_expressions: By default, blocking rules will be equi-joins</span>
<span class="sd">                on the columns used by the Splink model.  This allows you to manually</span>
<span class="sd">                specify sql expressions from which combinations will be created. For</span>
<span class="sd">                example, if you specify ["substr(dob, 1,4)", "surname", "dob"]</span>
<span class="sd">                blocking rules will be chosen by blocking on combinations</span>
<span class="sd">                of those expressions.</span>
<span class="sd">            min_freedom (int, optional): The minimum amount of freedom any column should</span>
<span class="sd">                be allowed.</span>
<span class="sd">            num_runs (int, optional): Each run selects rows using a heuristic and costs</span>
<span class="sd">                them. The more runs, the more likely you are to find the best rule.</span>
<span class="sd">                Defaults to 5.</span>
<span class="sd">            num_equi_join_weight (int, optional): Weight allocated to number of equi</span>
<span class="sd">                joins in the blocking rules.</span>
<span class="sd">                Defaults to 0 since this is cost better captured by other criteria.</span>
<span class="sd">            field_freedom_weight (int, optional): Weight given to the cost of</span>
<span class="sd">                having individual fields which don't havem much flexibility.  Assigning</span>
<span class="sd">                a high weight here makes it more likely you'll generate combinations of</span>
<span class="sd">                blocking rules for which most fields are allowed to vary more than</span>
<span class="sd">                the minimum. Defaults to 1.</span>
<span class="sd">            num_brs_weight (int, optional): Weight assigned to the cost of</span>
<span class="sd">                additional blocking rules.  Higher weight here will result in a</span>
<span class="sd">                 preference for fewer blocking rules. Defaults to 10.</span>
<span class="sd">            num_comparison_weight (int, optional): Weight assigned to the cost of</span>
<span class="sd">                larger numbers of comparisons, which happens when more of the blocking</span>
<span class="sd">                rules are close to the max_comparisons_per_rule.  A higher</span>
<span class="sd">                 weight here prefers sets of rules which generate lower total</span>
<span class="sd">                comparisons. Defaults to 10.</span>
<span class="sd">            return_as_df (bool, optional): If false, assign recommendation to settings.</span>
<span class="sd">                If true, return a dataframe containing details of the weights.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">        """</span>

        <span class="n">df_br_below_thres</span> <span class="o">=</span> <span class="n">find_blocking_rules_below_threshold_comparison_count</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">max_comparisons_per_rule</span><span class="p">,</span> <span class="n">blocking_expressions</span>
        <span class="p">)</span>

        <span class="n">blocking_rule_suggestions</span> <span class="o">=</span> <span class="n">suggest_blocking_rules</span><span class="p">(</span>
            <span class="n">df_br_below_thres</span><span class="p">,</span>
            <span class="n">min_freedom</span><span class="o">=</span><span class="n">min_freedom</span><span class="p">,</span>
            <span class="n">num_runs</span><span class="o">=</span><span class="n">num_runs</span><span class="p">,</span>
            <span class="n">num_equi_join_weight</span><span class="o">=</span><span class="n">num_equi_join_weight</span><span class="p">,</span>
            <span class="n">field_freedom_weight</span><span class="o">=</span><span class="n">field_freedom_weight</span><span class="p">,</span>
            <span class="n">num_brs_weight</span><span class="o">=</span><span class="n">num_brs_weight</span><span class="p">,</span>
            <span class="n">num_comparison_weight</span><span class="o">=</span><span class="n">num_comparison_weight</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">return_as_df</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">blocking_rule_suggestions</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">blocking_rule_suggestions</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocking_rule_suggestions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"No set of blocking rules found within constraints"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">suggestion</span> <span class="o">=</span> <span class="n">blocking_rule_suggestions</span><span class="p">[</span>
                    <span class="s2">"suggested_blocking_rules_as_splink_brs"</span>
                <span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="n">suggestion</span>

                <span class="n">suggestion_str</span> <span class="o">=</span> <span class="n">blocking_rule_suggestions</span><span class="p">[</span>
                    <span class="s2">"suggested_blocking_rules_for_prediction"</span>
                <span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">"The following blocking_rules_to_generate_predictions were "</span>
                    <span class="s2">"automatically detected and assigned to your settings:</span><span class="se">\n</span><span class="s2">"</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">msg</span><span class="si">}{</span><span class="n">suggestion_str</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_detect_blocking_rules_for_em_training</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_comparisons_per_rule</span><span class="p">,</span>
        <span class="n">min_freedom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">num_runs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">num_equi_join_weight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">field_freedom_weight</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">num_brs_weight</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">num_comparison_weight</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">return_as_df</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Find blocking rules for EM training below some given threshold of the</span>
<span class="sd">        maximum number of comparisons that can be generated per blocking rule</span>
<span class="sd">        (max_comparisons_per_rule).</span>
<span class="sd">        Uses a heuristic cost algorithm to identify the 'best' set of blocking rules</span>
<span class="sd">        Args:</span>
<span class="sd">            max_comparisons_per_rule (int): The maximum number of comparisons that</span>
<span class="sd">                each blocking rule is allowed to generate</span>
<span class="sd">            min_freedom (int, optional): The minimum amount of freedom any column should</span>
<span class="sd">                be allowed.</span>
<span class="sd">            num_runs (int, optional): Each run selects rows using a heuristic and costs</span>
<span class="sd">                them.  The more runs, the more likely you are to find the best rule.</span>
<span class="sd">                Defaults to 5.</span>
<span class="sd">            num_equi_join_weight (int, optional): Weight allocated to number of equi</span>
<span class="sd">                joins in the blocking rules.</span>
<span class="sd">                Defaults to 0 since this is cost better captured by other criteria.</span>
<span class="sd">                Defaults to 0 since this is cost better captured by other criteria.</span>
<span class="sd">            field_freedom_weight (int, optional): Weight given to the cost of</span>
<span class="sd">                having individual fields which don't havem much flexibility.  Assigning</span>
<span class="sd">                a high weight here makes it more likely you'll generate combinations of</span>
<span class="sd">                blocking rules for which most fields are allowed to vary more than</span>
<span class="sd">                the minimum. Defaults to 1.</span>
<span class="sd">            num_brs_weight (int, optional): Weight assigned to the cost of</span>
<span class="sd">                additional blocking rules.  Higher weight here will result in a</span>
<span class="sd">                 preference for fewer blocking rules. Defaults to 10.</span>
<span class="sd">            num_comparison_weight (int, optional): Weight assigned to the cost of</span>
<span class="sd">                larger numbers of comparisons, which happens when more of the blocking</span>
<span class="sd">                rules are close to the max_comparisons_per_rule.  A higher</span>
<span class="sd">                 weight here prefers sets of rules which generate lower total</span>
<span class="sd">                comparisons. Defaults to 10.</span>
<span class="sd">            return_as_df (bool, optional): If false, return just the recommendation.</span>
<span class="sd">                If true, return a dataframe containing details of the weights.</span>
<span class="sd">                Defaults to False.</span>
<span class="sd">        """</span>

        <span class="n">df_br_below_thres</span> <span class="o">=</span> <span class="n">find_blocking_rules_below_threshold_comparison_count</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">max_comparisons_per_rule</span>
        <span class="p">)</span>

        <span class="n">blocking_rule_suggestions</span> <span class="o">=</span> <span class="n">suggest_blocking_rules</span><span class="p">(</span>
            <span class="n">df_br_below_thres</span><span class="p">,</span>
            <span class="n">min_freedom</span><span class="o">=</span><span class="n">min_freedom</span><span class="p">,</span>
            <span class="n">num_runs</span><span class="o">=</span><span class="n">num_runs</span><span class="p">,</span>
            <span class="n">num_equi_join_weight</span><span class="o">=</span><span class="n">num_equi_join_weight</span><span class="p">,</span>
            <span class="n">field_freedom_weight</span><span class="o">=</span><span class="n">field_freedom_weight</span><span class="p">,</span>
            <span class="n">num_brs_weight</span><span class="o">=</span><span class="n">num_brs_weight</span><span class="p">,</span>
            <span class="n">num_comparison_weight</span><span class="o">=</span><span class="n">num_comparison_weight</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">return_as_df</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">blocking_rule_suggestions</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">blocking_rule_suggestions</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">blocking_rule_suggestions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">"No set of blocking rules found within constraints"</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">suggestion_str</span> <span class="o">=</span> <span class="n">blocking_rule_suggestions</span><span class="p">[</span>
                    <span class="s2">"suggested_EM_training_statements"</span>
                <span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">"The following EM training strategy was detected:</span><span class="se">\n</span><span class="s2">"</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">msg</span><span class="si">}{</span><span class="n">suggestion_str</span><span class="si">}</span><span class="s2">"</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">suggestion</span> <span class="o">=</span> <span class="n">blocking_rule_suggestions</span><span class="p">[</span>
                    <span class="s2">"suggested_blocking_rules_as_splink_brs"</span>
                <span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">suggestion</span>

    <span class="k">def</span> <span class="nf">_explode_arrays_sql</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">tbl_name</span><span class="p">,</span> <span class="n">columns_to_explode</span><span class="p">,</span> <span class="n">other_columns_to_retain</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"Unnesting blocking rules are not supported for </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.__deepcopy__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__deepcopy__</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.__deepcopy__" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>When we do EM training, we need a copy of the linker which is independent
of the main linker e.g. setting parameters on the copy will not affect the
main linker.  This method implements ensures linker can be deepcopied.</p>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""When we do EM training, we need a copy of the linker which is independent</span>
<span class="sd">    of the main linker e.g. setting parameters on the copy will not affect the</span>
<span class="sd">    main linker.  This method implements ensures linker can be deepcopied.</span>
<span class="sd">    """</span>
    <span class="n">new_linker</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">new_linker</span><span class="o">.</span><span class="n">_em_training_sessions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">new_settings</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span><span class="p">)</span>
    <span class="n">new_linker</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="o">=</span> <span class="n">new_settings</span>
    <span class="k">return</span> <span class="n">new_linker</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">input_table_or_tables</span><span class="p">,</span> <span class="n">settings_dict</span><span class="p">,</span> <span class="n">accepted_df_dtypes</span><span class="p">,</span> <span class="n">set_up_basic_logging</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_table_aliases</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.__init__" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Initialise the linker object, which manages the data linkage process and
holds the data linkage model.</p>



<p><strong>Examples:</strong></p>
    <div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="splink.linker.Linker.__init__--__tabbed_1_1" name="splink.linker.Linker.__init__--__tabbed_1" type="radio"><input id="splink.linker.Linker.__init__--__tabbed_1_2" name="splink.linker.Linker.__init__--__tabbed_1" type="radio"><div class="tabbed-labels"><label for="splink.linker.Linker.__init__--__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 0C5.363 0 0 5.363 0 12s5.363 12 12 12 12-5.363 12-12S18.637 0 12 0zM9.502 7.03a4.974 4.974 0 0 1 4.97 4.97 4.974 4.974 0 0 1-4.97 4.97A4.974 4.974 0 0 1 4.532 12a4.974 4.974 0 0 1 4.97-4.97zm6.563 3.183h2.351c.98 0 1.787.782 1.787 1.762s-.807 1.789-1.787 1.789h-2.351v-3.551z"></path></svg></span> DuckDB</label><label for="splink.linker.Linker.__init__--__tabbed_1_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.593 3.593 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a551.9 551.9 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a4.874 4.874 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535c0 .023.002.045 0 .073-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098.349.117.697.231 1.045.347h.001c.02.012.045.02.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.783 2.783 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353.08 353.08 0 0 0-2.421-4.018 4.61 4.61 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.592.592 0 0 1 .189.211c.87 1.446 1.742 2.89 2.609 4.338.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217.367-.098.735-.193 1.103-.289a.399.399 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019c-.538-.18-1.077-.358-1.615-.539-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.398.398 0 0 1-.18.132c.035-.378.068-.757.104-1.136.149-1.572.297-3.144.451-4.716-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.595.595 0 0 1 .24-.134c1.797-.57 3.595-1.14 5.394-1.705.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441.241-1.363.483-2.726.726-4.088.068-.386.14-.771.21-1.157z"></path></svg></span> Spark</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Dedupe
</p><div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data_to_dedupe.csv"</span><span class="p">)</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings_dict</span><span class="p">)</span>
</code></pre></div>
Link
<div class="highlight"><pre><span></span><code><span class="n">df_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">"table_1/"</span><span class="p">)</span>
<span class="n">df_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">"table_2/"</span><span class="p">)</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span>
    <span class="p">[</span><span class="n">df_1</span><span class="p">,</span> <span class="n">df_2</span><span class="p">],</span>
    <span class="n">settings_dict</span><span class="p">,</span>
    <span class="n">input_table_aliases</span><span class="o">=</span><span class="p">[</span><span class="s2">"customers"</span><span class="p">,</span> <span class="s2">"contact_center_callers"</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div>
Dedupe with a pre-trained model read from a json file
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data_to_dedupe.csv"</span><span class="p">)</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">"model.json"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Dedupe
</p><div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">"data_to_dedupe.csv"</span><span class="p">)</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings_dict</span><span class="p">)</span>
</code></pre></div>
Link
<div class="highlight"><pre><span></span><code><span class="n">df_1</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">"table_1/"</span><span class="p">)</span>
<span class="n">df_2</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">"table_2/"</span><span class="p">)</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span>
    <span class="p">[</span><span class="n">df_1</span><span class="p">,</span> <span class="n">df_2</span><span class="p">],</span>
    <span class="n">settings_dict</span><span class="p">,</span>
    <span class="n">input_table_aliases</span><span class="o">=</span><span class="p">[</span><span class="s2">"customers"</span><span class="p">,</span> <span class="s2">"contact_center_callers"</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div>
Dedupe with a pre-trained model read from a json file
<div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">"data_to_dedupe.csv"</span><span class="p">)</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">"model.json"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_table_or_tables</code></td>
          <td>
                <code>Union[str, list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input data into the linkage model.
Either a single string (the name of a table in a database) for
deduplication jobs, or a list of strings  (the name of tables in a
database) for link_only or link_and_dedupe.  For some linkers, such as
the DuckDBLinker and the SparkLinker, it's also possible to pass in
dataframes (Pandas and Spark respectively) rather than strings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>settings_dict</code></td>
          <td>
                <code>dict | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A Splink settings dictionary, or a
path to a json defining a settingss dictionary or pre-trained model.
If not provided when the object is created, can later be added using
<code>linker.load_settings()</code> or <code>linker.load_model()</code> Defaults to None.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>set_up_basic_logging</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, sets ups up basic logging
so that Splink sends messages at INFO level to stdout. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>input_table_aliases</code></td>
          <td>
                <code>Union[str, list]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Labels assigned to
input tables in Splink outputs.  If the names of the tables in the
input database are long or unspecific, this argument can be used
to attach more easily readable/interpretable names. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>validate_settings</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When True, check your settings
dictionary for any potential errors that may cause splink to fail.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">input_table_or_tables</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">settings_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">accepted_df_dtypes</span><span class="p">,</span>
    <span class="n">set_up_basic_logging</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">input_table_aliases</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">validate_settings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Initialise the linker object, which manages the data linkage process and</span>
<span class="sd">    holds the data linkage model.</span>

<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            Dedupe</span>
<span class="sd">            ```py</span>
<span class="sd">            df = pd.read_csv("data_to_dedupe.csv")</span>
<span class="sd">            linker = DuckDBLinker(df, settings_dict)</span>
<span class="sd">            ```</span>
<span class="sd">            Link</span>
<span class="sd">            ```py</span>
<span class="sd">            df_1 = pd.read_parquet("table_1/")</span>
<span class="sd">            df_2 = pd.read_parquet("table_2/")</span>
<span class="sd">            linker = DuckDBLinker(</span>
<span class="sd">                [df_1, df_2],</span>
<span class="sd">                settings_dict,</span>
<span class="sd">                input_table_aliases=["customers", "contact_center_callers"]</span>
<span class="sd">                )</span>
<span class="sd">            ```</span>
<span class="sd">            Dedupe with a pre-trained model read from a json file</span>
<span class="sd">            ```py</span>
<span class="sd">            df = pd.read_csv("data_to_dedupe.csv")</span>
<span class="sd">            linker = DuckDBLinker(df, "model.json")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            Dedupe</span>
<span class="sd">            ```py</span>
<span class="sd">            df = spark.read.csv("data_to_dedupe.csv")</span>
<span class="sd">            linker = SparkLinker(df, settings_dict)</span>
<span class="sd">            ```</span>
<span class="sd">            Link</span>
<span class="sd">            ```py</span>
<span class="sd">            df_1 = spark.read.parquet("table_1/")</span>
<span class="sd">            df_2 = spark.read.parquet("table_2/")</span>
<span class="sd">            linker = SparkLinker(</span>
<span class="sd">                [df_1, df_2],</span>
<span class="sd">                settings_dict,</span>
<span class="sd">                input_table_aliases=["customers", "contact_center_callers"]</span>
<span class="sd">                )</span>
<span class="sd">            ```</span>
<span class="sd">            Dedupe with a pre-trained model read from a json file</span>
<span class="sd">            ```py</span>
<span class="sd">            df = spark.read.csv("data_to_dedupe.csv")</span>
<span class="sd">            linker = SparkLinker(df, "model.json")</span>
<span class="sd">            ```</span>

<span class="sd">    Args:</span>
<span class="sd">        input_table_or_tables (Union[str, list]): Input data into the linkage model.</span>
<span class="sd">            Either a single string (the name of a table in a database) for</span>
<span class="sd">            deduplication jobs, or a list of strings  (the name of tables in a</span>
<span class="sd">            database) for link_only or link_and_dedupe.  For some linkers, such as</span>
<span class="sd">            the DuckDBLinker and the SparkLinker, it's also possible to pass in</span>
<span class="sd">            dataframes (Pandas and Spark respectively) rather than strings.</span>
<span class="sd">        settings_dict (dict | Path, optional): A Splink settings dictionary, or a</span>
<span class="sd">            path to a json defining a settingss dictionary or pre-trained model.</span>
<span class="sd">            If not provided when the object is created, can later be added using</span>
<span class="sd">            `linker.load_settings()` or `linker.load_model()` Defaults to None.</span>
<span class="sd">        set_up_basic_logging (bool, optional): If true, sets ups up basic logging</span>
<span class="sd">            so that Splink sends messages at INFO level to stdout. Defaults to True.</span>
<span class="sd">        input_table_aliases (Union[str, list], optional): Labels assigned to</span>
<span class="sd">            input tables in Splink outputs.  If the names of the tables in the</span>
<span class="sd">            input database are long or unspecific, this argument can be used</span>
<span class="sd">            to attach more easily readable/interpretable names. Defaults to None.</span>
<span class="sd">        validate_settings (bool, optional): When True, check your settings</span>
<span class="sd">            dictionary for any potential errors that may cause splink to fail.</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_db_schema</span> <span class="o">=</span> <span class="s2">"splink"</span>
    <span class="k">if</span> <span class="n">set_up_basic_logging</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="nb">format</span><span class="o">=</span><span class="s2">"</span><span class="si">%(message)s</span><span class="s2">"</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">splink_logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">"splink"</span><span class="p">)</span>
        <span class="n">splink_logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span> <span class="o">=</span> <span class="n">SQLPipeline</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">CacheDictWithLogging</span><span class="p">()</span>

    <span class="n">homogenised_tables</span><span class="p">,</span> <span class="n">homogenised_aliases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_register_input_tables</span><span class="p">(</span>
        <span class="n">input_table_or_tables</span><span class="p">,</span>
        <span class="n">input_table_aliases</span><span class="p">,</span>
        <span class="n">accepted_df_dtypes</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_input_tables_dict</span><span class="p">(</span>
        <span class="n">homogenised_tables</span><span class="p">,</span> <span class="n">homogenised_aliases</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_setup_settings_objs</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">),</span> <span class="n">validate_settings</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_em_training_sessions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_train_u_using_random_sample_mode</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_self_link_mode</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_analyse_blocking_mode</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_deterministic_link_mode</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">debug_mode</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.accuracy_chart_from_labels_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">accuracy_chart_from_labels_column</span><span class="p">(</span><span class="n">labels_column_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_metrics</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#splink.linker.Linker.accuracy_chart_from_labels_column" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate an accuracy chart from ground truth data, whereby the ground
truth is in a column in the input dataset called <code>labels_column_name</code></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_column_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Column name containing labels in the input table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>add_metrics</code></td>
          <td>
                <code>list(str)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Precision and recall metrics are always
included. Where provided, <code>add_metrics</code> specifies additional metrics
to show, with the following options:</p>
<ul>
<li><code>"specificity"</code>: specificity, selectivity, true negative rate (TNR)</li>
<li><code>"npv"</code>: negative predictive value (NPV)</li>
<li><code>"accuracy"</code>: overall accuracy (TP+TN)/(P+N)</li>
<li><code>"f1"</code>/<code>"f2"</code>/<code>"f0_5"</code>: F-scores for =1 (balanced), =2
(emphasis on recall) and =0.5 (emphasis on precision)</li>
<li><code>"p4"</code> -  an extended F1 score with specificity and NPV included</li>
<li><code>"phi"</code> -  coefficient or Matthews correlation coefficient (MCC)</li>
</ul>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
    </tbody>
  </table>
      



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span>
<span class="normal">2940</span>
<span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">accuracy_chart_from_labels_column</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_column_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">add_metrics</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate an accuracy chart from ground truth data, whereby the ground</span>
<span class="sd">    truth is in a column in the input dataset called `labels_column_name`</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_column_name (str): Column name containing labels in the input table</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the chart. Defaults to None.</span>
<span class="sd">        add_metrics (list(str), optional): Precision and recall metrics are always</span>
<span class="sd">            included. Where provided, `add_metrics` specifies additional metrics</span>
<span class="sd">            to show, with the following options:</span>

<span class="sd">            - `"specificity"`: specificity, selectivity, true negative rate (TNR)</span>
<span class="sd">            - `"npv"`: negative predictive value (NPV)</span>
<span class="sd">            - `"accuracy"`: overall accuracy (TP+TN)/(P+N)</span>
<span class="sd">            - `"f1"`/`"f2"`/`"f0_5"`: F-scores for \u03B2=1 (balanced), \u03B2=2</span>
<span class="sd">            (emphasis on recall) and \u03B2=0.5 (emphasis on precision)</span>
<span class="sd">            - `"p4"` -  an extended F1 score with specificity and NPV included</span>
<span class="sd">            - `"phi"` - \u03C6 coefficient or Matthews correlation coefficient (MCC)</span>
<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.accuracy_chart_from_labels_column("ground_truth", add_metrics=["f1"])</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"specificity"</span><span class="p">,</span> <span class="s2">"npv"</span><span class="p">,</span> <span class="s2">"accuracy"</span><span class="p">,</span> <span class="s2">"f1"</span><span class="p">,</span> <span class="s2">"f2"</span><span class="p">,</span> <span class="s2">"f0_5"</span><span class="p">,</span> <span class="s2">"p4"</span><span class="p">,</span> <span class="s2">"phi"</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_metrics</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">"add_metrics must be a list containing one or more of the following:"</span><span class="p">,</span>
            <span class="n">allowed</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Silently filter out invalid entries (except case errors - e.g. ["NPV", "F1"])</span>
    <span class="n">add_metrics</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">add_metrics</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">allowed</span><span class="p">))</span>

    <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">accuracy_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">add_metrics</span><span class="o">=</span><span class="n">add_metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.accuracy_chart_from_labels_table" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">accuracy_chart_from_labels_table</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_metrics</span><span class="o">=</span><span class="p">[])</span></code>

<a href="#splink.linker.Linker.accuracy_chart_from_labels_table" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate an accuracy measure chart from labelled (ground truth) data.</p>
<p>The table of labels should be in the following format, and should be registered
as a table with your database:</p>
<table>
<thead>
<tr>
<th>source_dataset_l</th>
<th>unique_id_l</th>
<th>source_dataset_r</th>
<th>unique_id_r</th>
<th>clerical_match_score</th>
</tr>
</thead>
<tbody>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>2</td>
<td>0.99</td>
</tr>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>3</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>Note that <code>source_dataset</code> and <code>unique_id</code> should correspond to the values
specified in the settings dict, and the <code>input_table_aliases</code> passed to the
<code>linker</code> object.</p>
<p>For <code>dedupe_only</code> links, the <code>source_dataset</code> columns can be ommitted.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_splinkdataframe_or_table_name</code></td>
          <td>
                <code>str | <a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of table
containing labels in the database</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>add_metrics</code></td>
          <td>
                <code>list(str)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Precision and recall metrics are always
included. Where provided, <code>add_metrics</code> specifies additional metrics
to show, with the following options:</p>
<ul>
<li><code>"specificity"</code>: specificity, selectivity, true negative rate (TNR)</li>
<li><code>"npv"</code>: negative predictive value (NPV)</li>
<li><code>"accuracy"</code>: overall accuracy (TP+TN)/(P+N)</li>
<li><code>"f1"</code>/<code>"f2"</code>/<code>"f0_5"</code>: F-scores for =1 (balanced), =2
(emphasis on recall) and =0.5 (emphasis on precision)</li>
<li><code>"p4"</code> -  an extended F1 score with specificity and NPV included</li>
<li><code>"phi"</code> -  coefficient or Matthews correlation coefficient (MCC)</li>
</ul>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
    </tbody>
  </table>
      



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span>
<span class="normal">2657</span>
<span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span>
<span class="normal">2679</span>
<span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">accuracy_chart_from_labels_table</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">add_metrics</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate an accuracy measure chart from labelled (ground truth) data.</span>

<span class="sd">    The table of labels should be in the following format, and should be registered</span>
<span class="sd">    as a table with your database:</span>

<span class="sd">    |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">    |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">    |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">    |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">    Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">    specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">    `linker` object.</span>

<span class="sd">    For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">            containing labels in the database</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the chart. Defaults to None.</span>
<span class="sd">        add_metrics (list(str), optional): Precision and recall metrics are always</span>
<span class="sd">            included. Where provided, `add_metrics` specifies additional metrics</span>
<span class="sd">            to show, with the following options:</span>

<span class="sd">            - `"specificity"`: specificity, selectivity, true negative rate (TNR)</span>
<span class="sd">            - `"npv"`: negative predictive value (NPV)</span>
<span class="sd">            - `"accuracy"`: overall accuracy (TP+TN)/(P+N)</span>
<span class="sd">            - `"f1"`/`"f2"`/`"f0_5"`: F-scores for \u03B2=1 (balanced), \u03B2=2</span>
<span class="sd">            (emphasis on recall) and \u03B2=0.5 (emphasis on precision)</span>
<span class="sd">            - `"p4"` -  an extended F1 score with specificity and NPV included</span>
<span class="sd">            - `"phi"` - \u03C6 coefficient or Matthews correlation coefficient (MCC)</span>
<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">            linker.register_table(labels, "labels")</span>
<span class="sd">            linker.accuracy_chart_from_labels_table("labels", add_metrics=["f1"])</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">            labels.createDataFrame("labels")</span>
<span class="sd">            linker.accuracy_chart_from_labels_table("labels", add_metrics=['f1'])</span>
<span class="sd">            ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"specificity"</span><span class="p">,</span> <span class="s2">"npv"</span><span class="p">,</span> <span class="s2">"accuracy"</span><span class="p">,</span> <span class="s2">"f1"</span><span class="p">,</span> <span class="s2">"f2"</span><span class="p">,</span> <span class="s2">"f0_5"</span><span class="p">,</span> <span class="s2">"p4"</span><span class="p">,</span> <span class="s2">"phi"</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add_metrics</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">"add_metrics must be a list containing one or more of the following:"</span><span class="p">,</span>
            <span class="n">allowed</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Silently filter out invalid entries (except case errors - e.g. ["NPV", "F1"])</span>
    <span class="n">add_metrics</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">add_metrics</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">allowed</span><span class="p">))</span>

    <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
        <span class="n">labels_splinkdataframe_or_table_name</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
    <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_tablename</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">accuracy_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">add_metrics</span><span class="o">=</span><span class="n">add_metrics</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.cluster_pairwise_predictions_at_threshold" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cluster_pairwise_predictions_at_threshold</span><span class="p">(</span><span class="n">df_predict</span><span class="p">,</span> <span class="n">threshold_match_probability</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pairwise_formatting</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_pairwise_format_for_clusters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.cluster_pairwise_predictions_at_threshold" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Clusters the pairwise match predictions that result from <code>linker.predict()</code>
into groups of connected record using the connected components graph clustering
algorithm</p>
<p>Records with an estimated <code>match_probability</code> at or above
<code>threshold_match_probability</code> are considered to be a match (i.e. they represent
the same entity).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df_predict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The results of <code>linker.predict()</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_match_probability</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Filter the pairwise match predictions
to include only pairwise comparisons with a match_probability at or
above this threshold. This dataframe is then fed into the clustering
algorithm.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>pairwise_formatting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to output the pairwise match predictions
from linker.predict() with cluster IDs.
If this is set to false, the output will be a list of all IDs, clustered
into groups based on the desired match threshold.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>filter_pairwise_format_for_clusters</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If pairwise formatting has been
selected, whether to output all columns found within linker.predict(),
or just return clusters.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A SplinkDataFrame containing a list of all IDs, clustered
into groups based on the desired match threshold.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cluster_pairwise_predictions_at_threshold</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
    <span class="n">threshold_match_probability</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pairwise_formatting</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">filter_pairwise_format_for_clusters</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Clusters the pairwise match predictions that result from `linker.predict()`</span>
<span class="sd">    into groups of connected record using the connected components graph clustering</span>
<span class="sd">    algorithm</span>

<span class="sd">    Records with an estimated `match_probability` at or above</span>
<span class="sd">    `threshold_match_probability` are considered to be a match (i.e. they represent</span>
<span class="sd">    the same entity).</span>

<span class="sd">    Args:</span>
<span class="sd">        df_predict (SplinkDataFrame): The results of `linker.predict()`</span>
<span class="sd">        threshold_match_probability (float): Filter the pairwise match predictions</span>
<span class="sd">            to include only pairwise comparisons with a match_probability at or</span>
<span class="sd">            above this threshold. This dataframe is then fed into the clustering</span>
<span class="sd">            algorithm.</span>
<span class="sd">        pairwise_formatting (bool): Whether to output the pairwise match predictions</span>
<span class="sd">            from linker.predict() with cluster IDs.</span>
<span class="sd">            If this is set to false, the output will be a list of all IDs, clustered</span>
<span class="sd">            into groups based on the desired match threshold.</span>
<span class="sd">        filter_pairwise_format_for_clusters (bool): If pairwise formatting has been</span>
<span class="sd">            selected, whether to output all columns found within linker.predict(),</span>
<span class="sd">            or just return clusters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame: A SplinkDataFrame containing a list of all IDs, clustered</span>
<span class="sd">            into groups based on the desired match threshold.</span>

<span class="sd">    """</span>

    <span class="c1"># Feeding in df_predict forces materiailisation, if it exists in your database</span>
    <span class="n">concat_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">(</span><span class="n">df_predict</span><span class="p">)</span>

    <span class="n">edges_table</span> <span class="o">=</span> <span class="n">_cc_create_unique_id_cols</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">concat_with_tf</span><span class="o">.</span><span class="n">physical_name</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="o">.</span><span class="n">physical_name</span><span class="p">,</span>
        <span class="n">threshold_match_probability</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cc</span> <span class="o">=</span> <span class="n">solve_connected_components</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">edges_table</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">,</span>
        <span class="n">concat_with_tf</span><span class="p">,</span>
        <span class="n">pairwise_formatting</span><span class="p">,</span>
        <span class="n">filter_pairwise_format_for_clusters</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">cc</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">"threshold_match_probability"</span><span class="p">]</span> <span class="o">=</span> <span class="n">threshold_match_probability</span>

    <span class="k">return</span> <span class="n">cc</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.cluster_studio_dashboard" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cluster_studio_dashboard</span><span class="p">(</span><span class="n">df_predict</span><span class="p">,</span> <span class="n">df_clustered</span><span class="p">,</span> <span class="n">out_path</span><span class="p">,</span> <span class="n">sampling_method</span><span class="o">=</span><span class="s1">'random'</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cluster_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cluster_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_html_as_string</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">_df_cluster_metrics</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.cluster_studio_dashboard" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate an interactive html visualization of the predicted cluster and
save to <code>out_path</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df_predict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The outputs of <code>linker.predict()</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_clustered</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The outputs of
<code>linker.cluster_pairwise_predictions_at_threshold()</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>out_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path (including filename) to save the html file to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sampling_method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>random</code>, <code>by_cluster_size</code> or
<code>lowest_density_clusters</code>. Defaults to <code>random</code>.</p>
            </div>
          </td>
          <td>
                <code>'random'</code>
          </td>
        </tr>
        <tr>
          <td><code>sample_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of clusters to show in the dahboard.
Defaults to 10.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>cluster_ids</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The IDs of the clusters that will be displayed in the
dashboard.  If provided, ignore the <code>sampling_method</code> and <code>sample_size</code>
arguments. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>overwrite</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Overwrite the html file if it already exists?
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>cluster_names</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If provided, the dashboard will display
these names in the selection box. Ony works in conjunction with
<code>cluster_ids</code>.  Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>return_html_as_string</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, return the html as a string</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p></p><div class="highlight"><pre><span></span><code><span class="n">df_p</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">df_c</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">cluster_pairwise_predictions_at_threshold</span><span class="p">(</span><span class="n">df_p</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">cluster_studio_dashboard</span><span class="p">(</span>
    <span class="n">df_p</span><span class="p">,</span> <span class="n">df_c</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">"cluster_studio.html"</span>
<span class="p">)</span>
</code></pre></div>
Optionally, in Jupyter, you can display the results inline
Otherwise you can just load the html file in your browser
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">"./cluster_studio.html"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">"100%"</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3600</span>
<span class="normal">3601</span>
<span class="normal">3602</span>
<span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span>
<span class="normal">3606</span>
<span class="normal">3607</span>
<span class="normal">3608</span>
<span class="normal">3609</span>
<span class="normal">3610</span>
<span class="normal">3611</span>
<span class="normal">3612</span>
<span class="normal">3613</span>
<span class="normal">3614</span>
<span class="normal">3615</span>
<span class="normal">3616</span>
<span class="normal">3617</span>
<span class="normal">3618</span>
<span class="normal">3619</span>
<span class="normal">3620</span>
<span class="normal">3621</span>
<span class="normal">3622</span>
<span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span>
<span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span>
<span class="normal">3639</span>
<span class="normal">3640</span>
<span class="normal">3641</span>
<span class="normal">3642</span>
<span class="normal">3643</span>
<span class="normal">3644</span>
<span class="normal">3645</span>
<span class="normal">3646</span>
<span class="normal">3647</span>
<span class="normal">3648</span>
<span class="normal">3649</span>
<span class="normal">3650</span>
<span class="normal">3651</span>
<span class="normal">3652</span>
<span class="normal">3653</span>
<span class="normal">3654</span>
<span class="normal">3655</span>
<span class="normal">3656</span>
<span class="normal">3657</span>
<span class="normal">3658</span>
<span class="normal">3659</span>
<span class="normal">3660</span>
<span class="normal">3661</span>
<span class="normal">3662</span>
<span class="normal">3663</span>
<span class="normal">3664</span>
<span class="normal">3665</span>
<span class="normal">3666</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cluster_studio_dashboard</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
    <span class="n">df_clustered</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
    <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sampling_method</span><span class="o">=</span><span class="s2">"random"</span><span class="p">,</span>
    <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">cluster_ids</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">cluster_names</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">return_html_as_string</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">_df_cluster_metrics</span><span class="p">:</span> <span class="n">SplinkDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate an interactive html visualization of the predicted cluster and</span>
<span class="sd">    save to `out_path`.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_predict (SplinkDataFrame): The outputs of `linker.predict()`</span>
<span class="sd">        df_clustered (SplinkDataFrame): The outputs of</span>
<span class="sd">            `linker.cluster_pairwise_predictions_at_threshold()`</span>
<span class="sd">        out_path (str): The path (including filename) to save the html file to.</span>
<span class="sd">        sampling_method (str, optional): `random`, `by_cluster_size` or</span>
<span class="sd">            `lowest_density_clusters`. Defaults to `random`.</span>
<span class="sd">        sample_size (int, optional): Number of clusters to show in the dahboard.</span>
<span class="sd">            Defaults to 10.</span>
<span class="sd">        cluster_ids (list): The IDs of the clusters that will be displayed in the</span>
<span class="sd">            dashboard.  If provided, ignore the `sampling_method` and `sample_size`</span>
<span class="sd">            arguments. Defaults to None.</span>
<span class="sd">        overwrite (bool, optional): Overwrite the html file if it already exists?</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        cluster_names (list, optional): If provided, the dashboard will display</span>
<span class="sd">            these names in the selection box. Ony works in conjunction with</span>
<span class="sd">            `cluster_ids`.  Defaults to None.</span>
<span class="sd">        return_html_as_string: If True, return the html as a string</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        df_p = linker.predict()</span>
<span class="sd">        df_c = linker.cluster_pairwise_predictions_at_threshold(df_p, 0.5)</span>
<span class="sd">        linker.cluster_studio_dashboard(</span>
<span class="sd">            df_p, df_c, [0, 4, 7], "cluster_studio.html"</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>
<span class="sd">        Optionally, in Jupyter, you can display the results inline</span>
<span class="sd">        Otherwise you can just load the html file in your browser</span>
<span class="sd">        ```py</span>
<span class="sd">        from IPython.display import IFrame</span>
<span class="sd">        IFrame(src="./cluster_studio.html", width="100%", height=1200)</span>
<span class="sd">        ```</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_waterfall_columns_not_computed</span><span class="p">()</span>

    <span class="n">rendered</span> <span class="o">=</span> <span class="n">render_splink_cluster_studio_html</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">,</span>
        <span class="n">df_clustered</span><span class="p">,</span>
        <span class="n">out_path</span><span class="p">,</span>
        <span class="n">sampling_method</span><span class="o">=</span><span class="n">sampling_method</span><span class="p">,</span>
        <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
        <span class="n">cluster_ids</span><span class="o">=</span><span class="n">cluster_ids</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
        <span class="n">cluster_names</span><span class="o">=</span><span class="n">cluster_names</span><span class="p">,</span>
        <span class="n">_df_cluster_metrics</span><span class="o">=</span><span class="n">_df_cluster_metrics</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">return_html_as_string</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rendered</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.compare_two_records" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compare_two_records</span><span class="p">(</span><span class="n">record_1</span><span class="p">,</span> <span class="n">record_2</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.compare_two_records" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Use the linkage model to compare and score a pairwise record comparison
based on the two input records provided</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>record_1</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dictionary representing the first record.  Columns names
and data types must be the same as the columns in the settings object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>record_2</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dictionary representing the second record.  Columns names
and data types must be the same as the columns in the settings object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="s2">"saved_settings.json"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">compare_two_records</span><span class="p">(</span><span class="n">record_left</span><span class="p">,</span> <span class="n">record_right</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Pairwise comparison with scored prediction</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compare_two_records</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record_1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">record_2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Use the linkage model to compare and score a pairwise record comparison</span>
<span class="sd">    based on the two input records provided</span>

<span class="sd">    Args:</span>
<span class="sd">        record_1 (dict): dictionary representing the first record.  Columns names</span>
<span class="sd">            and data types must be the same as the columns in the settings object</span>
<span class="sd">        record_2 (dict): dictionary representing the second record.  Columns names</span>
<span class="sd">            and data types must be the same as the columns in the settings object</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker = DuckDBLinker(df)</span>
<span class="sd">        linker.load_settings("saved_settings.json")</span>
<span class="sd">        linker.compare_two_records(record_left, record_right)</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame: Pairwise comparison with scored prediction</span>
<span class="sd">    """</span>
    <span class="n">original_blocking_rules</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span>
    <span class="p">)</span>
    <span class="n">original_link_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">uid</span> <span class="o">=</span> <span class="n">ascii_uid</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">df_records_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
        <span class="p">[</span><span class="n">record_1</span><span class="p">],</span> <span class="sa">f</span><span class="s2">"__splink__compare_two_records_left_</span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">df_records_left</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__compare_two_records_left"</span>

    <span class="n">df_records_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
        <span class="p">[</span><span class="n">record_2</span><span class="p">],</span> <span class="sa">f</span><span class="s2">"__splink__compare_two_records_right_</span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">df_records_right</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__compare_two_records_right"</span>

    <span class="n">sql_join_tf</span> <span class="o">=</span> <span class="n">_join_tf_to_input_df_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">sql_join_tf</span> <span class="o">=</span> <span class="n">sql_join_tf</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s2">"__splink__df_concat"</span><span class="p">,</span> <span class="s2">"__splink__compare_two_records_left"</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql_join_tf</span><span class="p">,</span> <span class="s2">"__splink__compare_two_records_left_with_tf"</span><span class="p">)</span>

    <span class="n">sql_join_tf</span> <span class="o">=</span> <span class="n">sql_join_tf</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="s2">"__splink__compare_two_records_left"</span><span class="p">,</span> <span class="s2">"__splink__compare_two_records_right"</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql_join_tf</span><span class="p">,</span> <span class="s2">"__splink__compare_two_records_right_with_tf"</span><span class="p">)</span>

    <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="n">compute_comparison_vector_values_sql</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vectors"</span><span class="p">)</span>

    <span class="n">sqls</span> <span class="o">=</span> <span class="n">predict_from_comparison_vectors_sqls</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span>
        <span class="n">sql_infinity_expression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_infinity_expression</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span>
        <span class="p">[</span><span class="n">df_records_left</span><span class="p">,</span> <span class="n">df_records_right</span><span class="p">],</span> <span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">original_blocking_rules</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span> <span class="o">=</span> <span class="n">original_link_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_compare_two_records_mode</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.comparison_viewer_dashboard" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">comparison_viewer_dashboard</span><span class="p">(</span><span class="n">df_predict</span><span class="p">,</span> <span class="n">out_path</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_example_rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">return_html_as_string</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.comparison_viewer_dashboard" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate an interactive html visualization of the linker's predictions and
save to <code>out_path</code>.  For more information see
<a href="https://www.youtube.com/watch?v=DNvCMqjipis">this video</a></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df_predict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The outputs of <code>linker.predict()</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>out_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path (including filename) to save the html file to.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>overwrite</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Overwrite the html file if it already exists?
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>num_example_rows</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of example rows per comparison
vector. Defaults to 2.</p>
            </div>
          </td>
          <td>
                <code>2</code>
          </td>
        </tr>
        <tr>
          <td><code>return_html_as_string</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, return the html as a string</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">df_predictions</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">linker</span><span class="o">.</span><span class="n">comparison_viewer_dashboard</span><span class="p">(</span><span class="n">df_predictions</span><span class="p">,</span> <span class="s2">"scv.html"</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<p>Optionally, in Jupyter, you can display the results inline
Otherwise you can just load the html file in your browser
</p><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">"./scv.html"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">"100%"</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1200</span><span class="p">)</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3135</span>
<span class="normal">3136</span>
<span class="normal">3137</span>
<span class="normal">3138</span>
<span class="normal">3139</span>
<span class="normal">3140</span>
<span class="normal">3141</span>
<span class="normal">3142</span>
<span class="normal">3143</span>
<span class="normal">3144</span>
<span class="normal">3145</span>
<span class="normal">3146</span>
<span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span>
<span class="normal">3172</span>
<span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span>
<span class="normal">3176</span>
<span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span>
<span class="normal">3180</span>
<span class="normal">3181</span>
<span class="normal">3182</span>
<span class="normal">3183</span>
<span class="normal">3184</span>
<span class="normal">3185</span>
<span class="normal">3186</span>
<span class="normal">3187</span>
<span class="normal">3188</span>
<span class="normal">3189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">comparison_viewer_dashboard</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
    <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">num_example_rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">return_html_as_string</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate an interactive html visualization of the linker's predictions and</span>
<span class="sd">    save to `out_path`.  For more information see</span>
<span class="sd">    [this video](https://www.youtube.com/watch?v=DNvCMqjipis)</span>


<span class="sd">    Args:</span>
<span class="sd">        df_predict (SplinkDataFrame): The outputs of `linker.predict()`</span>
<span class="sd">        out_path (str): The path (including filename) to save the html file to.</span>
<span class="sd">        overwrite (bool, optional): Overwrite the html file if it already exists?</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        num_example_rows (int, optional): Number of example rows per comparison</span>
<span class="sd">            vector. Defaults to 2.</span>
<span class="sd">        return_html_as_string: If True, return the html as a string</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        df_predictions = linker.predict()</span>
<span class="sd">        linker.comparison_viewer_dashboard(df_predictions, "scv.html", True, 2)</span>
<span class="sd">        ```</span>

<span class="sd">        Optionally, in Jupyter, you can display the results inline</span>
<span class="sd">        Otherwise you can just load the html file in your browser</span>
<span class="sd">        ```py</span>
<span class="sd">        from IPython.display import IFrame</span>
<span class="sd">        IFrame(src="./scv.html", width="100%", height=1200)</span>
<span class="sd">        ```</span>

<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_waterfall_columns_not_computed</span><span class="p">()</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="n">comparison_vector_distribution_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vector_distribution"</span><span class="p">)</span>

    <span class="n">sqls</span> <span class="o">=</span> <span class="n">comparison_viewer_table_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_example_rows</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">([</span><span class="n">df_predict</span><span class="p">])</span>

    <span class="n">rendered</span> <span class="o">=</span> <span class="n">render_splink_comparison_viewer_html</span><span class="p">(</span>
        <span class="n">df</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">(),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_as_completed_dict</span><span class="p">(),</span>
        <span class="n">out_path</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">return_html_as_string</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">rendered</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.completeness_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">completeness_chart</span><span class="p">(</span><span class="n">input_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.completeness_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a summary chart of the completeness (proportion of non-nulls) of
columns in each of the input datasets. By default, completeness is assessed for
all column in the input data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_dataset</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of one of the input tables in the
database.  If provided, completeness will be computed for this table
alone. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>cols</code></td>
          <td>
                <code>List[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of column names to calculate completeness.
Default to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p></p><div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">completeness_chart</span><span class="p">()</span>
</code></pre></div>
To view offline (if you don't have an internet connection):
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.charts</span> <span class="kn">import</span> <span class="n">save_offline_chart</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">completeness_chart</span><span class="p">()</span>
<span class="n">save_offline_chart</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="s2">"test_chart.html"</span><span class="p">)</span>
</code></pre></div>
View resultant html file in Jupyter (or just load it in your browser)
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">"./test_chart.html"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span>
<span class="normal">3261</span>
<span class="normal">3262</span>
<span class="normal">3263</span>
<span class="normal">3264</span>
<span class="normal">3265</span>
<span class="normal">3266</span>
<span class="normal">3267</span>
<span class="normal">3268</span>
<span class="normal">3269</span>
<span class="normal">3270</span>
<span class="normal">3271</span>
<span class="normal">3272</span>
<span class="normal">3273</span>
<span class="normal">3274</span>
<span class="normal">3275</span>
<span class="normal">3276</span>
<span class="normal">3277</span>
<span class="normal">3278</span>
<span class="normal">3279</span>
<span class="normal">3280</span>
<span class="normal">3281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">completeness_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a summary chart of the completeness (proportion of non-nulls) of</span>
<span class="sd">    columns in each of the input datasets. By default, completeness is assessed for</span>
<span class="sd">    all column in the input data.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_dataset (str, optional): Name of one of the input tables in the</span>
<span class="sd">            database.  If provided, completeness will be computed for this table</span>
<span class="sd">            alone. Defaults to None.</span>
<span class="sd">        cols (List[str], optional): List of column names to calculate completeness.</span>
<span class="sd">            Default to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.completeness_chart()</span>
<span class="sd">        ```</span>
<span class="sd">        To view offline (if you don't have an internet connection):</span>
<span class="sd">        ```py</span>
<span class="sd">        from splink.charts import save_offline_chart</span>
<span class="sd">        c = linker.completeness_chart()</span>
<span class="sd">        save_offline_chart(c.to_dict(), "test_chart.html")</span>
<span class="sd">        ```</span>
<span class="sd">        View resultant html file in Jupyter (or just load it in your browser)</span>
<span class="sd">        ```py</span>
<span class="sd">        from IPython.display import IFrame</span>
<span class="sd">        IFrame(src="./test_chart.html", width=1000, height=500</span>
<span class="sd">        ```</span>
<span class="sd">    """</span>
    <span class="n">records</span> <span class="o">=</span> <span class="n">completeness_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dataset</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">completeness_chart</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.compute_graph_metrics" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_graph_metrics</span><span class="p">(</span><span class="n">df_predict</span><span class="p">,</span> <span class="n">df_clustered</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">threshold_match_probability</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.compute_graph_metrics" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generates tables containing graph metrics (for nodes, edges and clusters),
and returns a data class of Splink dataframes</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df_predict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The results of <code>linker.predict()</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>df_clustered</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The outputs of
<code>linker.cluster_pairwise_predictions_at_threshold()</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_match_probability</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Filter the pairwise match
predictions to include only pairwise comparisons with a
match_probability at or above this threshold. If not provided, the value
will be taken from metadata on <code>df_clustered</code>. If no such metadata is
available, this value <em>must</em> be provided.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>GraphMetricsResult</code></td>          <td>
                <code><span title="splink.graph_metrics.GraphMetricsResults">GraphMetricsResults</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A data class containing SplinkDataFrames</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
                <code><span title="splink.graph_metrics.GraphMetricsResults">GraphMetricsResults</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>of cluster IDs and selected node, edge or cluster metrics.
attribute "nodes" for nodes metrics table
attribute "edges" for edge metrics table
attribute "clusters" for cluster metrics table</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_graph_metrics</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
    <span class="n">df_clustered</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">threshold_match_probability</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GraphMetricsResults</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates tables containing graph metrics (for nodes, edges and clusters),</span>
<span class="sd">    and returns a data class of Splink dataframes</span>

<span class="sd">    Args:</span>
<span class="sd">        df_predict (SplinkDataFrame): The results of `linker.predict()`</span>
<span class="sd">        df_clustered (SplinkDataFrame): The outputs of</span>
<span class="sd">            `linker.cluster_pairwise_predictions_at_threshold()`</span>
<span class="sd">        threshold_match_probability (float, optional): Filter the pairwise match</span>
<span class="sd">            predictions to include only pairwise comparisons with a</span>
<span class="sd">            match_probability at or above this threshold. If not provided, the value</span>
<span class="sd">            will be taken from metadata on `df_clustered`. If no such metadata is</span>
<span class="sd">            available, this value _must_ be provided.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GraphMetricsResult: A data class containing SplinkDataFrames</span>
<span class="sd">        of cluster IDs and selected node, edge or cluster metrics.</span>
<span class="sd">            attribute "nodes" for nodes metrics table</span>
<span class="sd">            attribute "edges" for edge metrics table</span>
<span class="sd">            attribute "clusters" for cluster metrics table</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">threshold_match_probability</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">threshold_match_probability</span> <span class="o">=</span> <span class="n">df_clustered</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">"threshold_match_probability"</span><span class="p">,</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="c1"># we may not have metadata if clusters have been manually registered, or</span>
        <span class="c1"># read in from a format that does not include it</span>
        <span class="k">if</span> <span class="n">threshold_match_probability</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">"As `df_clustered` has no threshold metadata associated to it, "</span>
                <span class="s2">"to compute graph metrics you must provide "</span>
                <span class="s2">"`threshold_match_probability` manually"</span>
            <span class="p">)</span>
    <span class="n">df_node_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_metrics_nodes</span><span class="p">(</span>
        <span class="n">df_predict</span><span class="p">,</span> <span class="n">df_clustered</span><span class="p">,</span> <span class="n">threshold_match_probability</span>
    <span class="p">)</span>
    <span class="n">df_edge_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_metrics_edges</span><span class="p">(</span>
        <span class="n">df_node_metrics</span><span class="p">,</span>
        <span class="n">df_predict</span><span class="p">,</span>
        <span class="n">df_clustered</span><span class="p">,</span>
        <span class="n">threshold_match_probability</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># don't need edges as information is baked into node metrics</span>
    <span class="n">df_cluster_metrics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_metrics_clusters</span><span class="p">(</span><span class="n">df_node_metrics</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">GraphMetricsResults</span><span class="p">(</span>
        <span class="n">nodes</span><span class="o">=</span><span class="n">df_node_metrics</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">df_edge_metrics</span><span class="p">,</span> <span class="n">clusters</span><span class="o">=</span><span class="n">df_cluster_metrics</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.compute_tf_table" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_tf_table</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.compute_tf_table" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute a term frequency table for a given column and persist to the database</p>
<p>This method is useful if you want to pre-compute term frequency tables e.g.
so that real time linkage executes faster, or so that you can estimate
various models without having to recompute term frequency tables each time</p>



<p><strong>Examples:</strong></p>
    <div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="splink.linker.Linker.compute_tf_table--__tabbed_1_1" name="splink.linker.Linker.compute_tf_table--__tabbed_1" type="radio"><input id="splink.linker.Linker.compute_tf_table--__tabbed_1_2" name="splink.linker.Linker.compute_tf_table--__tabbed_1" type="radio"><div class="tabbed-labels"><label for="splink.linker.Linker.compute_tf_table--__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 0C5.363 0 0 5.363 0 12s5.363 12 12 12 12-5.363 12-12S18.637 0 12 0zM9.502 7.03a4.974 4.974 0 0 1 4.97 4.97 4.974 4.974 0 0 1-4.97 4.97A4.974 4.974 0 0 1 4.532 12a4.974 4.974 0 0 1 4.97-4.97zm6.563 3.183h2.351c.98 0 1.787.782 1.787 1.762s-.807 1.789-1.787 1.789h-2.351v-3.551z"></path></svg></span> DuckDB</label><label for="splink.linker.Linker.compute_tf_table--__tabbed_1_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.593 3.593 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a551.9 551.9 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a4.874 4.874 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535c0 .023.002.045 0 .073-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098.349.117.697.231 1.045.347h.001c.02.012.045.02.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.783 2.783 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353.08 353.08 0 0 0-2.421-4.018 4.61 4.61 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.592.592 0 0 1 .189.211c.87 1.446 1.742 2.89 2.609 4.338.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217.367-.098.735-.193 1.103-.289a.399.399 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019c-.538-.18-1.077-.358-1.615-.539-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.398.398 0 0 1-.18.132c.035-.378.068-.757.104-1.136.149-1.572.297-3.144.451-4.716-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.595.595 0 0 1 .24-.134c1.797-.57 3.595-1.14 5.394-1.705.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441.241-1.363.483-2.726.726-4.088.068-.386.14-.771.21-1.157z"></path></svg></span> Spark</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Real time linkage
</p><div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="s2">"saved_settings.json"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">compute_tf_table</span><span class="p">(</span><span class="s2">"surname"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">compare_two_records</span><span class="p">(</span><span class="n">record_left</span><span class="p">,</span> <span class="n">record_right</span><span class="p">)</span>
</code></pre></div>
Pre-computed term frequency tables
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df_first_name_tf</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">compute_tf_table</span><span class="p">(</span><span class="s2">"first_name"</span><span class="p">)</span>
<span class="n">df_first_name_tf</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">"folder/first_name_tf"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="c1"># On subsequent data linking job, read this table rather than recompute</span>
<span class="n">df_first_name_tf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">"folder/first_name_tf"</span><span class="p">)</span>
<span class="n">df_first_name_tf</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"__splink__df_tf_first_name"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Real time linkage
</p><div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="s2">"saved_settings.json"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">compute_tf_table</span><span class="p">(</span><span class="s2">"surname"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">compare_two_records</span><span class="p">(</span><span class="n">record_left</span><span class="p">,</span> <span class="n">record_right</span><span class="p">)</span>
</code></pre></div>
Pre-computed term frequency tables
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df_first_name_tf</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">compute_tf_table</span><span class="p">(</span><span class="s2">"first_name"</span><span class="p">)</span>
<span class="n">df_first_name_tf</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">"folder/first_name_tf"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="c1"># On subsequent data linking job, read this table rather than recompute</span>
<span class="n">df_first_name_tf</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="s2">"folder/first_name_tf"</span><span class="p">)</span>
<span class="n">df_first_name_tf</span><span class="o">.</span><span class="n">createOrReplaceTempView</span><span class="p">(</span><span class="s2">"__splink__df_tf_first_name"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>column_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The column name in the input table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The resultant table as a splink data frame</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_tf_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Compute a term frequency table for a given column and persist to the database</span>

<span class="sd">    This method is useful if you want to pre-compute term frequency tables e.g.</span>
<span class="sd">    so that real time linkage executes faster, or so that you can estimate</span>
<span class="sd">    various models without having to recompute term frequency tables each time</span>

<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            Real time linkage</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.load_settings("saved_settings.json")</span>
<span class="sd">            linker.compute_tf_table("surname")</span>
<span class="sd">            linker.compare_two_records(record_left, record_right)</span>
<span class="sd">            ```</span>
<span class="sd">            Pre-computed term frequency tables</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            df_first_name_tf = linker.compute_tf_table("first_name")</span>
<span class="sd">            df_first_name_tf.write.parquet("folder/first_name_tf")</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            # On subsequent data linking job, read this table rather than recompute</span>
<span class="sd">            df_first_name_tf = pd.read_parquet("folder/first_name_tf")</span>
<span class="sd">            df_first_name_tf.createOrReplaceTempView("__splink__df_tf_first_name")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            Real time linkage</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = SparkLinker(df)</span>
<span class="sd">            linker.load_settings("saved_settings.json")</span>
<span class="sd">            linker.compute_tf_table("surname")</span>
<span class="sd">            linker.compare_two_records(record_left, record_right)</span>
<span class="sd">            ```</span>
<span class="sd">            Pre-computed term frequency tables</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = SparkLinker(df)</span>
<span class="sd">            df_first_name_tf = linker.compute_tf_table("first_name")</span>
<span class="sd">            df_first_name_tf.write.parquet("folder/first_name_tf")</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            # On subsequent data linking job, read this table rather than recompute</span>
<span class="sd">            df_first_name_tf = spark.read.parquet("folder/first_name_tf")</span>
<span class="sd">            df_first_name_tf.createOrReplaceTempView("__splink__df_tf_first_name")</span>
<span class="sd">            ```</span>

<span class="sd">    Args:</span>
<span class="sd">        column_name (str): The column name in the input table</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame: The resultant table as a splink data frame</span>
<span class="sd">    """</span>

    <span class="n">input_col</span> <span class="o">=</span> <span class="n">InputColumn</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">settings_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
    <span class="n">tf_tablename</span> <span class="o">=</span> <span class="n">colname_to_tf_tablename</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span>
    <span class="n">concat_tf_tables</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">tf_col</span><span class="o">.</span><span class="n">unquote</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>
        <span class="k">for</span> <span class="n">tf_col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_term_frequency_columns</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">tf_tablename</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
        <span class="n">tf_df</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_with_logging</span><span class="p">(</span><span class="n">tf_tablename</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s2">"__splink__df_concat_with_tf"</span> <span class="ow">in</span> <span class="n">cache</span> <span class="ow">and</span> <span class="n">column_name</span> <span class="ow">in</span> <span class="n">concat_tf_tables</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="c1"># If our df_concat_with_tf table already exists, use backwards inference to</span>
        <span class="c1"># find a given tf table</span>
        <span class="n">colname</span> <span class="o">=</span> <span class="n">InputColumn</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="n">term_frequencies_from_concat_with_tf</span><span class="p">(</span><span class="n">colname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">colname_to_tf_tablename</span><span class="p">(</span><span class="n">colname</span><span class="p">))</span>
        <span class="n">tf_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">([</span><span class="n">cache</span><span class="p">[</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="n">tf_tablename</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf_df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Clear the pipeline if we are materialising</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pipeline</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="n">df_concat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat</span><span class="p">()</span>
        <span class="n">input_dfs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">df_concat</span><span class="p">:</span>
            <span class="n">input_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_concat</span><span class="p">)</span>
        <span class="n">sql</span> <span class="o">=</span> <span class="n">term_frequencies_for_single_column_sql</span><span class="p">(</span><span class="n">input_col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">tf_tablename</span><span class="p">)</span>
        <span class="n">tf_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span><span class="n">input_dfs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="n">tf_tablename</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf_df</span>

    <span class="k">return</span> <span class="n">tf_df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.confusion_matrix_from_labels_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">confusion_matrix_from_labels_column</span><span class="p">(</span><span class="n">labels_column_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">match_weight_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span></code>

<a href="#splink.linker.Linker.confusion_matrix_from_labels_column" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate an accuracy chart from ground truth data, whereby the ground
truth is in a column in the input dataset called <code>labels_column_name</code></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_column_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Column name containing labels in the input table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_range</code></td>
          <td>
                <code>list(float)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>minimum and maximum thresholds
to include in chart output. Defaults to [-15,15].</p>
            </div>
          </td>
          <td>
                <code>[-15, 15]</code>
          </td>
        </tr>
    </tbody>
  </table>
      



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span>
<span class="normal">2997</span>
<span class="normal">2998</span>
<span class="normal">2999</span>
<span class="normal">3000</span>
<span class="normal">3001</span>
<span class="normal">3002</span>
<span class="normal">3003</span>
<span class="normal">3004</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">confusion_matrix_from_labels_column</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_column_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">match_weight_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate an accuracy chart from ground truth data, whereby the ground</span>
<span class="sd">    truth is in a column in the input dataset called `labels_column_name`</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_column_name (str): Column name containing labels in the input table</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the chart. Defaults to None.</span>
<span class="sd">        match_weight_range (list(float), optional): minimum and maximum thresholds</span>
<span class="sd">            to include in chart output. Defaults to [-15,15].</span>
<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.confusion_matrix_from_labels_column("ground_truth")</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">match_weight_range</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">[</span><span class="s2">"truth_threshold"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">confusion_matrix_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">match_weight_range</span><span class="o">=</span><span class="n">match_weight_range</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.confusion_matrix_from_labels_table" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">confusion_matrix_from_labels_table</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">match_weight_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span></code>

<a href="#splink.linker.Linker.confusion_matrix_from_labels_table" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate an interactive confusion matrix from labelled (ground truth) data.</p>
<p>The table of labels should be in the following format, and should be registered
as a table with your database:</p>
<table>
<thead>
<tr>
<th>source_dataset_l</th>
<th>unique_id_l</th>
<th>source_dataset_r</th>
<th>unique_id_r</th>
<th>clerical_match_score</th>
</tr>
</thead>
<tbody>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>2</td>
<td>0.99</td>
</tr>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>3</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>Note that <code>source_dataset</code> and <code>unique_id</code> should correspond to the values
specified in the settings dict, and the <code>input_table_aliases</code> passed to the
<code>linker</code> object.</p>
<p>For <code>dedupe_only</code> links, the <code>source_dataset</code> columns can be ommitted.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_splinkdataframe_or_table_name</code></td>
          <td>
                <code>str | <a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of table
containing labels in the database</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_range</code></td>
          <td>
                <code>list(float)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>minimum and maximum thresholds
to include in chart output. Defaults to [-15,15].</p>
            </div>
          </td>
          <td>
                <code>[-15, 15]</code>
          </td>
        </tr>
    </tbody>
  </table>
      



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span>
<span class="normal">2700</span>
<span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span>
<span class="normal">2740</span>
<span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">confusion_matrix_from_labels_table</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">match_weight_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate an interactive confusion matrix from labelled (ground truth) data.</span>

<span class="sd">    The table of labels should be in the following format, and should be registered</span>
<span class="sd">    as a table with your database:</span>

<span class="sd">    |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">    |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">    |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">    |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">    Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">    specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">    `linker` object.</span>

<span class="sd">    For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">            containing labels in the database</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the chart. Defaults to None.</span>
<span class="sd">        match_weight_range (list(float), optional): minimum and maximum thresholds</span>
<span class="sd">            to include in chart output. Defaults to [-15,15].</span>
<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">            linker.register_table(labels, "labels")</span>
<span class="sd">            linker.confusion_matrix_from_labels_table("labels")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">            labels.createDataFrame("labels")</span>
<span class="sd">            linker.confusion_matrix_from_labels_table("labels")</span>
<span class="sd">            ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
        <span class="n">labels_splinkdataframe_or_table_name</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
    <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_tablename</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">match_weight_range</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recs</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">r</span><span class="p">[</span><span class="s2">"truth_threshold"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">confusion_matrix_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">match_weight_range</span><span class="o">=</span><span class="n">match_weight_range</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.count_num_comparisons_from_blocking_rule" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">count_num_comparisons_from_blocking_rule</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.count_num_comparisons_from_blocking_rule" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Compute the number of pairwise record comparisons that would be generated by
a blocking rule</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blocking_rule</code></td>
          <td>
                <code>str | <span title="splink.blocking.BlockingRule">BlockingRule</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The blocking rule to analyse</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>link_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The link type.  This is needed only if the
linker has not yet been provided with a settings dictionary.  Defaults
to None.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>unique_id_column_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>This is needed only if the
linker has not yet been provided with a settings dictionary.  Defaults
to None.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">br</span> <span class="o">=</span> <span class="s2">"l.surname = r.surname"</span>
<span class="n">linker</span><span class="o">.</span><span class="n">count_num_comparisons_from_blocking_rule</span><span class="p">(</span><span class="n">br</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>19387</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">br</span> <span class="o">=</span> <span class="s2">"l.name = r.name and substr(l.dob,1,4) = substr(r.dob,1,4)"</span>
<span class="n">linker</span><span class="o">.</span><span class="n">count_num_comparisons_from_blocking_rule</span><span class="p">(</span><span class="n">br</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>394
Alternatively, you can use the blocking rule library functions
</p><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">splink.duckdb.blocking_rule_library</span> <span class="k">as</span> <span class="nn">brl</span>
<span class="n">br</span> <span class="o">=</span> <span class="n">brl</span><span class="o">.</span><span class="n">exact_match_rule</span><span class="p">(</span><span class="s2">"surname"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">count_num_comparisons_from_blocking_rule</span><span class="p">(</span><span class="n">br</span><span class="p">)</span>
</code></pre></div>
3167
</blockquote>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>int</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of comparisons generated by the blocking rule</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3283</span>
<span class="normal">3284</span>
<span class="normal">3285</span>
<span class="normal">3286</span>
<span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span>
<span class="normal">3295</span>
<span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span>
<span class="normal">3304</span>
<span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">count_num_comparisons_from_blocking_rule</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">blocking_rule</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">BlockingRule</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Compute the number of pairwise record comparisons that would be generated by</span>
<span class="sd">    a blocking rule</span>

<span class="sd">    Args:</span>
<span class="sd">        blocking_rule (str | BlockingRule): The blocking rule to analyse</span>
<span class="sd">        link_type (str, optional): The link type.  This is needed only if the</span>
<span class="sd">            linker has not yet been provided with a settings dictionary.  Defaults</span>
<span class="sd">            to None.</span>
<span class="sd">        unique_id_column_name (str, optional):  This is needed only if the</span>
<span class="sd">            linker has not yet been provided with a settings dictionary.  Defaults</span>
<span class="sd">            to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        br = "l.surname = r.surname"</span>
<span class="sd">        linker.count_num_comparisons_from_blocking_rule(br)</span>
<span class="sd">        ```</span>
<span class="sd">        &gt; 19387</span>

<span class="sd">        ```py</span>
<span class="sd">        br = "l.name = r.name and substr(l.dob,1,4) = substr(r.dob,1,4)"</span>
<span class="sd">        linker.count_num_comparisons_from_blocking_rule(br)</span>
<span class="sd">        ```</span>
<span class="sd">        &gt; 394</span>
<span class="sd">        Alternatively, you can use the blocking rule library functions</span>
<span class="sd">        ```py</span>
<span class="sd">        import splink.duckdb.blocking_rule_library as brl</span>
<span class="sd">        br = brl.exact_match_rule("surname")</span>
<span class="sd">        linker.count_num_comparisons_from_blocking_rule(br)</span>
<span class="sd">        ```</span>
<span class="sd">        &gt; 3167</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: The number of comparisons generated by the blocking rule</span>
<span class="sd">    """</span>

    <span class="n">blocking_rule</span> <span class="o">=</span> <span class="n">blocking_rule_to_obj</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span><span class="o">.</span><span class="n">blocking_rule_sql</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="n">vertically_concatenate_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_concat"</span><span class="p">)</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="n">number_of_comparisons_generated_by_blocking_rule_post_filters_sql</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">blocking_rule</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__analyse_blocking_rule"</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">()</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="s2">"count_of_pairwise_comparisons_generated"</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.count_num_comparisons_from_blocking_rules_for_prediction" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">count_num_comparisons_from_blocking_rules_for_prediction</span><span class="p">(</span><span class="n">df_predict</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.count_num_comparisons_from_blocking_rules_for_prediction" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Counts the marginal number of edges created from each of the blocking rules
in <code>blocking_rules_to_generate_predictions</code></p>
<p>This is different to <code>count_num_comparisons_from_blocking_rule</code>
because it (a) analyses multiple blocking rules rather than a single rule, and
(b) deduplicates any comparisons that are generated, to tell you the
marginal effect of each entry in <code>blocking_rules_to_generate_predictions</code></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df_predict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>SplinkDataFrame with match weights</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">"settings.json"</span><span class="p">)</span>
<span class="n">df_predict</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">threshold_match_probability</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">count_pairwise</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">count_num_comparisons_from_blocking_rules_for_prediction</span><span class="p">(</span><span class="n">df_predict</span><span class="p">)</span>
<span class="n">count_pairwise</span><span class="o">.</span><span class="n">as_pandas_dataframe</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A SplinkDataFrame of the pairwise comparisons and
estimated pairwise comparisons generated by the blocking rules.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3465</span>
<span class="normal">3466</span>
<span class="normal">3467</span>
<span class="normal">3468</span>
<span class="normal">3469</span>
<span class="normal">3470</span>
<span class="normal">3471</span>
<span class="normal">3472</span>
<span class="normal">3473</span>
<span class="normal">3474</span>
<span class="normal">3475</span>
<span class="normal">3476</span>
<span class="normal">3477</span>
<span class="normal">3478</span>
<span class="normal">3479</span>
<span class="normal">3480</span>
<span class="normal">3481</span>
<span class="normal">3482</span>
<span class="normal">3483</span>
<span class="normal">3484</span>
<span class="normal">3485</span>
<span class="normal">3486</span>
<span class="normal">3487</span>
<span class="normal">3488</span>
<span class="normal">3489</span>
<span class="normal">3490</span>
<span class="normal">3491</span>
<span class="normal">3492</span>
<span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span>
<span class="normal">3497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">count_num_comparisons_from_blocking_rules_for_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Counts the marginal number of edges created from each of the blocking rules</span>
<span class="sd">    in `blocking_rules_to_generate_predictions`</span>

<span class="sd">    This is different to `count_num_comparisons_from_blocking_rule`</span>
<span class="sd">    because it (a) analyses multiple blocking rules rather than a single rule, and</span>
<span class="sd">    (b) deduplicates any comparisons that are generated, to tell you the</span>
<span class="sd">    marginal effect of each entry in `blocking_rules_to_generate_predictions`</span>

<span class="sd">    Args:</span>
<span class="sd">        df_predict (SplinkDataFrame): SplinkDataFrame with match weights</span>
<span class="sd">        and probabilities of rows matching</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker = DuckDBLinker(df)</span>
<span class="sd">        linker.load_model("settings.json")</span>
<span class="sd">        df_predict = linker.predict(threshold_match_probability=0.95)</span>
<span class="sd">        count_pairwise = linker.count_num_comparisons_from_blocking_rules_for_prediction(df_predict)</span>
<span class="sd">        count_pairwise.as_pandas_dataframe(limit=5)</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame: A SplinkDataFrame of the pairwise comparisons and</span>
<span class="sd">            estimated pairwise comparisons generated by the blocking rules.</span>
<span class="sd">    """</span>  <span class="c1"># noqa: E501</span>
    <span class="n">sql</span> <span class="o">=</span> <span class="n">count_num_comparisons_from_blocking_rules_for_prediction_sql</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">df_predict</span>
    <span class="p">)</span>
    <span class="n">match_key_analysis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_to_splink_dataframe_checking_cache</span><span class="p">(</span>
        <span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__match_key_analysis"</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">match_key_analysis</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.cumulative_comparisons_from_blocking_rules_records" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cumulative_comparisons_from_blocking_rules_records</span><span class="p">(</span><span class="n">blocking_rules</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.cumulative_comparisons_from_blocking_rules_records" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Output the number of comparisons generated by each successive blocking rule.</p>
<p>This is equivalent to the output size of df_predict and details how many
comparisons each of your individual blocking rules will contribute to the
total.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blocking_rules</code></td>
          <td>
                <code>str or list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The blocking rule(s) to compute comparisons
for. If null, the rules set out in your settings object will be used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p>Generate total comparisons from Blocking Rules defined in settings
dictionary
</p><div class="highlight"><pre><span></span><code><span class="n">linker_settings</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="c1"># Compute the cumulative number of comparisons generated by the rules</span>
<span class="c1"># in your settings object.</span>
<span class="n">linker_settings</span><span class="o">.</span><span class="n">cumulative_comparisons_from_blocking_rules_records</span><span class="p">()</span>
</code></pre></div>
<p>Generate total comparisons with custom blocking rules.
</p><div class="highlight"><pre><span></span><code><span class="n">blocking_rules</span> <span class="o">=</span> <span class="p">[</span>
   <span class="s2">"l.surname = r.surname"</span><span class="p">,</span>
   <span class="s2">"l.first_name = r.first_name</span>
    <span class="ow">and</span> <span class="n">substr</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">dob</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">dob</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="s2">"</span>
<span class="p">]</span>

<span class="n">linker_settings</span><span class="o">.</span><span class="n">cumulative_comparisons_from_blocking_rules_records</span><span class="p">(</span>
    <span class="n">blocking_rules</span>
 <span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>List</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of blocking rules and the corresponding number of
comparisons it is forecast to generate.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3368</span>
<span class="normal">3369</span>
<span class="normal">3370</span>
<span class="normal">3371</span>
<span class="normal">3372</span>
<span class="normal">3373</span>
<span class="normal">3374</span>
<span class="normal">3375</span>
<span class="normal">3376</span>
<span class="normal">3377</span>
<span class="normal">3378</span>
<span class="normal">3379</span>
<span class="normal">3380</span>
<span class="normal">3381</span>
<span class="normal">3382</span>
<span class="normal">3383</span>
<span class="normal">3384</span>
<span class="normal">3385</span>
<span class="normal">3386</span>
<span class="normal">3387</span>
<span class="normal">3388</span>
<span class="normal">3389</span>
<span class="normal">3390</span>
<span class="normal">3391</span>
<span class="normal">3392</span>
<span class="normal">3393</span>
<span class="normal">3394</span>
<span class="normal">3395</span>
<span class="normal">3396</span>
<span class="normal">3397</span>
<span class="normal">3398</span>
<span class="normal">3399</span>
<span class="normal">3400</span>
<span class="normal">3401</span>
<span class="normal">3402</span>
<span class="normal">3403</span>
<span class="normal">3404</span>
<span class="normal">3405</span>
<span class="normal">3406</span>
<span class="normal">3407</span>
<span class="normal">3408</span>
<span class="normal">3409</span>
<span class="normal">3410</span>
<span class="normal">3411</span>
<span class="normal">3412</span>
<span class="normal">3413</span>
<span class="normal">3414</span>
<span class="normal">3415</span>
<span class="normal">3416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cumulative_comparisons_from_blocking_rules_records</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">blocking_rules</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">BlockingRule</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Output the number of comparisons generated by each successive blocking rule.</span>

<span class="sd">    This is equivalent to the output size of df_predict and details how many</span>
<span class="sd">    comparisons each of your individual blocking rules will contribute to the</span>
<span class="sd">    total.</span>

<span class="sd">    Args:</span>
<span class="sd">        blocking_rules (str or list): The blocking rule(s) to compute comparisons</span>
<span class="sd">            for. If null, the rules set out in your settings object will be used.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Generate total comparisons from Blocking Rules defined in settings</span>
<span class="sd">        dictionary</span>
<span class="sd">        ```py</span>
<span class="sd">        linker_settings = DuckDBLinker(df, settings)</span>
<span class="sd">        # Compute the cumulative number of comparisons generated by the rules</span>
<span class="sd">        # in your settings object.</span>
<span class="sd">        linker_settings.cumulative_comparisons_from_blocking_rules_records()</span>
<span class="sd">        ```</span>

<span class="sd">        Generate total comparisons with custom blocking rules.</span>
<span class="sd">        ```py</span>
<span class="sd">        blocking_rules = [</span>
<span class="sd">           "l.surname = r.surname",</span>
<span class="sd">           "l.first_name = r.first_name</span>
<span class="sd">            and substr(l.dob,1,4) = substr(r.dob,1,4)"</span>
<span class="sd">        ]</span>

<span class="sd">        linker_settings.cumulative_comparisons_from_blocking_rules_records(</span>
<span class="sd">            blocking_rules</span>
<span class="sd">         )</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        List: A list of blocking rules and the corresponding number of</span>
<span class="sd">            comparisons it is forecast to generate.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">blocking_rules</span><span class="p">:</span>
        <span class="n">blocking_rules</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">)</span>

    <span class="n">records</span> <span class="o">=</span> <span class="n">cumulative_comparisons_generated_by_blocking_rules</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">blocking_rules</span><span class="p">,</span> <span class="n">output_chart</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">records</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.cumulative_num_comparisons_from_blocking_rules_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cumulative_num_comparisons_from_blocking_rules_chart</span><span class="p">(</span><span class="n">blocking_rules</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.cumulative_num_comparisons_from_blocking_rules_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Display a chart with the cumulative number of comparisons generated by a
selection of blocking rules.</p>
<p>This is equivalent to the output size of df_predict and details how many
comparisons each of your individual blocking rules will contribute to the
total.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blocking_rules</code></td>
          <td>
                <code>str or list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The blocking rule(s) to compute comparisons
for. If null, the rules set out in your settings object will be used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker_settings</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="c1"># Compute the cumulative number of comparisons generated by the rules</span>
<span class="c1"># in your settings object.</span>
<span class="n">linker_settings</span><span class="o">.</span><span class="n">cumulative_num_comparisons_from_blocking_rules_chart</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="c1"># Generate total comparisons with custom blocking rules.</span>
<span class="n">blocking_rules</span> <span class="o">=</span> <span class="p">[</span>
   <span class="s2">"l.surname = r.surname"</span><span class="p">,</span>
   <span class="s2">"l.first_name = r.first_name</span>
    <span class="ow">and</span> <span class="n">substr</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">dob</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">substr</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">dob</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="s2">"</span>
<span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="n">linker_settings</span><span class="o">.</span><span class="n">cumulative_num_comparisons_from_blocking_rules_chart</span><span class="p">(</span>
    <span class="n">blocking_rules</span>
 <span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3418</span>
<span class="normal">3419</span>
<span class="normal">3420</span>
<span class="normal">3421</span>
<span class="normal">3422</span>
<span class="normal">3423</span>
<span class="normal">3424</span>
<span class="normal">3425</span>
<span class="normal">3426</span>
<span class="normal">3427</span>
<span class="normal">3428</span>
<span class="normal">3429</span>
<span class="normal">3430</span>
<span class="normal">3431</span>
<span class="normal">3432</span>
<span class="normal">3433</span>
<span class="normal">3434</span>
<span class="normal">3435</span>
<span class="normal">3436</span>
<span class="normal">3437</span>
<span class="normal">3438</span>
<span class="normal">3439</span>
<span class="normal">3440</span>
<span class="normal">3441</span>
<span class="normal">3442</span>
<span class="normal">3443</span>
<span class="normal">3444</span>
<span class="normal">3445</span>
<span class="normal">3446</span>
<span class="normal">3447</span>
<span class="normal">3448</span>
<span class="normal">3449</span>
<span class="normal">3450</span>
<span class="normal">3451</span>
<span class="normal">3452</span>
<span class="normal">3453</span>
<span class="normal">3454</span>
<span class="normal">3455</span>
<span class="normal">3456</span>
<span class="normal">3457</span>
<span class="normal">3458</span>
<span class="normal">3459</span>
<span class="normal">3460</span>
<span class="normal">3461</span>
<span class="normal">3462</span>
<span class="normal">3463</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cumulative_num_comparisons_from_blocking_rules_chart</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">blocking_rules</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">BlockingRule</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Display a chart with the cumulative number of comparisons generated by a</span>
<span class="sd">    selection of blocking rules.</span>

<span class="sd">    This is equivalent to the output size of df_predict and details how many</span>
<span class="sd">    comparisons each of your individual blocking rules will contribute to the</span>
<span class="sd">    total.</span>

<span class="sd">    Args:</span>
<span class="sd">        blocking_rules (str or list): The blocking rule(s) to compute comparisons</span>
<span class="sd">            for. If null, the rules set out in your settings object will be used.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker_settings = DuckDBLinker(df, settings)</span>
<span class="sd">        # Compute the cumulative number of comparisons generated by the rules</span>
<span class="sd">        # in your settings object.</span>
<span class="sd">        linker_settings.cumulative_num_comparisons_from_blocking_rules_chart()</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        # Generate total comparisons with custom blocking rules.</span>
<span class="sd">        blocking_rules = [</span>
<span class="sd">           "l.surname = r.surname",</span>
<span class="sd">           "l.first_name = r.first_name</span>
<span class="sd">            and substr(l.dob,1,4) = substr(r.dob,1,4)"</span>
<span class="sd">        ]</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        linker_settings.cumulative_num_comparisons_from_blocking_rules_chart(</span>
<span class="sd">            blocking_rules</span>
<span class="sd">         )</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="n">blocking_rules</span><span class="p">:</span>
        <span class="n">blocking_rules</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">)</span>

    <span class="n">records</span> <span class="o">=</span> <span class="n">cumulative_comparisons_generated_by_blocking_rules</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">blocking_rules</span><span class="p">,</span> <span class="n">output_chart</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">cumulative_blocking_rule_comparisons_generated</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.deterministic_link" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">deterministic_link</span><span class="p">()</span></code>

<a href="#splink.linker.Linker.deterministic_link" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Uses the blocking rules specified by
<code>blocking_rules_to_generate_predictions</code> in the settings dictionary to
generate pairwise record comparisons.</p>
<p>For deterministic linkage, this should be a list of blocking rules which
are strict enough to generate only true links.</p>
<p>Deterministic linkage, however, is likely to result in missed links
(false negatives).</p>



<p><strong>Examples:</strong></p>
    <div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked id="splink.linker.Linker.deterministic_link--__tabbed_1_1" name="splink.linker.Linker.deterministic_link--__tabbed_1" type="radio"><input id="splink.linker.Linker.deterministic_link--__tabbed_1_2" name="splink.linker.Linker.deterministic_link--__tabbed_1" type="radio"><input id="splink.linker.Linker.deterministic_link--__tabbed_1_3" name="splink.linker.Linker.deterministic_link--__tabbed_1" type="radio"><input id="splink.linker.Linker.deterministic_link--__tabbed_1_4" name="splink.linker.Linker.deterministic_link--__tabbed_1" type="radio"><div class="tabbed-labels"><label for="splink.linker.Linker.deterministic_link--__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 0C5.363 0 0 5.363 0 12s5.363 12 12 12 12-5.363 12-12S18.637 0 12 0zM9.502 7.03a4.974 4.974 0 0 1 4.97 4.97 4.974 4.974 0 0 1-4.97 4.97A4.974 4.974 0 0 1 4.532 12a4.974 4.974 0 0 1 4.97-4.97zm6.563 3.183h2.351c.98 0 1.787.782 1.787 1.762s-.807 1.789-1.787 1.789h-2.351v-3.551z"></path></svg></span> DuckDB</label><label for="splink.linker.Linker.deterministic_link--__tabbed_1_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.593 3.593 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a551.9 551.9 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a4.874 4.874 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535c0 .023.002.045 0 .073-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098.349.117.697.231 1.045.347h.001c.02.012.045.02.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.783 2.783 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353.08 353.08 0 0 0-2.421-4.018 4.61 4.61 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.592.592 0 0 1 .189.211c.87 1.446 1.742 2.89 2.609 4.338.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217.367-.098.735-.193 1.103-.289a.399.399 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019c-.538-.18-1.077-.358-1.615-.539-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.398.398 0 0 1-.18.132c.035-.378.068-.757.104-1.136.149-1.572.297-3.144.451-4.716-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.595.595 0 0 1 .24-.134c1.797-.57 3.595-1.14 5.394-1.705.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441.241-1.363.483-2.726.726-4.088.068-.386.14-.771.21-1.157z"></path></svg></span> Spark</label><label for="splink.linker.Linker.deterministic_link--__tabbed_1_3"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 0 1-.28.104.488.488 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167 4.577 4.577 0 0 1 1.005-.36 4.84 4.84 0 0 1 1.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144a1.78 1.78 0 0 0 .758-.51 1.27 1.27 0 0 0 .272-.512c.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.416-.287-.807-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926a2.157 2.157 0 0 1-.583.703c-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zm1.509 3.88c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zm1.094-1.246c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z"></path></svg></span> Athena</label><label for="splink.linker.Linker.deterministic_link--__tabbed_1_4"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M21.678.521c-1.032-.92-2.28-.55-3.513.544a8.71 8.71 0 0 0-.547.535c-2.109 2.237-4.066 6.38-4.674 9.544.237.48.422 1.093.544 1.561a13.044 13.044 0 0 1 .164.703s-.019-.071-.096-.296l-.05-.146a1.689 1.689 0 0 0-.033-.08c-.138-.32-.518-.995-.686-1.289-.143.423-.27.818-.376 1.176.484.884.778 2.4.778 2.4s-.025-.099-.147-.442c-.107-.303-.644-1.244-.772-1.464-.217.804-.304 1.346-.226 1.478.152.256.296.698.422 1.186.286 1.1.485 2.44.485 2.44l.017.224a22.41 22.41 0 0 0 .056 2.748c.095 1.146.273 2.13.5 2.657l.155-.084c-.334-1.038-.47-2.399-.41-3.967.09-2.398.642-5.29 1.661-8.304 1.723-4.55 4.113-8.201 6.3-9.945-1.993 1.8-4.692 7.63-5.5 9.788-.904 2.416-1.545 4.684-1.931 6.857.666-2.037 2.821-2.912 2.821-2.912s1.057-1.304 2.292-3.166c-.74.169-1.955.458-2.362.629-.6.251-.762.337-.762.337s1.945-1.184 3.613-1.72C21.695 7.9 24.195 2.767 21.678.521m-18.573.543A1.842 1.842 0 0 0 1.27 2.9v16.608a1.84 1.84 0 0 0 1.835 1.834h9.418a22.953 22.953 0 0 1-.052-2.707c-.006-.062-.011-.141-.016-.2a27.01 27.01 0 0 0-.473-2.378c-.121-.47-.275-.898-.369-1.057-.116-.197-.098-.31-.097-.432 0-.12.015-.245.037-.386a9.98 9.98 0 0 1 .234-1.045l.217-.028c-.017-.035-.014-.065-.031-.097l-.041-.381a32.8 32.8 0 0 1 .382-1.194l.2-.019c-.008-.016-.01-.038-.018-.053l-.043-.316c.63-3.28 2.587-7.443 4.8-9.791.066-.069.133-.128.198-.194Z"></path></svg></span> SQLite</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.duckdb.linker</span> <span class="kn">import</span> <span class="n">DuckDBLinker</span>

<span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"link_type"</span><span class="p">:</span> <span class="s2">"dedupe_only"</span><span class="p">,</span>
    <span class="s2">"blocking_rules_to_generate_predictions"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"l.first_name = r.first_name"</span><span class="p">,</span>
        <span class="s2">"l.surname = r.surname"</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">"comparisons"</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">deterministic_link</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.spark.linker</span> <span class="kn">import</span> <span class="n">SparkLinker</span>

<span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"link_type"</span><span class="p">:</span> <span class="s2">"dedupe_only"</span><span class="p">,</span>
    <span class="s2">"blocking_rules_to_generate_predictions"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"l.first_name = r.first_name"</span><span class="p">,</span>
        <span class="s2">"l.surname = r.surname"</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">"comparisons"</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">deterministic_link</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.athena.linker</span> <span class="kn">import</span> <span class="n">AthenaLinker</span>

<span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"link_type"</span><span class="p">:</span> <span class="s2">"dedupe_only"</span><span class="p">,</span>
    <span class="s2">"blocking_rules_to_generate_predictions"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"l.first_name = r.first_name"</span><span class="p">,</span>
        <span class="s2">"l.surname = r.surname"</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">"comparisons"</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">AthenaLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">deterministic_link</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.sqlite.linker</span> <span class="kn">import</span> <span class="n">SQLiteLinker</span>

<span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">"link_type"</span><span class="p">:</span> <span class="s2">"dedupe_only"</span><span class="p">,</span>
    <span class="s2">"blocking_rules_to_generate_predictions"</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">"l.first_name = r.first_name"</span><span class="p">,</span>
        <span class="s2">"l.surname = r.surname"</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s2">"comparisons"</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">SQLiteLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">deterministic_link</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A SplinkDataFrame of the pairwise comparisons.  This
represents a table materialised in the database. Methods on the
SplinkDataFrame allow you to access the underlying data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">deterministic_link</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Uses the blocking rules specified by</span>
<span class="sd">    `blocking_rules_to_generate_predictions` in the settings dictionary to</span>
<span class="sd">    generate pairwise record comparisons.</span>

<span class="sd">    For deterministic linkage, this should be a list of blocking rules which</span>
<span class="sd">    are strict enough to generate only true links.</span>

<span class="sd">    Deterministic linkage, however, is likely to result in missed links</span>
<span class="sd">    (false negatives).</span>

<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.duckdb.linker import DuckDBLinker</span>

<span class="sd">            settings = {</span>
<span class="sd">                "link_type": "dedupe_only",</span>
<span class="sd">                "blocking_rules_to_generate_predictions": [</span>
<span class="sd">                    "l.first_name = r.first_name",</span>
<span class="sd">                    "l.surname = r.surname",</span>
<span class="sd">                ],</span>
<span class="sd">                "comparisons": []</span>
<span class="sd">            }</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            linker = DuckDBLinker(df, settings)</span>
<span class="sd">            df = linker.deterministic_link()</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.spark.linker import SparkLinker</span>

<span class="sd">            settings = {</span>
<span class="sd">                "link_type": "dedupe_only",</span>
<span class="sd">                "blocking_rules_to_generate_predictions": [</span>
<span class="sd">                    "l.first_name = r.first_name",</span>
<span class="sd">                    "l.surname = r.surname",</span>
<span class="sd">                ],</span>
<span class="sd">                "comparisons": []</span>
<span class="sd">            }</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            linker = SparkLinker(df, settings)</span>
<span class="sd">            df = linker.deterministic_link()</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-amazonaws: Athena"</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.athena.linker import AthenaLinker</span>

<span class="sd">            settings = {</span>
<span class="sd">                "link_type": "dedupe_only",</span>
<span class="sd">                "blocking_rules_to_generate_predictions": [</span>
<span class="sd">                    "l.first_name = r.first_name",</span>
<span class="sd">                    "l.surname = r.surname",</span>
<span class="sd">                ],</span>
<span class="sd">                "comparisons": []</span>
<span class="sd">            }</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            linker = AthenaLinker(df, settings)</span>
<span class="sd">            df = linker.deterministic_link()</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-sqlite: SQLite"</span>
<span class="sd">            ```py</span>
<span class="sd">            from splink.sqlite.linker import SQLiteLinker</span>

<span class="sd">            settings = {</span>
<span class="sd">                "link_type": "dedupe_only",</span>
<span class="sd">                "blocking_rules_to_generate_predictions": [</span>
<span class="sd">                    "l.first_name = r.first_name",</span>
<span class="sd">                    "l.surname = r.surname",</span>
<span class="sd">                ],</span>
<span class="sd">                "comparisons": []</span>
<span class="sd">            }</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            linker = SQLiteLinker(df, settings)</span>
<span class="sd">            df = linker.deterministic_link()</span>
<span class="sd">            ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame: A SplinkDataFrame of the pairwise comparisons.  This</span>
<span class="sd">            represents a table materialised in the database. Methods on the</span>
<span class="sd">            SplinkDataFrame allow you to access the underlying data.</span>
<span class="sd">    """</span>

    <span class="c1"># Allows clustering during a deterministic linkage.</span>
    <span class="c1"># This is used in `cluster_pairwise_predictions_at_threshold`</span>
    <span class="c1"># to set the cluster threshold to 1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_deterministic_link_mode</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">concat_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">()</span>
    <span class="n">exploding_br_with_id_tables</span> <span class="o">=</span> <span class="n">materialise_exploded_id_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

    <span class="n">deterministic_link_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">([</span><span class="n">concat_with_tf</span><span class="p">])</span>
    <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">drop_materialised_id_pairs_dataframe</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">exploding_br_with_id_tables</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">deterministic_link_df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.estimate_m_from_label_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">estimate_m_from_label_column</span><span class="p">(</span><span class="n">label_colname</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.estimate_m_from_label_column" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Estimate the m parameters of the linkage model from a label (ground truth)
column in the input dataframe(s).</p>
<p>The m parameters represent the proportion of record comparisons that fall
into each comparison level amongst truly matching records.</p>
<p>The ground truth column is used to generate pairwise record comparisons
which are then assumed to be matches.</p>
<p>For example, if the entity being matched is persons, and your input dataset(s)
contain social security number, this could be used to estimate the m values
for the model.</p>
<p>Note that this column does not need to be fully populated.  A common case is
where a unique identifier such as social security number is only partially
populated.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>label_colname</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of the column containing the ground truth
label in the input data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">estimate_m_from_label_column</span><span class="p">(</span><span class="s2">"social_security_number"</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Updates the estimated m parameters within the linker object</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>and returns nothing.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">estimate_m_from_label_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_colname</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Estimate the m parameters of the linkage model from a label (ground truth)</span>
<span class="sd">    column in the input dataframe(s).</span>

<span class="sd">    The m parameters represent the proportion of record comparisons that fall</span>
<span class="sd">    into each comparison level amongst truly matching records.</span>

<span class="sd">    The ground truth column is used to generate pairwise record comparisons</span>
<span class="sd">    which are then assumed to be matches.</span>

<span class="sd">    For example, if the entity being matched is persons, and your input dataset(s)</span>
<span class="sd">    contain social security number, this could be used to estimate the m values</span>
<span class="sd">    for the model.</span>

<span class="sd">    Note that this column does not need to be fully populated.  A common case is</span>
<span class="sd">    where a unique identifier such as social security number is only partially</span>
<span class="sd">    populated.</span>

<span class="sd">    Args:</span>
<span class="sd">        label_colname (str): The name of the column containing the ground truth</span>
<span class="sd">            label in the input data.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.estimate_m_from_label_column("social_security_number")</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        Updates the estimated m parameters within the linker object</span>
<span class="sd">        and returns nothing.</span>
<span class="sd">    """</span>

    <span class="c1"># Ensure this has been run on the main linker so that it can be used by</span>
    <span class="c1"># training linked when it checks the cache</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">()</span>
    <span class="n">estimate_m_values_from_label_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_tables_dict</span><span class="p">,</span>
        <span class="n">label_colname</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_populate_m_u_from_trained_values</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_columns_without_estimated_parameters_message</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.estimate_m_from_pairwise_labels" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">estimate_m_from_pairwise_labels</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.estimate_m_from_pairwise_labels" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Estimate the m parameters of the linkage model from a dataframe of pairwise
labels.</p>
<p>The table of labels should be in the following format, and should
be registered with your database:
|source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|
|----------------|-----------|----------------|-----------|
|df_1            |1          |df_2            |2          |
|df_1            |1          |df_2            |3          |</p>
<p>Note that <code>source_dataset</code> and <code>unique_id</code> should correspond to the
values specified in the settings dict, and the <code>input_table_aliases</code>
passed to the <code>linker</code> object. Note that at the moment, this method does
not respect values in a <code>clerical_match_score</code> column.  If provided, these
are ignored and it is assumed that every row in the table of labels is a score
of 1, i.e. a perfect match.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_splinkdataframe_or_table_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of table containing labels
in the database or SplinkDataframe</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">pairwise_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"./data/pairwise_labels_to_estimate_m.csv"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span><span class="n">pairwise_labels</span><span class="p">,</span> <span class="s2">"labels"</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">estimate_m_from_pairwise_labels</span><span class="p">(</span><span class="s2">"labels"</span><span class="p">)</span>
</code></pre></div>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">estimate_m_from_pairwise_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Estimate the m parameters of the linkage model from a dataframe of pairwise</span>
<span class="sd">    labels.</span>

<span class="sd">    The table of labels should be in the following format, and should</span>
<span class="sd">    be registered with your database:</span>
<span class="sd">    |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|</span>
<span class="sd">    |----------------|-----------|----------------|-----------|</span>
<span class="sd">    |df_1            |1          |df_2            |2          |</span>
<span class="sd">    |df_1            |1          |df_2            |3          |</span>

<span class="sd">    Note that `source_dataset` and `unique_id` should correspond to the</span>
<span class="sd">    values specified in the settings dict, and the `input_table_aliases`</span>
<span class="sd">    passed to the `linker` object. Note that at the moment, this method does</span>
<span class="sd">    not respect values in a `clerical_match_score` column.  If provided, these</span>
<span class="sd">    are ignored and it is assumed that every row in the table of labels is a score</span>
<span class="sd">    of 1, i.e. a perfect match.</span>

<span class="sd">    Args:</span>
<span class="sd">      labels_splinkdataframe_or_table_name (str): Name of table containing labels</span>
<span class="sd">        in the database or SplinkDataframe</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        pairwise_labels = pd.read_csv("./data/pairwise_labels_to_estimate_m.csv")</span>
<span class="sd">        linker.register_table(pairwise_labels, "labels", overwrite=True)</span>
<span class="sd">        linker.estimate_m_from_pairwise_labels("labels")</span>
<span class="sd">        ```</span>
<span class="sd">    """</span>
    <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
        <span class="n">labels_splinkdataframe_or_table_name</span>
    <span class="p">)</span>
    <span class="n">estimate_m_from_pairwise_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels_tablename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.estimate_parameters_using_expectation_maximisation" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">estimate_parameters_using_expectation_maximisation</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">,</span> <span class="n">comparisons_to_deactivate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comparison_levels_to_reverse_blocking_rule</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">estimate_without_term_frequencies</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fix_probability_two_random_records_match</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fix_m_probabilities</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fix_u_probabilities</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">populate_probability_two_random_records_match_from_trained_values</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.estimate_parameters_using_expectation_maximisation" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Estimate the parameters of the linkage model using expectation maximisation.</p>
<p>By default, the m probabilities are estimated, but not the u probabilities,
because good estimates for the u probabilities can be obtained from
<code>linker.estimate_u_using_random_sampling()</code>.  You can change this by setting
<code>fix_u_probabilities</code> to False.</p>
<p>The blocking rule provided is used to generate pairwise record comparisons.
Usually, this should be a blocking rule that results in a dataframe where
matches are between about 1% and 99% of the comparisons.</p>
<p>By default, m parameters are estimated for all comparisons except those which
are included in the blocking rule.</p>
<p>For example, if the blocking rule is <code>l.first_name = r.first_name</code>, then
parameter esimates will be made for all comparison except those which use
<code>first_name</code> in their sql_condition</p>
<p>By default, the probability two random records match is estimated for the
blocked data, and then the m and u parameters for the columns specified in the
blocking rules are used to estiamte the global probability two random records
match.</p>
<p>To control which comparisons should have their parameter estimated, and the
process of 'reversing out' the global probability two random records match, the
user may specify <code>comparisons_to_deactivate</code> and
<code>comparison_levels_to_reverse_blocking_rule</code>.   This is useful, for example
if you block on the dmetaphone of a column but match on the original column.</p>



<p><strong>Examples:</strong></p>
    <p>Default behaviour
</p><div class="highlight"><pre><span></span><code><span class="n">br_training</span> <span class="o">=</span> <span class="s2">"l.first_name = r.first_name and l.dob = r.dob"</span>
<span class="n">linker</span><span class="o">.</span><span class="n">estimate_parameters_using_expectation_maximisation</span><span class="p">(</span><span class="n">br_training</span><span class="p">)</span>
</code></pre></div>
Specify which comparisons to deactivate
<div class="highlight"><pre><span></span><code><span class="n">br_training</span> <span class="o">=</span> <span class="s2">"l.dmeta_first_name = r.dmeta_first_name"</span>
<span class="n">settings_obj</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">_settings_obj</span>
<span class="n">comp</span> <span class="o">=</span> <span class="n">settings_obj</span><span class="o">.</span><span class="n">_get_comparison_by_output_column_name</span><span class="p">(</span><span class="s2">"first_name"</span><span class="p">)</span>
<span class="n">dmeta_level</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">_get_comparison_level_by_comparison_vector_value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">estimate_parameters_using_expectation_maximisation</span><span class="p">(</span>
    <span class="n">br_training</span><span class="p">,</span>
    <span class="n">comparisons_to_deactivate</span><span class="o">=</span><span class="p">[</span><span class="s2">"first_name"</span><span class="p">],</span>
    <span class="n">comparison_levels_to_reverse_blocking_rule</span><span class="o">=</span><span class="p">[</span><span class="n">dmeta_level</span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>blocking_rule</code></td>
          <td>
                <code><span title="splink.blocking.BlockingRule">BlockingRule</span> | str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The blocking rule used to generate
pairwise record comparisons.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>comparisons_to_deactivate</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>By default, splink will
analyse the blocking rule provided and estimate the m parameters for
all comaprisons except those included in the blocking rule.  If
comparisons_to_deactivate are provided, spink will instead
estimate m parameters for all comparison except those specified
in the comparisons_to_deactivate list.  This list can either contain
the output_column_name of the Comparison as a string, or Comparison
objects.  Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>comparison_levels_to_reverse_blocking_rule</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>By default,
splink will analyse the blocking rule provided and adjust the
global probability two random records match to account for the matches
specified in the blocking rule. If provided, this argument will overrule
this default behaviour. The user must provide a list of ComparisonLevel
objects.  Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>estimate_without_term_frequencies</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, the iterations
of the EM algorithm ignore any term frequency adjustments and only
depend on the comparison vectors. This allows the EM algorithm to run
much faster, but the estimation of the parameters will change slightly.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>fix_probability_two_random_records_match</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, do not
update the probability two random records match after each iteration.
Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>fix_m_probabilities</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, do not update the m
probabilities after each iteration. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>fix_u_probabilities</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, do not update the u
probabilities after each iteration. Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p></p><div class="highlight"><pre><span></span><code><span class="n">blocking_rule</span> <span class="o">=</span> <span class="s2">"l.first_name = r.first_name and l.dob = r.dob"</span>
<span class="n">linker</span><span class="o">.</span><span class="n">estimate_parameters_using_expectation_maximisation</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span>
</code></pre></div>
or using pre-built rules
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.duckdb.blocking_rule_library</span> <span class="kn">import</span> <span class="n">block_on</span>
<span class="n">blocking_rule</span> <span class="o">=</span> <span class="n">block_on</span><span class="p">([</span><span class="s2">"first_name"</span><span class="p">,</span> <span class="s2">"surname"</span><span class="p">])</span>
<span class="n">linker</span><span class="o">.</span><span class="n">estimate_parameters_using_expectation_maximisation</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>EMTrainingSession</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="splink.em_training_session.EMTrainingSession" href="em_training_session.html#splink.em_training_session.EMTrainingSession">EMTrainingSession</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An object containing information about the training
session such as how parameters changed during the iteration history</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">estimate_parameters_using_expectation_maximisation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">blocking_rule</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">comparisons_to_deactivate</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Comparison</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">comparison_levels_to_reverse_blocking_rule</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ComparisonLevel</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">estimate_without_term_frequencies</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fix_probability_two_random_records_match</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fix_m_probabilities</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fix_u_probabilities</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">populate_probability_two_random_records_match_from_trained_values</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EMTrainingSession</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Estimate the parameters of the linkage model using expectation maximisation.</span>

<span class="sd">    By default, the m probabilities are estimated, but not the u probabilities,</span>
<span class="sd">    because good estimates for the u probabilities can be obtained from</span>
<span class="sd">    `linker.estimate_u_using_random_sampling()`.  You can change this by setting</span>
<span class="sd">    `fix_u_probabilities` to False.</span>

<span class="sd">    The blocking rule provided is used to generate pairwise record comparisons.</span>
<span class="sd">    Usually, this should be a blocking rule that results in a dataframe where</span>
<span class="sd">    matches are between about 1% and 99% of the comparisons.</span>

<span class="sd">    By default, m parameters are estimated for all comparisons except those which</span>
<span class="sd">    are included in the blocking rule.</span>

<span class="sd">    For example, if the blocking rule is `l.first_name = r.first_name`, then</span>
<span class="sd">    parameter esimates will be made for all comparison except those which use</span>
<span class="sd">    `first_name` in their sql_condition</span>

<span class="sd">    By default, the probability two random records match is estimated for the</span>
<span class="sd">    blocked data, and then the m and u parameters for the columns specified in the</span>
<span class="sd">    blocking rules are used to estiamte the global probability two random records</span>
<span class="sd">    match.</span>

<span class="sd">    To control which comparisons should have their parameter estimated, and the</span>
<span class="sd">    process of 'reversing out' the global probability two random records match, the</span>
<span class="sd">    user may specify `comparisons_to_deactivate` and</span>
<span class="sd">    `comparison_levels_to_reverse_blocking_rule`.   This is useful, for example</span>
<span class="sd">    if you block on the dmetaphone of a column but match on the original column.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Default behaviour</span>
<span class="sd">        ```py</span>
<span class="sd">        br_training = "l.first_name = r.first_name and l.dob = r.dob"</span>
<span class="sd">        linker.estimate_parameters_using_expectation_maximisation(br_training)</span>
<span class="sd">        ```</span>
<span class="sd">        Specify which comparisons to deactivate</span>
<span class="sd">        ```py</span>
<span class="sd">        br_training = "l.dmeta_first_name = r.dmeta_first_name"</span>
<span class="sd">        settings_obj = linker._settings_obj</span>
<span class="sd">        comp = settings_obj._get_comparison_by_output_column_name("first_name")</span>
<span class="sd">        dmeta_level = comp._get_comparison_level_by_comparison_vector_value(1)</span>
<span class="sd">        linker.estimate_parameters_using_expectation_maximisation(</span>
<span class="sd">            br_training,</span>
<span class="sd">            comparisons_to_deactivate=["first_name"],</span>
<span class="sd">            comparison_levels_to_reverse_blocking_rule=[dmeta_level],</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        blocking_rule (BlockingRule | str): The blocking rule used to generate</span>
<span class="sd">            pairwise record comparisons.</span>
<span class="sd">        comparisons_to_deactivate (list, optional): By default, splink will</span>
<span class="sd">            analyse the blocking rule provided and estimate the m parameters for</span>
<span class="sd">            all comaprisons except those included in the blocking rule.  If</span>
<span class="sd">            comparisons_to_deactivate are provided, spink will instead</span>
<span class="sd">            estimate m parameters for all comparison except those specified</span>
<span class="sd">            in the comparisons_to_deactivate list.  This list can either contain</span>
<span class="sd">            the output_column_name of the Comparison as a string, or Comparison</span>
<span class="sd">            objects.  Defaults to None.</span>
<span class="sd">        comparison_levels_to_reverse_blocking_rule (list, optional): By default,</span>
<span class="sd">            splink will analyse the blocking rule provided and adjust the</span>
<span class="sd">            global probability two random records match to account for the matches</span>
<span class="sd">            specified in the blocking rule. If provided, this argument will overrule</span>
<span class="sd">            this default behaviour. The user must provide a list of ComparisonLevel</span>
<span class="sd">            objects.  Defaults to None.</span>
<span class="sd">        estimate_without_term_frequencies (bool, optional): If True, the iterations</span>
<span class="sd">            of the EM algorithm ignore any term frequency adjustments and only</span>
<span class="sd">            depend on the comparison vectors. This allows the EM algorithm to run</span>
<span class="sd">            much faster, but the estimation of the parameters will change slightly.</span>
<span class="sd">        fix_probability_two_random_records_match (bool, optional): If True, do not</span>
<span class="sd">            update the probability two random records match after each iteration.</span>
<span class="sd">            Defaults to False.</span>
<span class="sd">        fix_m_probabilities (bool, optional): If True, do not update the m</span>
<span class="sd">            probabilities after each iteration. Defaults to False.</span>
<span class="sd">        fix_u_probabilities (bool, optional): If True, do not update the u</span>
<span class="sd">            probabilities after each iteration. Defaults to True.</span>
<span class="sd">        populate_probability_two_random_records_match_from_trained_values</span>
<span class="sd">            (bool, optional): If True, derive this parameter from</span>
<span class="sd">            the blocked value. Defaults to False.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        blocking_rule = "l.first_name = r.first_name and l.dob = r.dob"</span>
<span class="sd">        linker.estimate_parameters_using_expectation_maximisation(blocking_rule)</span>
<span class="sd">        ```</span>
<span class="sd">        or using pre-built rules</span>
<span class="sd">        ```py</span>
<span class="sd">        from splink.duckdb.blocking_rule_library import block_on</span>
<span class="sd">        blocking_rule = block_on(["first_name", "surname"])</span>
<span class="sd">        linker.estimate_parameters_using_expectation_maximisation(blocking_rule)</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        EMTrainingSession:  An object containing information about the training</span>
<span class="sd">            session such as how parameters changed during the iteration history</span>

<span class="sd">    """</span>
    <span class="c1"># Ensure this has been run on the main linker so that it's in the cache</span>
    <span class="c1"># to be used by the training linkers</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">()</span>

    <span class="c1"># Extract the blocking rule</span>
    <span class="c1"># Check it's a BlockingRule (not a SaltedBlockingRule, ExlpodingBlockingRule)</span>
    <span class="c1"># and raise error if not specfically a BlockingRule</span>
    <span class="n">blocking_rule</span> <span class="o">=</span> <span class="n">blocking_rule_to_obj</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">blocking_rule</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">BlockingRule</span><span class="p">,</span> <span class="n">SaltedBlockingRule</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">"EM blocking rules must be plain blocking rules, not "</span>
            <span class="s2">"salted or exploding blocking rules"</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">comparisons_to_deactivate</span><span class="p">:</span>
        <span class="c1"># If user provided a string, convert to Comparison object</span>
        <span class="n">comparisons_to_deactivate</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_get_comparison_by_output_column_name</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">n</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">comparisons_to_deactivate</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">comparison_levels_to_reverse_blocking_rule</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">"</span><span class="se">\n</span><span class="s2">WARNING: </span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"You have provided comparisons_to_deactivate but not "</span>
                <span class="s2">"comparison_levels_to_reverse_blocking_rule.</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"If comparisons_to_deactivate is provided, then "</span>
                <span class="s2">"you usually need to provide corresponding "</span>
                <span class="s2">"comparison_levels_to_reverse_blocking_rule "</span>
                <span class="s2">"because each comparison to deactivate is effectively treated "</span>
                <span class="s2">"as an exact match."</span>
            <span class="p">)</span>

    <span class="n">em_training_session</span> <span class="o">=</span> <span class="n">EMTrainingSession</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">blocking_rule</span><span class="p">,</span>
        <span class="n">fix_u_probabilities</span><span class="o">=</span><span class="n">fix_u_probabilities</span><span class="p">,</span>
        <span class="n">fix_m_probabilities</span><span class="o">=</span><span class="n">fix_m_probabilities</span><span class="p">,</span>
        <span class="n">fix_probability_two_random_records_match</span><span class="o">=</span><span class="n">fix_probability_two_random_records_match</span><span class="p">,</span>  <span class="c1"># noqa 501</span>
        <span class="n">comparisons_to_deactivate</span><span class="o">=</span><span class="n">comparisons_to_deactivate</span><span class="p">,</span>
        <span class="n">comparison_levels_to_reverse_blocking_rule</span><span class="o">=</span><span class="n">comparison_levels_to_reverse_blocking_rule</span><span class="p">,</span>  <span class="c1"># noqa 501</span>
        <span class="n">estimate_without_term_frequencies</span><span class="o">=</span><span class="n">estimate_without_term_frequencies</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">em_training_session</span><span class="o">.</span><span class="n">_train</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_populate_m_u_from_trained_values</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">populate_probability_two_random_records_match_from_trained_values</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_probability_two_random_records_match_from_trained_values</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_columns_without_estimated_parameters_message</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">em_training_session</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.estimate_probability_two_random_records_match" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">estimate_probability_two_random_records_match</span><span class="p">(</span><span class="n">deterministic_matching_rules</span><span class="p">,</span> <span class="n">recall</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.estimate_probability_two_random_records_match" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Estimate the model parameter <code>probability_two_random_records_match</code> using
a direct estimation approach.</p>
<p>See <a href="https://github.com/moj-analytical-services/splink/issues/462">here</a>
for discussion of methodology</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>deterministic_matching_rules</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of deterministic matching
rules that should be designed to admit very few (none if possible)
false positives</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>recall</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A guess at the recall the deterministic matching rules
will attain.  i.e. what proportion of true matches will be recovered
by these deterministic rules</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3712</span>
<span class="normal">3713</span>
<span class="normal">3714</span>
<span class="normal">3715</span>
<span class="normal">3716</span>
<span class="normal">3717</span>
<span class="normal">3718</span>
<span class="normal">3719</span>
<span class="normal">3720</span>
<span class="normal">3721</span>
<span class="normal">3722</span>
<span class="normal">3723</span>
<span class="normal">3724</span>
<span class="normal">3725</span>
<span class="normal">3726</span>
<span class="normal">3727</span>
<span class="normal">3728</span>
<span class="normal">3729</span>
<span class="normal">3730</span>
<span class="normal">3731</span>
<span class="normal">3732</span>
<span class="normal">3733</span>
<span class="normal">3734</span>
<span class="normal">3735</span>
<span class="normal">3736</span>
<span class="normal">3737</span>
<span class="normal">3738</span>
<span class="normal">3739</span>
<span class="normal">3740</span>
<span class="normal">3741</span>
<span class="normal">3742</span>
<span class="normal">3743</span>
<span class="normal">3744</span>
<span class="normal">3745</span>
<span class="normal">3746</span>
<span class="normal">3747</span>
<span class="normal">3748</span>
<span class="normal">3749</span>
<span class="normal">3750</span>
<span class="normal">3751</span>
<span class="normal">3752</span>
<span class="normal">3753</span>
<span class="normal">3754</span>
<span class="normal">3755</span>
<span class="normal">3756</span>
<span class="normal">3757</span>
<span class="normal">3758</span>
<span class="normal">3759</span>
<span class="normal">3760</span>
<span class="normal">3761</span>
<span class="normal">3762</span>
<span class="normal">3763</span>
<span class="normal">3764</span>
<span class="normal">3765</span>
<span class="normal">3766</span>
<span class="normal">3767</span>
<span class="normal">3768</span>
<span class="normal">3769</span>
<span class="normal">3770</span>
<span class="normal">3771</span>
<span class="normal">3772</span>
<span class="normal">3773</span>
<span class="normal">3774</span>
<span class="normal">3775</span>
<span class="normal">3776</span>
<span class="normal">3777</span>
<span class="normal">3778</span>
<span class="normal">3779</span>
<span class="normal">3780</span>
<span class="normal">3781</span>
<span class="normal">3782</span>
<span class="normal">3783</span>
<span class="normal">3784</span>
<span class="normal">3785</span>
<span class="normal">3786</span>
<span class="normal">3787</span>
<span class="normal">3788</span>
<span class="normal">3789</span>
<span class="normal">3790</span>
<span class="normal">3791</span>
<span class="normal">3792</span>
<span class="normal">3793</span>
<span class="normal">3794</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">estimate_probability_two_random_records_match</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">deterministic_matching_rules</span><span class="p">,</span> <span class="n">recall</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Estimate the model parameter `probability_two_random_records_match` using</span>
<span class="sd">    a direct estimation approach.</span>

<span class="sd">    See [here](https://github.com/moj-analytical-services/splink/issues/462)</span>
<span class="sd">    for discussion of methodology</span>

<span class="sd">    Args:</span>
<span class="sd">        deterministic_matching_rules (list): A list of deterministic matching</span>
<span class="sd">            rules that should be designed to admit very few (none if possible)</span>
<span class="sd">            false positives</span>
<span class="sd">        recall (float): A guess at the recall the deterministic matching rules</span>
<span class="sd">            will attain.  i.e. what proportion of true matches will be recovered</span>
<span class="sd">            by these deterministic rules</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">recall</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">recall</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"Estimated recall must be greater than 0 "</span>
            <span class="sa">f</span><span class="s2">"and no more than 1. Supplied value </span><span class="si">{</span><span class="n">recall</span><span class="si">}</span><span class="s2">."</span>
        <span class="p">)</span>

    <span class="c1"># If user, by error, provides a single rule as a string</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">deterministic_matching_rules</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">deterministic_matching_rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">deterministic_matching_rules</span><span class="p">]</span>

    <span class="n">records</span> <span class="o">=</span> <span class="n">cumulative_comparisons_generated_by_blocking_rules</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">deterministic_matching_rules</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">summary_record</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">num_observed_matches</span> <span class="o">=</span> <span class="n">summary_record</span><span class="p">[</span><span class="s2">"cumulative_rows"</span><span class="p">]</span>
    <span class="n">num_total_comparisons</span> <span class="o">=</span> <span class="n">summary_record</span><span class="p">[</span><span class="s2">"cartesian"</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">num_observed_matches</span> <span class="o">&gt;</span> <span class="n">num_total_comparisons</span> <span class="o">*</span> <span class="n">recall</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"Deterministic matching rules led to more "</span>
            <span class="sa">f</span><span class="s2">"observed matches than is consistent with supplied recall. "</span>
            <span class="sa">f</span><span class="s2">"With these rules, recall must be at least "</span>
            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">num_observed_matches</span><span class="o">/</span><span class="n">num_total_comparisons</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">."</span>
        <span class="p">)</span>

    <span class="n">num_expected_matches</span> <span class="o">=</span> <span class="n">num_observed_matches</span> <span class="o">/</span> <span class="n">recall</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">num_expected_matches</span> <span class="o">/</span> <span class="n">num_total_comparisons</span>

    <span class="c1"># warn about boundary values, as these will usually be in error</span>
    <span class="k">if</span> <span class="n">num_observed_matches</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"WARNING: Deterministic matching rules led to no observed matches! "</span>
            <span class="sa">f</span><span class="s2">"This means that no possible record pairs are matches, "</span>
            <span class="sa">f</span><span class="s2">"and no records are linked to one another.</span><span class="se">\n</span><span class="s2">"</span>
            <span class="sa">f</span><span class="s2">"If this is truly the case then you do not need "</span>
            <span class="sa">f</span><span class="s2">"to run the linkage model.</span><span class="se">\n</span><span class="s2">"</span>
            <span class="sa">f</span><span class="s2">"However this is usually in error; "</span>
            <span class="sa">f</span><span class="s2">"expected rules to have recall of </span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">recall</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2">%. "</span>
            <span class="sa">f</span><span class="s2">"Consider revising rules as they may have an error."</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">prob</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">"WARNING: Probability two random records match is estimated to be 1.</span><span class="se">\n</span><span class="s2">"</span>
            <span class="s2">"This means that all possible record pairs are matches, "</span>
            <span class="s2">"and all records are linked to one another.</span><span class="se">\n</span><span class="s2">"</span>
            <span class="s2">"If this is truly the case then you do not need "</span>
            <span class="s2">"to run the linkage model.</span><span class="se">\n</span><span class="s2">"</span>
            <span class="s2">"However, it is more likely that this estimate is faulty. "</span>
            <span class="s2">"Perhaps your deterministic matching rules include "</span>
            <span class="s2">"too many false positives?"</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_probability_two_random_records_match</span> <span class="o">=</span> <span class="n">prob</span>

    <span class="n">reciprocal_prob</span> <span class="o">=</span> <span class="s2">"Infinity"</span> <span class="k">if</span> <span class="n">prob</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">prob</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">"Probability two random records match is estimated to be  </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.3g</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">"</span>
        <span class="sa">f</span><span class="s2">"This means that amongst all possible pairwise record comparisons, one in "</span>
        <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">reciprocal_prob</span><span class="si">}</span><span class="s2"> are expected to match.  "</span>
        <span class="sa">f</span><span class="s2">"With </span><span class="si">{</span><span class="n">num_total_comparisons</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> total"</span>
        <span class="s2">" possible comparisons, we expect a total of around "</span>
        <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">num_expected_matches</span><span class="si">:</span><span class="s2">,.2f</span><span class="si">}</span><span class="s2"> matching pairs"</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.estimate_u_using_random_sampling" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">estimate_u_using_random_sampling</span><span class="p">(</span><span class="n">max_pairs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">target_rows</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.estimate_u_using_random_sampling" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Estimate the u parameters of the linkage model using random sampling.</p>
<p>The u parameters represent the proportion of record comparisons that fall
into each comparison level amongst truly non-matching records.</p>
<p>This procedure takes a sample of the data and generates the cartesian
product of pairwise record comparisons amongst the sampled records.
The validity of the u values rests on the assumption that the resultant
pairwise comparisons are non-matches (or at least, they are very unlikely to be
matches). For large datasets, this is typically true.</p>
<p>The results of estimate_u_using_random_sampling, and therefore an entire splink
model, can be made reproducible by setting the seed parameter. Setting the seed
will have performance implications as additional processing is required.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>max_pairs</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of pairwise record comparisons to</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>seed</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seed for random sampling. Assign to get reproducible u</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">estimate_u_using_random_sampling</span><span class="p">(</span><span class="mf">1e8</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>None</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Updates the estimated u parameters within the linker object</p>
            </div>
          </td>
        </tr>
        <tr>
<td></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>and returns nothing.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">estimate_u_using_random_sampling</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">max_pairs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">target_rows</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Estimate the u parameters of the linkage model using random sampling.</span>

<span class="sd">    The u parameters represent the proportion of record comparisons that fall</span>
<span class="sd">    into each comparison level amongst truly non-matching records.</span>

<span class="sd">    This procedure takes a sample of the data and generates the cartesian</span>
<span class="sd">    product of pairwise record comparisons amongst the sampled records.</span>
<span class="sd">    The validity of the u values rests on the assumption that the resultant</span>
<span class="sd">    pairwise comparisons are non-matches (or at least, they are very unlikely to be</span>
<span class="sd">    matches). For large datasets, this is typically true.</span>

<span class="sd">    The results of estimate_u_using_random_sampling, and therefore an entire splink</span>
<span class="sd">    model, can be made reproducible by setting the seed parameter. Setting the seed</span>
<span class="sd">    will have performance implications as additional processing is required.</span>

<span class="sd">    Args:</span>
<span class="sd">        max_pairs (int): The maximum number of pairwise record comparisons to</span>
<span class="sd">        sample. Larger will give more accurate estimates</span>
<span class="sd">        but lead to longer runtimes.  In our experience at least 1e9 (one billion)</span>
<span class="sd">        gives best results but can take a long time to compute. 1e7 (ten million)</span>
<span class="sd">        is often adequate whilst testing different model specifications, before</span>
<span class="sd">        the final model is estimated.</span>
<span class="sd">        seed (int): Seed for random sampling. Assign to get reproducible u</span>
<span class="sd">        probabilities. Note, seed for random sampling is only supported for</span>
<span class="sd">        DuckDB and Spark, for Athena and SQLite set to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.estimate_u_using_random_sampling(1e8)</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Updates the estimated u parameters within the linker object</span>
<span class="sd">        and returns nothing.</span>
<span class="sd">    """</span>
    <span class="c1"># TODO: Remove this compatibility code in a future release once we drop</span>
    <span class="c1"># support for "target_rows". Deprecation warning added in 3.7.0</span>
    <span class="k">if</span> <span class="n">max_pairs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">target_rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># user supplied both</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Just use max_pairs"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">max_pairs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># user is doing it correctly</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">target_rows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># user is using deprecated argument</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">"target_rows is deprecated; use max_pairs"</span><span class="p">,</span>
            <span class="n">SplinkDeprecated</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">max_pairs</span> <span class="o">=</span> <span class="n">target_rows</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Missing argument max_pairs"</span><span class="p">)</span>

    <span class="n">estimate_u_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_pairs</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_populate_m_u_from_trained_values</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_columns_without_estimated_parameters_message</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.find_matches_to_new_records" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">find_matches_to_new_records</span><span class="p">(</span><span class="n">records_or_tablename</span><span class="p">,</span> <span class="n">blocking_rules</span><span class="o">=</span><span class="p">[],</span> <span class="n">match_weight_threshold</span><span class="o">=-</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.find_matches_to_new_records" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Given one or more records, find records in the input dataset(s) which match
and return in order of the Splink prediction score.</p>
<p>This effectively provides a way of searching the input datasets
for given record(s)</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>records_or_tablename</code></td>
          <td>
                <code>List[dict]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Input search record(s) as list of dict,
or a table registered to the database.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>blocking_rules</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Blocking rules to select
which records to find and score. If [], do not use a blocking
rule - meaning the input records will be compared to all records
provided to the linker when it was instantiated. Defaults to [].</p>
            </div>
          </td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_threshold</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return matches with a match weight
above this threshold. Defaults to -4.</p>
            </div>
          </td>
          <td>
                <code>-4</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="s2">"saved_settings.json"</span><span class="p">)</span>
<span class="c1"># Pre-compute tf tables for any tables with</span>
<span class="c1"># term frequency adjustments</span>
<span class="n">linker</span><span class="o">.</span><span class="n">compute_tf_table</span><span class="p">(</span><span class="s2">"first_name"</span><span class="p">)</span>
<span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'unique_id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">'first_name'</span><span class="p">:</span> <span class="s2">"John"</span><span class="p">,</span>
    <span class="s1">'surname'</span><span class="p">:</span> <span class="s2">"Smith"</span><span class="p">,</span>
    <span class="s1">'dob'</span><span class="p">:</span> <span class="s2">"1971-05-24"</span><span class="p">,</span>
    <span class="s1">'city'</span><span class="p">:</span> <span class="s2">"London"</span><span class="p">,</span>
    <span class="s1">'email'</span><span class="p">:</span> <span class="s2">"john@smith.net"</span>
    <span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">find_matches_to_new_records</span><span class="p">([</span><span class="n">record</span><span class="p">],</span> <span class="n">blocking_rules</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The pairwise comparisons.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_matches_to_new_records</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">records_or_tablename</span><span class="p">,</span>
    <span class="n">blocking_rules</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">match_weight_threshold</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Given one or more records, find records in the input dataset(s) which match</span>
<span class="sd">    and return in order of the Splink prediction score.</span>

<span class="sd">    This effectively provides a way of searching the input datasets</span>
<span class="sd">    for given record(s)</span>

<span class="sd">    Args:</span>
<span class="sd">        records_or_tablename (List[dict]): Input search record(s) as list of dict,</span>
<span class="sd">            or a table registered to the database.</span>
<span class="sd">        blocking_rules (list, optional): Blocking rules to select</span>
<span class="sd">            which records to find and score. If [], do not use a blocking</span>
<span class="sd">            rule - meaning the input records will be compared to all records</span>
<span class="sd">            provided to the linker when it was instantiated. Defaults to [].</span>
<span class="sd">        match_weight_threshold (int, optional): Return matches with a match weight</span>
<span class="sd">            above this threshold. Defaults to -4.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker = DuckDBLinker(df)</span>
<span class="sd">        linker.load_settings("saved_settings.json")</span>
<span class="sd">        # Pre-compute tf tables for any tables with</span>
<span class="sd">        # term frequency adjustments</span>
<span class="sd">        linker.compute_tf_table("first_name")</span>
<span class="sd">        record = {'unique_id': 1,</span>
<span class="sd">            'first_name': "John",</span>
<span class="sd">            'surname': "Smith",</span>
<span class="sd">            'dob': "1971-05-24",</span>
<span class="sd">            'city': "London",</span>
<span class="sd">            'email': "john@smith.net"</span>
<span class="sd">            }</span>
<span class="sd">        df = linker.find_matches_to_new_records([record], blocking_rules=[])</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame: The pairwise comparisons.</span>
<span class="sd">    """</span>

    <span class="n">original_blocking_rules</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span>
    <span class="p">)</span>
    <span class="n">original_link_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span>

    <span class="n">blocking_rules</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">records_or_tablename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="n">ascii_uid</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">new_records_tablename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"__splink__df_new_records_</span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s2">"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
            <span class="n">records_or_tablename</span><span class="p">,</span> <span class="n">new_records_tablename</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_records_tablename</span> <span class="o">=</span> <span class="n">records_or_tablename</span>

    <span class="n">new_records_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_table_to_splink_dataframe</span><span class="p">(</span>
        <span class="s2">"__splink__df_new_records"</span><span class="p">,</span> <span class="n">new_records_tablename</span>
    <span class="p">)</span>

    <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span>
    <span class="n">input_dfs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># If our df_concat_with_tf table already exists, derive the term frequency</span>
    <span class="c1"># tables from df_concat_with_tf rather than computing them</span>
    <span class="k">if</span> <span class="s2">"__splink__df_concat_with_tf"</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
        <span class="n">concat_with_tf</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">]</span>
        <span class="n">tf_tables</span> <span class="o">=</span> <span class="n">compute_term_frequencies_from_concat_with_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># This queues up our tf tables, rather materialising them</span>
        <span class="k">for</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">tf_tables</span><span class="p">:</span>
            <span class="c1"># if tf is a SplinkDataFrame, then the table already exists</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">SplinkDataFrame</span><span class="p">):</span>
                <span class="n">input_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tf</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">tf</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">tf</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># This queues up our cols_with_tf and df_concat_with_tf tables.</span>
        <span class="n">concat_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">(</span><span class="n">materialise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">concat_with_tf</span><span class="p">:</span>
        <span class="n">input_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">concat_with_tf</span><span class="p">)</span>

    <span class="n">blocking_rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">blocking_rule_to_obj</span><span class="p">(</span><span class="n">br</span><span class="p">)</span> <span class="k">for</span> <span class="n">br</span> <span class="ow">in</span> <span class="n">blocking_rules</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">br</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">):</span>
        <span class="n">br</span><span class="o">.</span><span class="n">add_preceding_rules</span><span class="p">(</span><span class="n">blocking_rules</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="n">blocking_rules</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="n">_join_tf_to_input_df_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">sql</span> <span class="o">=</span> <span class="n">sql</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"__splink__df_concat"</span><span class="p">,</span> <span class="n">new_records_tablename</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_new_records_with_tf_before_uid_fix"</span><span class="p">)</span>

    <span class="n">add_unique_id_and_source_dataset_cols_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_records_df</span><span class="p">)</span>

    <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="n">compute_comparison_vector_values_sql</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vectors"</span><span class="p">)</span>

    <span class="n">sqls</span> <span class="o">=</span> <span class="n">predict_from_comparison_vectors_sqls</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span>
        <span class="n">sql_infinity_expression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_infinity_expression</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"""</span>
<span class="s2">    select * from __splink__df_predict</span>
<span class="s2">    where match_weight &gt; </span><span class="si">{</span><span class="n">match_weight_threshold</span><span class="si">}</span>
<span class="s2">    """</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__find_matches_predictions"</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span>
        <span class="n">input_dataframes</span><span class="o">=</span><span class="n">input_dfs</span><span class="p">,</span> <span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_blocking_rules_to_generate_predictions</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">original_blocking_rules</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_link_type</span> <span class="o">=</span> <span class="n">original_link_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_find_new_matches_mode</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.initialise_settings" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">initialise_settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.initialise_settings" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p><em>This method is now deprecated. Please use <code>load_settings</code>
when loading existing settings or <code>load_model</code> when loading
 a pre-trained model.</em></p>
<p>Initialise settings for the linker.  To be used if settings were
not passed to the linker on creation.
Examples:
    === "<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 0C5.363 0 0 5.363 0 12s5.363 12 12 12 12-5.363 12-12S18.637 0 12 0zM9.502 7.03a4.974 4.974 0 0 1 4.97 4.97 4.974 4.974 0 0 1-4.97 4.97A4.974 4.974 0 0 1 4.532 12a4.974 4.974 0 0 1 4.97-4.97zm6.563 3.183h2.351c.98 0 1.787.782 1.787 1.762s-.807 1.789-1.787 1.789h-2.351v-3.551z"></path></svg></span> DuckDB"
        </p><div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">([</span><span class="s2">"first_name"</span><span class="p">,</span> <span class="s2">"surname"</span><span class="p">])</span>
<span class="n">linker</span><span class="o">.</span><span class="n">initialise_settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
</code></pre></div>
    === "<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.593 3.593 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a551.9 551.9 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a4.874 4.874 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535c0 .023.002.045 0 .073-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098.349.117.697.231 1.045.347h.001c.02.012.045.02.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.783 2.783 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353.08 353.08 0 0 0-2.421-4.018 4.61 4.61 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.592.592 0 0 1 .189.211c.87 1.446 1.742 2.89 2.609 4.338.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217.367-.098.735-.193 1.103-.289a.399.399 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019c-.538-.18-1.077-.358-1.615-.539-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.398.398 0 0 1-.18.132c.035-.378.068-.757.104-1.136.149-1.572.297-3.144.451-4.716-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.595.595 0 0 1 .24-.134c1.797-.57 3.595-1.14 5.394-1.705.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441.241-1.363.483-2.726.726-4.088.068-.386.14-.771.21-1.157z"></path></svg></span> Spark"
        <div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">([</span><span class="s2">"first_name"</span><span class="p">,</span> <span class="s2">"surname"</span><span class="p">])</span>
<span class="n">linker</span><span class="o">.</span><span class="n">initialise_settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
</code></pre></div>
    === "<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 0 1-.28.104.488.488 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167 4.577 4.577 0 0 1 1.005-.36 4.84 4.84 0 0 1 1.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144a1.78 1.78 0 0 0 .758-.51 1.27 1.27 0 0 0 .272-.512c.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.416-.287-.807-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926a2.157 2.157 0 0 1-.583.703c-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zm1.509 3.88c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zm1.094-1.246c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z"></path></svg></span> Athena"
        <div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">AthenaLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">([</span><span class="s2">"first_name"</span><span class="p">,</span> <span class="s2">"surname"</span><span class="p">])</span>
<span class="n">linker</span><span class="o">.</span><span class="n">initialise_settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
</code></pre></div>
    === "<span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M21.678.521c-1.032-.92-2.28-.55-3.513.544a8.71 8.71 0 0 0-.547.535c-2.109 2.237-4.066 6.38-4.674 9.544.237.48.422 1.093.544 1.561a13.044 13.044 0 0 1 .164.703s-.019-.071-.096-.296l-.05-.146a1.689 1.689 0 0 0-.033-.08c-.138-.32-.518-.995-.686-1.289-.143.423-.27.818-.376 1.176.484.884.778 2.4.778 2.4s-.025-.099-.147-.442c-.107-.303-.644-1.244-.772-1.464-.217.804-.304 1.346-.226 1.478.152.256.296.698.422 1.186.286 1.1.485 2.44.485 2.44l.017.224a22.41 22.41 0 0 0 .056 2.748c.095 1.146.273 2.13.5 2.657l.155-.084c-.334-1.038-.47-2.399-.41-3.967.09-2.398.642-5.29 1.661-8.304 1.723-4.55 4.113-8.201 6.3-9.945-1.993 1.8-4.692 7.63-5.5 9.788-.904 2.416-1.545 4.684-1.931 6.857.666-2.037 2.821-2.912 2.821-2.912s1.057-1.304 2.292-3.166c-.74.169-1.955.458-2.362.629-.6.251-.762.337-.762.337s1.945-1.184 3.613-1.72C21.695 7.9 24.195 2.767 21.678.521m-18.573.543A1.842 1.842 0 0 0 1.27 2.9v16.608a1.84 1.84 0 0 0 1.835 1.834h9.418a22.953 22.953 0 0 1-.052-2.707c-.006-.062-.011-.141-.016-.2a27.01 27.01 0 0 0-.473-2.378c-.121-.47-.275-.898-.369-1.057-.116-.197-.098-.31-.097-.432 0-.12.015-.245.037-.386a9.98 9.98 0 0 1 .234-1.045l.217-.028c-.017-.035-.014-.065-.031-.097l-.041-.381a32.8 32.8 0 0 1 .382-1.194l.2-.019c-.008-.016-.01-.038-.018-.053l-.043-.316c.63-3.28 2.587-7.443 4.8-9.791.066-.069.133-.128.198-.194Z"></path></svg></span> SQLite"
        <div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">SQLiteLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">([</span><span class="s2">"first_name"</span><span class="p">,</span> <span class="s2">"surname"</span><span class="p">])</span>
<span class="n">linker</span><span class="o">.</span><span class="n">initialise_settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
</code></pre></div>
Args:
    settings_dict (dict): A Splink settings dictionary

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">initialise_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""*This method is now deprecated. Please use `load_settings`</span>
<span class="sd">    when loading existing settings or `load_model` when loading</span>
<span class="sd">     a pre-trained model.*</span>

<span class="sd">    Initialise settings for the linker.  To be used if settings were</span>
<span class="sd">    not passed to the linker on creation.</span>
<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">            linker.initialise_settings(settings_dict)</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = SparkLinker(df)</span>
<span class="sd">            linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">            linker.initialise_settings(settings_dict)</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-amazonaws: Athena"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = AthenaLinker(df)</span>
<span class="sd">            linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">            linker.initialise_settings(settings_dict)</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-sqlite: SQLite"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = SQLiteLinker(df)</span>
<span class="sd">            linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">            linker.initialise_settings(settings_dict)</span>
<span class="sd">            ```</span>
<span class="sd">    Args:</span>
<span class="sd">        settings_dict (dict): A Splink settings dictionary</span>
<span class="sd">    """</span>
    <span class="c1"># If a uid already exists in your settings object, prioritise this</span>
    <span class="n">settings_dict</span><span class="p">[</span><span class="s2">"linker_uid"</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"linker_uid"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span><span class="p">)</span>
    <span class="n">settings_dict</span><span class="p">[</span><span class="s2">"sql_dialect"</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">"sql_dialect"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_dict</span> <span class="o">=</span> <span class="n">settings_dict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_input_dfs</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_dialect</span><span class="p">()</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">"`initialise_settings` is deprecated. We advise you use "</span>
        <span class="s2">"`linker.load_settings()` when loading in your settings or a previously "</span>
        <span class="s2">"trained model."</span><span class="p">,</span>
        <span class="n">SplinkDeprecated</span><span class="p">,</span>
        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.invalidate_cache" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">invalidate_cache</span><span class="p">()</span></code>

<a href="#splink.linker.Linker.invalidate_cache" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Invalidate the Splink cache.  Any previously-computed tables
will be recomputed.
This is useful, for example, if the input data tables have changed.</p>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3796</span>
<span class="normal">3797</span>
<span class="normal">3798</span>
<span class="normal">3799</span>
<span class="normal">3800</span>
<span class="normal">3801</span>
<span class="normal">3802</span>
<span class="normal">3803</span>
<span class="normal">3804</span>
<span class="normal">3805</span>
<span class="normal">3806</span>
<span class="normal">3807</span>
<span class="normal">3808</span>
<span class="normal">3809</span>
<span class="normal">3810</span>
<span class="normal">3811</span>
<span class="normal">3812</span>
<span class="normal">3813</span>
<span class="normal">3814</span>
<span class="normal">3815</span>
<span class="normal">3816</span>
<span class="normal">3817</span>
<span class="normal">3818</span>
<span class="normal">3819</span>
<span class="normal">3820</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">invalidate_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Invalidate the Splink cache.  Any previously-computed tables</span>
<span class="sd">    will be recomputed.</span>
<span class="sd">    This is useful, for example, if the input data tables have changed.</span>
<span class="sd">    """</span>

    <span class="c1"># Nothing to delete</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="c1"># Before Splink executes a SQL command, it checks the cache to see</span>
    <span class="c1"># whether a table already exists with the name of the output table</span>

    <span class="c1"># This function has the effect of changing the names of the output tables</span>
    <span class="c1"># to include a different unique id</span>

    <span class="c1"># As a result, any previously cached tables will not be found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span> <span class="o">=</span> <span class="n">ascii_uid</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

    <span class="c1"># Drop any existing splink tables from the database</span>
    <span class="c1"># Note, this is not actually necessary, it's just good housekeeping</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">delete_tables_created_by_splink_from_db</span><span class="p">()</span>

    <span class="c1"># As a result, any previously cached tables will not be found</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="o">.</span><span class="n">invalidate_cache</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.labelling_tool_for_specific_record" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">labelling_tool_for_specific_record</span><span class="p">(</span><span class="n">unique_id</span><span class="p">,</span> <span class="n">source_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_path</span><span class="o">=</span><span class="s1">'labelling_tool.html'</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">match_weight_threshold</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">view_in_jupyter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_splink_predictions_in_interface</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.labelling_tool_for_specific_record" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Create a standalone, offline labelling dashboard for a specific record
as identified by its unique id</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>unique_id</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The unique id of the record for which to create the
labelling tool</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>source_dataset</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there are multiple datasets, to
identify the record you must also specify the source_dataset. Defaults
to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>out_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output path for the labelling tool. Defaults
to "labelling_tool.html".</p>
            </div>
          </td>
          <td>
                <code>'labelling_tool.html'</code>
          </td>
        </tr>
        <tr>
          <td><code>overwrite</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, overwrite files at the output
path if they exist. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_threshold</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Include possible matches in the
output which score above this threshold. Defaults to -4.</p>
            </div>
          </td>
          <td>
                <code>-4</code>
          </td>
        </tr>
        <tr>
          <td><code>view_in_jupyter</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If you're viewing in the Jupyter
html viewer, set this to True to extract your labels. Defaults to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>show_splink_predictions_in_interface</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to
show information about the Splink model's predictions that could
potentially bias the decision of the clerical labeller. Defaults to
True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3873</span>
<span class="normal">3874</span>
<span class="normal">3875</span>
<span class="normal">3876</span>
<span class="normal">3877</span>
<span class="normal">3878</span>
<span class="normal">3879</span>
<span class="normal">3880</span>
<span class="normal">3881</span>
<span class="normal">3882</span>
<span class="normal">3883</span>
<span class="normal">3884</span>
<span class="normal">3885</span>
<span class="normal">3886</span>
<span class="normal">3887</span>
<span class="normal">3888</span>
<span class="normal">3889</span>
<span class="normal">3890</span>
<span class="normal">3891</span>
<span class="normal">3892</span>
<span class="normal">3893</span>
<span class="normal">3894</span>
<span class="normal">3895</span>
<span class="normal">3896</span>
<span class="normal">3897</span>
<span class="normal">3898</span>
<span class="normal">3899</span>
<span class="normal">3900</span>
<span class="normal">3901</span>
<span class="normal">3902</span>
<span class="normal">3903</span>
<span class="normal">3904</span>
<span class="normal">3905</span>
<span class="normal">3906</span>
<span class="normal">3907</span>
<span class="normal">3908</span>
<span class="normal">3909</span>
<span class="normal">3910</span>
<span class="normal">3911</span>
<span class="normal">3912</span>
<span class="normal">3913</span>
<span class="normal">3914</span>
<span class="normal">3915</span>
<span class="normal">3916</span>
<span class="normal">3917</span>
<span class="normal">3918</span>
<span class="normal">3919</span>
<span class="normal">3920</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">labelling_tool_for_specific_record</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">unique_id</span><span class="p">,</span>
    <span class="n">source_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">out_path</span><span class="o">=</span><span class="s2">"labelling_tool.html"</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">match_weight_threshold</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">view_in_jupyter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">show_splink_predictions_in_interface</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Create a standalone, offline labelling dashboard for a specific record</span>
<span class="sd">    as identified by its unique id</span>

<span class="sd">    Args:</span>
<span class="sd">        unique_id (str): The unique id of the record for which to create the</span>
<span class="sd">            labelling tool</span>
<span class="sd">        source_dataset (str, optional): If there are multiple datasets, to</span>
<span class="sd">            identify the record you must also specify the source_dataset. Defaults</span>
<span class="sd">            to None.</span>
<span class="sd">        out_path (str, optional): The output path for the labelling tool. Defaults</span>
<span class="sd">            to "labelling_tool.html".</span>
<span class="sd">        overwrite (bool, optional): If true, overwrite files at the output</span>
<span class="sd">            path if they exist. Defaults to False.</span>
<span class="sd">        match_weight_threshold (int, optional): Include possible matches in the</span>
<span class="sd">            output which score above this threshold. Defaults to -4.</span>
<span class="sd">        view_in_jupyter (bool, optional): If you're viewing in the Jupyter</span>
<span class="sd">            html viewer, set this to True to extract your labels. Defaults to False.</span>
<span class="sd">        show_splink_predictions_in_interface (bool, optional): Whether to</span>
<span class="sd">            show information about the Splink model's predictions that could</span>
<span class="sd">            potentially bias the decision of the clerical labeller. Defaults to</span>
<span class="sd">            True.</span>
<span class="sd">    """</span>

    <span class="n">df_comparisons</span> <span class="o">=</span> <span class="n">generate_labelling_tool_comparisons</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">unique_id</span><span class="p">,</span>
        <span class="n">source_dataset</span><span class="p">,</span>
        <span class="n">match_weight_threshold</span><span class="o">=</span><span class="n">match_weight_threshold</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">render_labelling_tool_html</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_comparisons</span><span class="p">,</span>
        <span class="n">show_splink_predictions_in_interface</span><span class="o">=</span><span class="n">show_splink_predictions_in_interface</span><span class="p">,</span>
        <span class="n">out_path</span><span class="o">=</span><span class="n">out_path</span><span class="p">,</span>
        <span class="n">view_in_jupyter</span><span class="o">=</span><span class="n">view_in_jupyter</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.load_model" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_model</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.load_model" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Load a pre-defined model from a json file into the linker.
This is intended to be used with the output of
<code>save_model_to_json()</code>.</p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">"my_settings.json"</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model_path</code></td>
          <td>
                <code><span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A path to your model settings json file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Load a pre-defined model from a json file into the linker.</span>
<span class="sd">    This is intended to be used with the output of</span>
<span class="sd">    `save_model_to_json()`.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.load_model("my_settings.json")</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        model_path (Path): A path to your model settings json file.</span>
<span class="sd">    """</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.load_settings" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">,</span> <span class="n">validate_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.load_settings" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Initialise settings for the linker.  To be used if settings were
not passed to the linker on creation. This can either be in the form
of a settings dictionary or a filepath to a json file containing a
valid settings dictionary.</p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">([</span><span class="s2">"first_name"</span><span class="p">,</span> <span class="s2">"surname"</span><span class="p">])</span>
<span class="n">linker</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">,</span> <span class="n">validate_settings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>settings_dict</code></td>
          <td>
                <code>dict | str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A Splink settings dictionary or
the path to your settings json file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>validate_settings</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When True, check your settings
dictionary for any potential errors that may cause splink to fail.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_settings</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">settings_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">validate_settings</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Initialise settings for the linker.  To be used if settings were</span>
<span class="sd">    not passed to the linker on creation. This can either be in the form</span>
<span class="sd">    of a settings dictionary or a filepath to a json file containing a</span>
<span class="sd">    valid settings dictionary.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker = DuckDBLinker(df)</span>
<span class="sd">        linker.profile_columns(["first_name", "surname"])</span>
<span class="sd">        linker.load_settings(settings_dict, validate_settings=True)</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        settings_dict (dict | str | Path): A Splink settings dictionary or</span>
<span class="sd">            the path to your settings json file.</span>
<span class="sd">        validate_settings (bool, optional): When True, check your settings</span>
<span class="sd">            dictionary for any potential errors that may cause splink to fail.</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
        <span class="n">settings_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>

    <span class="c1"># Store the cache ID so it can be reloaded after cache invalidation</span>
    <span class="n">cache_uid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span>

    <span class="c1"># Invalidate the cache if anything currently exists. If the settings are</span>
    <span class="c1"># changing, our charts, tf tables, etc may need changing.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">invalidate_cache</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_dict</span> <span class="o">=</span> <span class="n">settings_dict</span>  <span class="c1"># overwrite or add</span>

    <span class="c1"># Get the SQL dialect from settings_dict or use the default</span>
    <span class="n">sql_dialect</span> <span class="o">=</span> <span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"sql_dialect"</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_dialect</span><span class="p">)</span>
    <span class="n">settings_dict</span><span class="p">[</span><span class="s2">"sql_dialect"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sql_dialect</span>
    <span class="n">settings_dict</span><span class="p">[</span><span class="s2">"linker_uid"</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"linker_uid"</span><span class="p">,</span> <span class="n">cache_uid</span><span class="p">)</span>

    <span class="c1"># Check the user's comparisons (if they exist)</span>
    <span class="n">log_comparison_errors</span><span class="p">(</span><span class="n">settings_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"comparisons"</span><span class="p">),</span> <span class="n">sql_dialect</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj_</span> <span class="o">=</span> <span class="n">Settings</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">)</span>
    <span class="c1"># Check the final settings object</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_settings</span><span class="p">(</span><span class="n">validate_settings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.load_settings_from_json" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">load_settings_from_json</span><span class="p">(</span><span class="n">in_path</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.load_settings_from_json" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p><em>This method is now deprecated. Please use <code>load_settings</code>
when loading existing settings or <code>load_model</code> when loading
 a pre-trained model.</em></p>
<p>Load settings from a <code>.json</code> file.
This <code>.json</code> file would usually be the output of
<code>linker.save_model_to_json()</code>
Examples:
    </p><div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">load_settings_from_json</span><span class="p">(</span><span class="s2">"my_settings.json"</span><span class="p">)</span>
</code></pre></div>
Args:
    in_path (str): Path to settings json file

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_settings_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""*This method is now deprecated. Please use `load_settings`</span>
<span class="sd">    when loading existing settings or `load_model` when loading</span>
<span class="sd">     a pre-trained model.*</span>

<span class="sd">    Load settings from a `.json` file.</span>
<span class="sd">    This `.json` file would usually be the output of</span>
<span class="sd">    `linker.save_model_to_json()`</span>
<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.load_settings_from_json("my_settings.json")</span>
<span class="sd">        ```</span>
<span class="sd">    Args:</span>
<span class="sd">        in_path (str): Path to settings json file</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="n">in_path</span><span class="p">)</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">"`load_settings_from_json` is deprecated. We advise you use "</span>
        <span class="s2">"`linker.load_settings()` when loading in your settings or a previously "</span>
        <span class="s2">"trained model."</span><span class="p">,</span>
        <span class="n">SplinkDeprecated</span><span class="p">,</span>
        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.m_u_parameters_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">m_u_parameters_chart</span><span class="p">()</span></code>

<a href="#splink.linker.Linker.m_u_parameters_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Display a chart of the m and u parameters of the linkage model</p>



<p><strong>Examples:</strong></p>
    <p></p><div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">m_u_parameters_chart</span><span class="p">()</span>
</code></pre></div>
To view offline (if you don't have an internet connection):
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.charts</span> <span class="kn">import</span> <span class="n">save_offline_chart</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">match_weights_chart</span><span class="p">()</span>
<span class="n">save_offline_chart</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="s2">"test_chart.html"</span><span class="p">)</span>
</code></pre></div>
View resultant html file in Jupyter (or just load it in your browser)
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">"./test_chart.html"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span>
<span class="normal">3578</span>
<span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span>
<span class="normal">3588</span>
<span class="normal">3589</span>
<span class="normal">3590</span>
<span class="normal">3591</span>
<span class="normal">3592</span>
<span class="normal">3593</span>
<span class="normal">3594</span>
<span class="normal">3595</span>
<span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">m_u_parameters_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Display a chart of the m and u parameters of the linkage model</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.m_u_parameters_chart()</span>
<span class="sd">        ```</span>
<span class="sd">        To view offline (if you don't have an internet connection):</span>
<span class="sd">        ```py</span>
<span class="sd">        from splink.charts import save_offline_chart</span>
<span class="sd">        c = linker.match_weights_chart()</span>
<span class="sd">        save_offline_chart(c.to_dict(), "test_chart.html")</span>
<span class="sd">        ```</span>
<span class="sd">        View resultant html file in Jupyter (or just load it in your browser)</span>
<span class="sd">        ```py</span>
<span class="sd">        from IPython.display import IFrame</span>
<span class="sd">        IFrame(src="./test_chart.html", width=1000, height=500)</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">m_u_parameters_chart</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.match_weights_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">match_weights_chart</span><span class="p">()</span></code>

<a href="#splink.linker.Linker.match_weights_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Display a chart of the (partial) match weights of the linkage model</p>



<p><strong>Examples:</strong></p>
    <p></p><div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">match_weights_chart</span><span class="p">()</span>
</code></pre></div>
To view offline (if you don't have an internet connection):
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.charts</span> <span class="kn">import</span> <span class="n">save_offline_chart</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">match_weights_chart</span><span class="p">()</span>
<span class="n">save_offline_chart</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="s2">"test_chart.html"</span><span class="p">)</span>
</code></pre></div>
View resultant html file in Jupyter (or just load it in your browser)
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">"./test_chart.html"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span>
<span class="normal">3502</span>
<span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">match_weights_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Display a chart of the (partial) match weights of the linkage model</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.match_weights_chart()</span>
<span class="sd">        ```</span>
<span class="sd">        To view offline (if you don't have an internet connection):</span>
<span class="sd">        ```py</span>
<span class="sd">        from splink.charts import save_offline_chart</span>
<span class="sd">        c = linker.match_weights_chart()</span>
<span class="sd">        save_offline_chart(c.to_dict(), "test_chart.html")</span>
<span class="sd">        ```</span>
<span class="sd">        View resultant html file in Jupyter (or just load it in your browser)</span>
<span class="sd">        ```py</span>
<span class="sd">        from IPython.display import IFrame</span>
<span class="sd">        IFrame(src="./test_chart.html", width=1000, height=500)</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">match_weights_chart</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.match_weights_histogram" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">match_weights_histogram</span><span class="p">(</span><span class="n">df_predict</span><span class="p">,</span> <span class="n">target_bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.match_weights_histogram" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a histogram that shows the distribution of match weights in
<code>df_predict</code></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df_predict</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Output of <code>linker.predict()</code></p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>target_bins</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Target number of bins in histogram. Defaults to
30.</p>
            </div>
          </td>
          <td>
                <code>30</code>
          </td>
        </tr>
        <tr>
          <td><code>width</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of output. Defaults to 600.</p>
            </div>
          </td>
          <td>
                <code>600</code>
          </td>
        </tr>
        <tr>
          <td><code>height</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Height of output chart. Defaults to 250.</p>
            </div>
          </td>
          <td>
                <code>250</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3036</span>
<span class="normal">3037</span>
<span class="normal">3038</span>
<span class="normal">3039</span>
<span class="normal">3040</span>
<span class="normal">3041</span>
<span class="normal">3042</span>
<span class="normal">3043</span>
<span class="normal">3044</span>
<span class="normal">3045</span>
<span class="normal">3046</span>
<span class="normal">3047</span>
<span class="normal">3048</span>
<span class="normal">3049</span>
<span class="normal">3050</span>
<span class="normal">3051</span>
<span class="normal">3052</span>
<span class="normal">3053</span>
<span class="normal">3054</span>
<span class="normal">3055</span>
<span class="normal">3056</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">match_weights_histogram</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">:</span> <span class="n">SplinkDataFrame</span><span class="p">,</span> <span class="n">target_bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">250</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a histogram that shows the distribution of match weights in</span>
<span class="sd">    `df_predict`</span>

<span class="sd">    Args:</span>
<span class="sd">        df_predict (SplinkDataFrame): Output of `linker.predict()`</span>
<span class="sd">        target_bins (int, optional): Target number of bins in histogram. Defaults to</span>
<span class="sd">            30.</span>
<span class="sd">        width (int, optional): Width of output. Defaults to 600.</span>
<span class="sd">        height (int, optional): Height of output chart. Defaults to 250.</span>


<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>

<span class="sd">    """</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">histogram_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_predict</span><span class="p">,</span> <span class="n">target_bins</span><span class="p">)</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">match_weights_histogram</span><span class="p">(</span><span class="n">recs</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.missingness_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">missingness_chart</span><span class="p">(</span><span class="n">input_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.missingness_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a summary chart of the missingness (prevalence of nulls) of
columns in the input datasets.  By default, missingness is assessed across
all input datasets</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_dataset</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of one of the input tables in the
database.  If provided, missingness will be computed for
this table alone.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p></p><div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">missingness_chart</span><span class="p">()</span>
</code></pre></div>
To view offline (if you don't have an internet connection):
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.charts</span> <span class="kn">import</span> <span class="n">save_offline_chart</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">missingness_chart</span><span class="p">()</span>
<span class="n">save_offline_chart</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="s2">"test_chart.html"</span><span class="p">)</span>
</code></pre></div>
View resultant html file in Jupyter (or just load it in your browser)
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span>
<span class="n">IFrame</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="s2">"./test_chart.html"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3219</span>
<span class="normal">3220</span>
<span class="normal">3221</span>
<span class="normal">3222</span>
<span class="normal">3223</span>
<span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span>
<span class="normal">3228</span>
<span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span>
<span class="normal">3235</span>
<span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span>
<span class="normal">3239</span>
<span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span>
<span class="normal">3249</span>
<span class="normal">3250</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">missingness_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dataset</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a summary chart of the missingness (prevalence of nulls) of</span>
<span class="sd">    columns in the input datasets.  By default, missingness is assessed across</span>
<span class="sd">    all input datasets</span>

<span class="sd">    Args:</span>
<span class="sd">        input_dataset (str, optional): Name of one of the input tables in the</span>
<span class="sd">            database.  If provided, missingness will be computed for</span>
<span class="sd">            this table alone.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.missingness_chart()</span>
<span class="sd">        ```</span>
<span class="sd">        To view offline (if you don't have an internet connection):</span>
<span class="sd">        ```py</span>
<span class="sd">        from splink.charts import save_offline_chart</span>
<span class="sd">        c = linker.missingness_chart()</span>
<span class="sd">        save_offline_chart(c.to_dict(), "test_chart.html")</span>
<span class="sd">        ```</span>
<span class="sd">        View resultant html file in Jupyter (or just load it in your browser)</span>
<span class="sd">        ```py</span>
<span class="sd">        from IPython.display import IFrame</span>
<span class="sd">        IFrame(src="./test_chart.html", width=1000, height=500</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>
    <span class="n">records</span> <span class="o">=</span> <span class="n">missingness_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dataset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">missingness_chart</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.parameter_estimate_comparisons_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">parameter_estimate_comparisons_chart</span><span class="p">(</span><span class="n">include_m</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_u</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.parameter_estimate_comparisons_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Show a chart that shows how parameter estimates have differed across
the different estimation methods you have used.</p>
<p>For example, if you have run two EM estimation sessions, blocking on
different variables, and both result in parameter estimates for
first_name, this chart will enable easy comparison of the different
estimates</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>include_m</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Show different estimates of m values. Defaults
to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_u</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Show different estimates of u values. Defaults
to False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span>
<span class="normal">3195</span>
<span class="normal">3196</span>
<span class="normal">3197</span>
<span class="normal">3198</span>
<span class="normal">3199</span>
<span class="normal">3200</span>
<span class="normal">3201</span>
<span class="normal">3202</span>
<span class="normal">3203</span>
<span class="normal">3204</span>
<span class="normal">3205</span>
<span class="normal">3206</span>
<span class="normal">3207</span>
<span class="normal">3208</span>
<span class="normal">3209</span>
<span class="normal">3210</span>
<span class="normal">3211</span>
<span class="normal">3212</span>
<span class="normal">3213</span>
<span class="normal">3214</span>
<span class="normal">3215</span>
<span class="normal">3216</span>
<span class="normal">3217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parameter_estimate_comparisons_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">include_m</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_u</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Show a chart that shows how parameter estimates have differed across</span>
<span class="sd">    the different estimation methods you have used.</span>

<span class="sd">    For example, if you have run two EM estimation sessions, blocking on</span>
<span class="sd">    different variables, and both result in parameter estimates for</span>
<span class="sd">    first_name, this chart will enable easy comparison of the different</span>
<span class="sd">    estimates</span>

<span class="sd">    Args:</span>
<span class="sd">        include_m (bool, optional): Show different estimates of m values. Defaults</span>
<span class="sd">            to True.</span>
<span class="sd">        include_u (bool, optional): Show different estimates of u values. Defaults</span>
<span class="sd">            to False.</span>

<span class="sd">    """</span>
    <span class="n">records</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">_parameter_estimates_as_records</span>

    <span class="n">to_retain</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">include_m</span><span class="p">:</span>
        <span class="n">to_retain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"m"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_u</span><span class="p">:</span>
        <span class="n">to_retain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"u"</span><span class="p">)</span>

    <span class="n">records</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s2">"m_or_u"</span><span class="p">]</span> <span class="ow">in</span> <span class="n">to_retain</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">parameter_estimate_comparisons</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.precision_recall_chart_from_labels_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">precision_recall_chart_from_labels_column</span><span class="p">(</span><span class="n">labels_column_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.precision_recall_chart_from_labels_column" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a precision-recall chart from ground truth data, whereby the ground
truth is in a column in the input dataset called <code>labels_column_name</code></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_column_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Column name containing labels in the input table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the ROC chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">precision_recall_chart_from_labels_column</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_column_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a precision-recall chart from ground truth data, whereby the ground</span>
<span class="sd">    truth is in a column in the input dataset called `labels_column_name`</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_column_name (str): Column name containing labels in the input table</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the ROC chart. Defaults to None.</span>
<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.precision_recall_chart_from_labels_column("ground_truth")</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">precision_recall_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.precision_recall_chart_from_labels_table" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">precision_recall_chart_from_labels_table</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.precision_recall_chart_from_labels_table" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a precision-recall chart from labelled (ground truth) data.</p>
<p>The table of labels should be in the following format, and should be registered
as a table with your database:</p>
<table>
<thead>
<tr>
<th>source_dataset_l</th>
<th>unique_id_l</th>
<th>source_dataset_r</th>
<th>unique_id_r</th>
<th>clerical_match_score</th>
</tr>
</thead>
<tbody>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>2</td>
<td>0.99</td>
</tr>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>3</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>Note that <code>source_dataset</code> and <code>unique_id</code> should correspond to the values
specified in the settings dict, and the <code>input_table_aliases</code> passed to the
<code>linker</code> object.</p>
<p>For <code>dedupe_only</code> links, the <code>source_dataset</code> columns can be ommitted.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_splinkdataframe_or_table_name</code></td>
          <td>
                <code>str | <a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of table
containing labels in the database</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the ROC chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span>
<span class="normal">2561</span>
<span class="normal">2562</span>
<span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">precision_recall_chart_from_labels_table</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a precision-recall chart from labelled (ground truth) data.</span>

<span class="sd">    The table of labels should be in the following format, and should be registered</span>
<span class="sd">    as a table with your database:</span>

<span class="sd">    |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">    |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">    |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">    |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">    Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">    specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">    `linker` object.</span>

<span class="sd">    For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">            containing labels in the database</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the ROC chart. Defaults to None.</span>
<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">            linker.register_table(labels, "labels")</span>
<span class="sd">            linker.precision_recall_chart_from_labels_table("labels")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">            labels.createDataFrame("labels")</span>
<span class="sd">            linker.precision_recall_chart_from_labels_table("labels")</span>
<span class="sd">            ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>
    <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
        <span class="n">labels_splinkdataframe_or_table_name</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
    <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_tablename</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">precision_recall_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.predict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">threshold_match_probability</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">threshold_match_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">materialise_after_computing_term_frequencies</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.predict" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Create a dataframe of scored pairwise comparisons using the parameters
of the linkage model.</p>
<p>Uses the blocking rules specified in the
<code>blocking_rules_to_generate_predictions</code> of the settings dictionary to
generate the pairwise comparisons.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>threshold_match_probability</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If specified,
filter the results to include only pairwise comparisons with a
match_probability above this threshold. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold_match_weight</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If specified,
filter the results to include only pairwise comparisons with a
match_weight above this threshold. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>materialise_after_computing_term_frequencies</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If true, Splink
will materialise the table containing the input nodes (rows)
joined to any term frequencies which have been asked
for in the settings object.  If False, this will be
computed as part of one possibly gigantic CTE
pipeline.   Defaults to True</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="s2">"saved_settings.json"</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">threshold_match_probability</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">as_pandas_dataframe</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
      

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">threshold_match_probability</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">threshold_match_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">materialise_after_computing_term_frequencies</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Create a dataframe of scored pairwise comparisons using the parameters</span>
<span class="sd">    of the linkage model.</span>

<span class="sd">    Uses the blocking rules specified in the</span>
<span class="sd">    `blocking_rules_to_generate_predictions` of the settings dictionary to</span>
<span class="sd">    generate the pairwise comparisons.</span>

<span class="sd">    Args:</span>
<span class="sd">        threshold_match_probability (float, optional): If specified,</span>
<span class="sd">            filter the results to include only pairwise comparisons with a</span>
<span class="sd">            match_probability above this threshold. Defaults to None.</span>
<span class="sd">        threshold_match_weight (float, optional): If specified,</span>
<span class="sd">            filter the results to include only pairwise comparisons with a</span>
<span class="sd">            match_weight above this threshold. Defaults to None.</span>
<span class="sd">        materialise_after_computing_term_frequencies (bool): If true, Splink</span>
<span class="sd">            will materialise the table containing the input nodes (rows)</span>
<span class="sd">            joined to any term frequencies which have been asked</span>
<span class="sd">            for in the settings object.  If False, this will be</span>
<span class="sd">            computed as part of one possibly gigantic CTE</span>
<span class="sd">            pipeline.   Defaults to True</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker = DuckDBLinker(df)</span>
<span class="sd">        linker.load_settings("saved_settings.json")</span>
<span class="sd">        df = linker.predict(threshold_match_probability=0.95)</span>
<span class="sd">        df.as_pandas_dataframe(limit=5)</span>
<span class="sd">        ```</span>
<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame: A SplinkDataFrame of the pairwise comparisons.  This</span>
<span class="sd">            represents a table materialised in the database. Methods on the</span>
<span class="sd">            SplinkDataFrame allow you to access the underlying data.</span>

<span class="sd">    """</span>

    <span class="c1"># If materialise_after_computing_term_frequencies=False and the user only</span>
    <span class="c1"># calls predict, it runs as a single pipeline with no materialisation</span>
    <span class="c1"># of anything.</span>

    <span class="c1"># _initialise_df_concat_with_tf returns None if the table doesn't exist</span>
    <span class="c1"># and only SQL is queued in this step.</span>
    <span class="n">nodes_with_tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialise_df_concat_with_tf</span><span class="p">(</span>
        <span class="n">materialise</span><span class="o">=</span><span class="n">materialise_after_computing_term_frequencies</span>
    <span class="p">)</span>

    <span class="n">input_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">nodes_with_tf</span><span class="p">:</span>
        <span class="n">input_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nodes_with_tf</span><span class="p">)</span>

    <span class="c1"># If exploded blocking rules exist, we need to materialise</span>
    <span class="c1"># the tables of ID pairs</span>
    <span class="n">exploding_br_with_id_tables</span> <span class="o">=</span> <span class="n">materialise_exploded_id_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">sqls</span> <span class="o">=</span> <span class="n">block_using_rules_sqls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

    <span class="n">repartition_after_blocking</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"repartition_after_blocking"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

    <span class="c1"># repartition after blocking only exists on the SparkLinker</span>
    <span class="k">if</span> <span class="n">repartition_after_blocking</span><span class="p">:</span>
        <span class="n">df_blocked</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span><span class="n">input_dataframes</span><span class="p">)</span>
        <span class="n">input_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_blocked</span><span class="p">)</span>

    <span class="n">sql</span> <span class="o">=</span> <span class="n">compute_comparison_vector_values_sql</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="s2">"__splink__df_comparison_vectors"</span><span class="p">)</span>

    <span class="n">sqls</span> <span class="o">=</span> <span class="n">predict_from_comparison_vectors_sqls</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span>
        <span class="n">threshold_match_probability</span><span class="p">,</span>
        <span class="n">threshold_match_weight</span><span class="p">,</span>
        <span class="n">sql_infinity_expression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_infinity_expression</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">sql</span> <span class="ow">in</span> <span class="n">sqls</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enqueue_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">[</span><span class="s2">"sql"</span><span class="p">],</span> <span class="n">sql</span><span class="p">[</span><span class="s2">"output_table_name"</span><span class="p">])</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sql_pipeline</span><span class="p">(</span><span class="n">input_dataframes</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_predict_warning</span><span class="p">()</span>

    <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">drop_materialised_id_pairs_dataframe</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">exploding_br_with_id_tables</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.prediction_errors_from_labels_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prediction_errors_from_labels_column</span><span class="p">(</span><span class="n">label_colname</span><span class="p">,</span> <span class="n">include_false_positives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_false_negatives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.prediction_errors_from_labels_column" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a dataframe containing false positives and false negatives
based on the comparison between the splink match probability and the
labels column.  A label column is a column in the input dataset that contains
the 'ground truth' cluster to which the record belongs</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>label_colname</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of labels column in input data</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_false_positives</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_false_negatives</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Threshold above which a score is considered
to be a match. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table containing false positives and negatives</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3006</span>
<span class="normal">3007</span>
<span class="normal">3008</span>
<span class="normal">3009</span>
<span class="normal">3010</span>
<span class="normal">3011</span>
<span class="normal">3012</span>
<span class="normal">3013</span>
<span class="normal">3014</span>
<span class="normal">3015</span>
<span class="normal">3016</span>
<span class="normal">3017</span>
<span class="normal">3018</span>
<span class="normal">3019</span>
<span class="normal">3020</span>
<span class="normal">3021</span>
<span class="normal">3022</span>
<span class="normal">3023</span>
<span class="normal">3024</span>
<span class="normal">3025</span>
<span class="normal">3026</span>
<span class="normal">3027</span>
<span class="normal">3028</span>
<span class="normal">3029</span>
<span class="normal">3030</span>
<span class="normal">3031</span>
<span class="normal">3032</span>
<span class="normal">3033</span>
<span class="normal">3034</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prediction_errors_from_labels_column</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">label_colname</span><span class="p">,</span>
    <span class="n">include_false_positives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">include_false_negatives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a dataframe containing false positives and false negatives</span>
<span class="sd">    based on the comparison between the splink match probability and the</span>
<span class="sd">    labels column.  A label column is a column in the input dataset that contains</span>
<span class="sd">    the 'ground truth' cluster to which the record belongs</span>

<span class="sd">    Args:</span>
<span class="sd">        label_colname (str): Name of labels column in input data</span>
<span class="sd">        include_false_positives (bool, optional): Defaults to True.</span>
<span class="sd">        include_false_negatives (bool, optional): Defaults to True.</span>
<span class="sd">        threshold (float, optional): Threshold above which a score is considered</span>
<span class="sd">            to be a match. Defaults to 0.5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame:  Table containing false positives and negatives</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">prediction_errors_from_label_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">label_colname</span><span class="p">,</span>
        <span class="n">include_false_positives</span><span class="p">,</span>
        <span class="n">include_false_negatives</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.prediction_errors_from_labels_table" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prediction_errors_from_labels_table</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span> <span class="n">include_false_positives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_false_negatives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.prediction_errors_from_labels_table" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a dataframe containing false positives and false negatives
based on the comparison between the clerical_match_score in the labels
table compared with the splink predicted match probability</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_splinkdataframe_or_table_name</code></td>
          <td>
                <code>str | <a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of table
containing labels in the database</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>include_false_positives</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>include_false_negatives</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Defaults to True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>threshold</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Threshold above which a score is considered
to be a match. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table containing false positives and negatives</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span>
<span class="normal">2784</span>
<span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prediction_errors_from_labels_table</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
    <span class="n">include_false_positives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">include_false_negatives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a dataframe containing false positives and false negatives</span>
<span class="sd">    based on the comparison between the clerical_match_score in the labels</span>
<span class="sd">    table compared with the splink predicted match probability</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">            containing labels in the database</span>
<span class="sd">        include_false_positives (bool, optional): Defaults to True.</span>
<span class="sd">        include_false_negatives (bool, optional): Defaults to True.</span>
<span class="sd">        threshold (float, optional): Threshold above which a score is considered</span>
<span class="sd">            to be a match. Defaults to 0.5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame:  Table containing false positives and negatives</span>
<span class="sd">    """</span>
    <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
        <span class="n">labels_splinkdataframe_or_table_name</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">prediction_errors_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_tablename</span><span class="p">,</span>
        <span class="n">include_false_positives</span><span class="p">,</span>
        <span class="n">include_false_negatives</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.profile_columns" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">profile_columns</span><span class="p">(</span><span class="n">column_expressions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">bottom_n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.profile_columns" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Profiles the specified columns of the dataframe initiated with the linker.</p>
<p>This can be computationally expensive if the dataframe is large.</p>
<p>For the provided columns with column_expressions (or for all columns if
 left empty) calculate:
- A distribution plot that shows the count of values at each percentile.
- A top n chart, that produces a chart showing the count of the top n values
within the column
- A bottom n chart, that produces a chart showing the count of the bottom
n values within the column</p>
<p>This should be used to explore the dataframe, determine if columns have
sufficient completeness for linking, analyse the cardinality of columns, and
identify the need for standardisation within a given column.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>linker</code></td>
          <td>
                <code>object</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The initiated linker.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>column_expressions</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of strings containing the
specified column names.
If left empty this will default to all columns.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>top_n</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of top n values to plot.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>bottom_n</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of bottom n values to plot.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart or dict: A visualization or JSON specification describing the</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>profiling charts.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked id="splink.linker.Linker.profile_columns--__tabbed_1_1" name="splink.linker.Linker.profile_columns--__tabbed_1" type="radio"><input id="splink.linker.Linker.profile_columns--__tabbed_1_2" name="splink.linker.Linker.profile_columns--__tabbed_1" type="radio"><input id="splink.linker.Linker.profile_columns--__tabbed_1_3" name="splink.linker.Linker.profile_columns--__tabbed_1" type="radio"><input id="splink.linker.Linker.profile_columns--__tabbed_1_4" name="splink.linker.Linker.profile_columns--__tabbed_1" type="radio"><div class="tabbed-labels"><label for="splink.linker.Linker.profile_columns--__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 0C5.363 0 0 5.363 0 12s5.363 12 12 12 12-5.363 12-12S18.637 0 12 0zM9.502 7.03a4.974 4.974 0 0 1 4.97 4.97 4.974 4.974 0 0 1-4.97 4.97A4.974 4.974 0 0 1 4.532 12a4.974 4.974 0 0 1 4.97-4.97zm6.563 3.183h2.351c.98 0 1.787.782 1.787 1.762s-.807 1.789-1.787 1.789h-2.351v-3.551z"></path></svg></span> DuckDB</label><label for="splink.linker.Linker.profile_columns--__tabbed_1_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.593 3.593 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a551.9 551.9 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a4.874 4.874 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535c0 .023.002.045 0 .073-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098.349.117.697.231 1.045.347h.001c.02.012.045.02.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.783 2.783 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353.08 353.08 0 0 0-2.421-4.018 4.61 4.61 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.592.592 0 0 1 .189.211c.87 1.446 1.742 2.89 2.609 4.338.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217.367-.098.735-.193 1.103-.289a.399.399 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019c-.538-.18-1.077-.358-1.615-.539-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.398.398 0 0 1-.18.132c.035-.378.068-.757.104-1.136.149-1.572.297-3.144.451-4.716-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.595.595 0 0 1 .24-.134c1.797-.57 3.595-1.14 5.394-1.705.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441.241-1.363.483-2.726.726-4.088.068-.386.14-.771.21-1.157z"></path></svg></span> Spark</label><label for="splink.linker.Linker.profile_columns--__tabbed_1_3"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 0 1-.28.104.488.488 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167 4.577 4.577 0 0 1 1.005-.36 4.84 4.84 0 0 1 1.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144a1.78 1.78 0 0 0 .758-.51 1.27 1.27 0 0 0 .272-.512c.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.416-.287-.807-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926a2.157 2.157 0 0 1-.583.703c-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zm1.509 3.88c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zm1.094-1.246c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z"></path></svg></span> Athena</label><label for="splink.linker.Linker.profile_columns--__tabbed_1_4"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M21.678.521c-1.032-.92-2.28-.55-3.513.544a8.71 8.71 0 0 0-.547.535c-2.109 2.237-4.066 6.38-4.674 9.544.237.48.422 1.093.544 1.561a13.044 13.044 0 0 1 .164.703s-.019-.071-.096-.296l-.05-.146a1.689 1.689 0 0 0-.033-.08c-.138-.32-.518-.995-.686-1.289-.143.423-.27.818-.376 1.176.484.884.778 2.4.778 2.4s-.025-.099-.147-.442c-.107-.303-.644-1.244-.772-1.464-.217.804-.304 1.346-.226 1.478.152.256.296.698.422 1.186.286 1.1.485 2.44.485 2.44l.017.224a22.41 22.41 0 0 0 .056 2.748c.095 1.146.273 2.13.5 2.657l.155-.084c-.334-1.038-.47-2.399-.41-3.967.09-2.398.642-5.29 1.661-8.304 1.723-4.55 4.113-8.201 6.3-9.945-1.993 1.8-4.692 7.63-5.5 9.788-.904 2.416-1.545 4.684-1.931 6.857.666-2.037 2.821-2.912 2.821-2.912s1.057-1.304 2.292-3.166c-.74.169-1.955.458-2.362.629-.6.251-.762.337-.762.337s1.945-1.184 3.613-1.72C21.695 7.9 24.195 2.767 21.678.521m-18.573.543A1.842 1.842 0 0 0 1.27 2.9v16.608a1.84 1.84 0 0 0 1.835 1.834h9.418a22.953 22.953 0 0 1-.052-2.707c-.006-.062-.011-.141-.016-.2a27.01 27.01 0 0 0-.473-2.378c-.121-.47-.275-.898-.369-1.057-.116-.197-.098-.31-.097-.432 0-.12.015-.245.037-.386a9.98 9.98 0 0 1 .234-1.045l.217-.028c-.017-.035-.014-.065-.031-.097l-.041-.381a32.8 32.8 0 0 1 .382-1.194l.2-.019c-.008-.016-.01-.038-.018-.053l-.043-.316c.63-3.28 2.587-7.443 4.8-9.791.066-.069.133-.128.198-.194Z"></path></svg></span> SQLite</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">AthenaLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">()</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">SQLiteLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">profile_columns</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
</div>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The <code>linker</code> object should be an instance of the initiated linker.</li>
<li>The provided <code>column_expressions</code> can be a list of column names to
    profile. If left empty, all columns will be profiled.</li>
<li>The <code>top_n</code> and <code>bottom_n</code> parameters determine the number of top and
     bottom values to display in the respective charts.</li>
</ul>
</details>
          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">profile_columns</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">column_expressions</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">bottom_n</span><span class="o">=</span><span class="mi">10</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Profiles the specified columns of the dataframe initiated with the linker.</span>

<span class="sd">    This can be computationally expensive if the dataframe is large.</span>

<span class="sd">    For the provided columns with column_expressions (or for all columns if</span>
<span class="sd">     left empty) calculate:</span>
<span class="sd">    - A distribution plot that shows the count of values at each percentile.</span>
<span class="sd">    - A top n chart, that produces a chart showing the count of the top n values</span>
<span class="sd">    within the column</span>
<span class="sd">    - A bottom n chart, that produces a chart showing the count of the bottom</span>
<span class="sd">    n values within the column</span>

<span class="sd">    This should be used to explore the dataframe, determine if columns have</span>
<span class="sd">    sufficient completeness for linking, analyse the cardinality of columns, and</span>
<span class="sd">    identify the need for standardisation within a given column.</span>

<span class="sd">    Args:</span>
<span class="sd">        linker (object): The initiated linker.</span>
<span class="sd">        column_expressions (list, optional): A list of strings containing the</span>
<span class="sd">            specified column names.</span>
<span class="sd">            If left empty this will default to all columns.</span>
<span class="sd">        top_n (int, optional): The number of top n values to plot.</span>
<span class="sd">        bottom_n (int, optional): The number of bottom n values to plot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart or dict: A visualization or JSON specification describing the</span>
<span class="sd">        profiling charts.</span>

<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df)</span>
<span class="sd">            linker.profile_columns()</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = SparkLinker(df)</span>
<span class="sd">            linker.profile_columns()</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-amazonaws: Athena"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = AthenaLinker(df)</span>
<span class="sd">            linker.profile_columns()</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-sqlite: SQLite"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = SQLiteLinker(df)</span>
<span class="sd">            linker.profile_columns()</span>
<span class="sd">            ```</span>

<span class="sd">    Note:</span>
<span class="sd">        - The `linker` object should be an instance of the initiated linker.</span>
<span class="sd">        - The provided `column_expressions` can be a list of column names to</span>
<span class="sd">            profile. If left empty, all columns will be profiled.</span>
<span class="sd">        - The `top_n` and `bottom_n` parameters determine the number of top and</span>
<span class="sd">             bottom values to display in the respective charts.</span>
<span class="sd">    """</span>

    <span class="k">return</span> <span class="n">profile_columns</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column_expressions</span><span class="o">=</span><span class="n">column_expressions</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="n">top_n</span><span class="p">,</span> <span class="n">bottom_n</span><span class="o">=</span><span class="n">bottom_n</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.query_sql" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">query_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">'pandas'</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.query_sql" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Run a SQL query against your backend database and return
the resulting output.</p>



<p><strong>Examples:</strong></p>
    <div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked id="splink.linker.Linker.query_sql--__tabbed_1_1" name="splink.linker.Linker.query_sql--__tabbed_1" type="radio"><input id="splink.linker.Linker.query_sql--__tabbed_1_2" name="splink.linker.Linker.query_sql--__tabbed_1" type="radio"><input id="splink.linker.Linker.query_sql--__tabbed_1_3" name="splink.linker.Linker.query_sql--__tabbed_1" type="radio"><input id="splink.linker.Linker.query_sql--__tabbed_1_4" name="splink.linker.Linker.query_sql--__tabbed_1" type="radio"><div class="tabbed-labels"><label for="splink.linker.Linker.query_sql--__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 0C5.363 0 0 5.363 0 12s5.363 12 12 12 12-5.363 12-12S18.637 0 12 0zM9.502 7.03a4.974 4.974 0 0 1 4.97 4.97 4.974 4.974 0 0 1-4.97 4.97A4.974 4.974 0 0 1 4.532 12a4.974 4.974 0 0 1 4.97-4.97zm6.563 3.183h2.351c.98 0 1.787.782 1.787 1.762s-.807 1.789-1.787 1.789h-2.351v-3.551z"></path></svg></span> DuckDB</label><label for="splink.linker.Linker.query_sql--__tabbed_1_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.593 3.593 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a551.9 551.9 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a4.874 4.874 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535c0 .023.002.045 0 .073-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098.349.117.697.231 1.045.347h.001c.02.012.045.02.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.783 2.783 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353.08 353.08 0 0 0-2.421-4.018 4.61 4.61 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.592.592 0 0 1 .189.211c.87 1.446 1.742 2.89 2.609 4.338.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217.367-.098.735-.193 1.103-.289a.399.399 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019c-.538-.18-1.077-.358-1.615-.539-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.398.398 0 0 1-.18.132c.035-.378.068-.757.104-1.136.149-1.572.297-3.144.451-4.716-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.595.595 0 0 1 .24-.134c1.797-.57 3.595-1.14 5.394-1.705.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441.241-1.363.483-2.726.726-4.088.068-.386.14-.771.21-1.157z"></path></svg></span> Spark</label><label for="splink.linker.Linker.query_sql--__tabbed_1_3"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M6.763 10.036c0 .296.032.535.088.71.064.176.144.368.256.576.04.063.056.127.056.183 0 .08-.048.16-.152.24l-.503.335a.383.383 0 0 1-.208.072c-.08 0-.16-.04-.239-.112a2.47 2.47 0 0 1-.287-.375 6.18 6.18 0 0 1-.248-.471c-.622.734-1.405 1.101-2.347 1.101-.67 0-1.205-.191-1.596-.574-.391-.384-.59-.894-.59-1.533 0-.678.239-1.23.726-1.644.487-.415 1.133-.623 1.955-.623.272 0 .551.024.846.064.296.04.6.104.918.176v-.583c0-.607-.127-1.03-.375-1.277-.255-.248-.686-.367-1.3-.367-.28 0-.568.031-.863.103-.295.072-.583.16-.862.272a2.287 2.287 0 0 1-.28.104.488.488 0 0 1-.127.023c-.112 0-.168-.08-.168-.247v-.391c0-.128.016-.224.056-.28a.597.597 0 0 1 .224-.167 4.577 4.577 0 0 1 1.005-.36 4.84 4.84 0 0 1 1.246-.151c.95 0 1.644.216 2.091.647.439.43.662 1.085.662 1.963v2.586zm-3.24 1.214c.263 0 .534-.048.822-.144a1.78 1.78 0 0 0 .758-.51 1.27 1.27 0 0 0 .272-.512c.047-.191.08-.423.08-.694v-.335a6.66 6.66 0 0 0-.735-.136 6.02 6.02 0 0 0-.75-.048c-.535 0-.926.104-1.19.32-.263.215-.39.518-.39.917 0 .375.095.655.295.846.191.2.47.296.838.296zm6.41.862c-.144 0-.24-.024-.304-.08-.064-.048-.12-.16-.168-.311L7.586 5.55a1.398 1.398 0 0 1-.072-.32c0-.128.064-.2.191-.2h.783c.151 0 .255.025.31.08.065.048.113.16.16.312l1.342 5.284 1.245-5.284c.04-.16.088-.264.151-.312a.549.549 0 0 1 .32-.08h.638c.152 0 .256.025.32.08.063.048.12.16.151.312l1.261 5.348 1.381-5.348c.048-.16.104-.264.16-.312a.52.52 0 0 1 .311-.08h.743c.127 0 .2.065.2.2 0 .04-.009.08-.017.128a1.137 1.137 0 0 1-.056.2l-1.923 6.17c-.048.16-.104.263-.168.311a.51.51 0 0 1-.303.08h-.687c-.151 0-.255-.024-.32-.08-.063-.056-.119-.16-.15-.32l-1.238-5.148-1.23 5.14c-.04.16-.087.264-.15.32-.065.056-.177.08-.32.08zm10.256.215c-.415 0-.83-.048-1.229-.143-.399-.096-.71-.2-.918-.32-.128-.071-.215-.151-.247-.223a.563.563 0 0 1-.048-.224v-.407c0-.167.064-.247.183-.247.048 0 .096.008.144.024.048.016.12.048.2.08.271.12.566.215.878.279.319.064.63.096.95.096.502 0 .894-.088 1.165-.264a.86.86 0 0 0 .415-.758.777.777 0 0 0-.215-.559c-.144-.151-.416-.287-.807-.415l-1.157-.36c-.583-.183-1.014-.454-1.277-.813a1.902 1.902 0 0 1-.4-1.158c0-.335.073-.63.216-.886.144-.255.335-.479.575-.654.24-.184.51-.32.83-.415.32-.096.655-.136 1.006-.136.175 0 .359.008.535.032.183.024.35.056.518.088.16.04.312.08.455.127.144.048.256.096.336.144a.69.69 0 0 1 .24.2.43.43 0 0 1 .071.263v.375c0 .168-.064.256-.184.256a.83.83 0 0 1-.303-.096 3.652 3.652 0 0 0-1.532-.311c-.455 0-.815.071-1.062.223-.248.152-.375.383-.375.71 0 .224.08.416.24.567.159.152.454.304.877.44l1.134.358c.574.184.99.44 1.237.767.247.327.367.702.367 1.117 0 .343-.072.655-.207.926a2.157 2.157 0 0 1-.583.703c-.248.2-.543.343-.886.447-.36.111-.734.167-1.142.167zm1.509 3.88c-2.626 1.94-6.442 2.969-9.722 2.969-4.598 0-8.74-1.7-11.87-4.526-.247-.223-.024-.527.272-.351 3.384 1.963 7.559 3.153 11.877 3.153 2.914 0 6.114-.607 9.06-1.852.439-.2.814.287.383.607zm1.094-1.246c-.336-.43-2.22-.207-3.074-.103-.255.032-.295-.192-.063-.36 1.5-1.053 3.967-.75 4.254-.399.287.36-.08 2.826-1.485 4.007-.215.184-.423.088-.327-.151.32-.79 1.03-2.57.695-2.994z"></path></svg></span> Athena</label><label for="splink.linker.Linker.query_sql--__tabbed_1_4"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M21.678.521c-1.032-.92-2.28-.55-3.513.544a8.71 8.71 0 0 0-.547.535c-2.109 2.237-4.066 6.38-4.674 9.544.237.48.422 1.093.544 1.561a13.044 13.044 0 0 1 .164.703s-.019-.071-.096-.296l-.05-.146a1.689 1.689 0 0 0-.033-.08c-.138-.32-.518-.995-.686-1.289-.143.423-.27.818-.376 1.176.484.884.778 2.4.778 2.4s-.025-.099-.147-.442c-.107-.303-.644-1.244-.772-1.464-.217.804-.304 1.346-.226 1.478.152.256.296.698.422 1.186.286 1.1.485 2.44.485 2.44l.017.224a22.41 22.41 0 0 0 .056 2.748c.095 1.146.273 2.13.5 2.657l.155-.084c-.334-1.038-.47-2.399-.41-3.967.09-2.398.642-5.29 1.661-8.304 1.723-4.55 4.113-8.201 6.3-9.945-1.993 1.8-4.692 7.63-5.5 9.788-.904 2.416-1.545 4.684-1.931 6.857.666-2.037 2.821-2.912 2.821-2.912s1.057-1.304 2.292-3.166c-.74.169-1.955.458-2.362.629-.6.251-.762.337-.762.337s1.945-1.184 3.613-1.72C21.695 7.9 24.195 2.767 21.678.521m-18.573.543A1.842 1.842 0 0 0 1.27 2.9v16.608a1.84 1.84 0 0 0 1.835 1.834h9.418a22.953 22.953 0 0 1-.052-2.707c-.006-.062-.011-.141-.016-.2a27.01 27.01 0 0 0-.473-2.378c-.121-.47-.275-.898-.369-1.057-.116-.197-.098-.31-.097-.432 0-.12.015-.245.037-.386a9.98 9.98 0 0 1 .234-1.045l.217-.028c-.017-.035-.014-.065-.031-.097l-.041-.381a32.8 32.8 0 0 1 .382-1.194l.2-.019c-.008-.016-.01-.038-.018-.053l-.043-.316c.63-3.28 2.587-7.443 4.8-9.791.066-.069.133-.128.198-.194Z"></path></svg></span> SQLite</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="n">df_predict</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">linker</span><span class="o">.</span><span class="n">query_sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">"select * from </span><span class="si">{</span><span class="n">df_predict</span><span class="o">.</span><span class="n">physical_name</span><span class="si">}</span><span class="s2"> limit 10"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">SparkLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="n">df_predict</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">linker</span><span class="o">.</span><span class="n">query_sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">"select * from </span><span class="si">{</span><span class="n">df_predict</span><span class="o">.</span><span class="n">physical_name</span><span class="si">}</span><span class="s2"> limit 10"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">linker</span> <span class="o">=</span> <span class="n">AthenaLinker</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
<span class="n">df_predict</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>
<span class="n">linker</span><span class="o">.</span><span class="n">query_sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">"select * from </span><span class="si">{</span><span class="n">df_predict</span><span class="o">.</span><span class="n">physical_name</span><span class="si">}</span><span class="s2"> limit 10"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>```py
linker = SQLiteLinker(df, settings)
df_predict = linker.predict()
linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</p>
</div>
</div>
</div>
<p>```</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sql</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The SQL to be queried.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>output_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>One of splink_df/splinkdf or pandas.
This determines the type of table that your results are output in.</p>
            </div>
          </td>
          <td>
                <code>'pandas'</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">query_sql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s2">"pandas"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Run a SQL query against your backend database and return</span>
<span class="sd">    the resulting output.</span>

<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = DuckDBLinker(df, settings)</span>
<span class="sd">            df_predict = linker.predict()</span>
<span class="sd">            linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = SparkLinker(df, settings)</span>
<span class="sd">            df_predict = linker.predict()</span>
<span class="sd">            linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-amazonaws: Athena"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = AthenaLinker(df, settings)</span>
<span class="sd">            df_predict = linker.predict()</span>
<span class="sd">            linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-sqlite: SQLite"</span>
<span class="sd">            ```py</span>
<span class="sd">            linker = SQLiteLinker(df, settings)</span>
<span class="sd">            df_predict = linker.predict()</span>
<span class="sd">            linker.query_sql(f"select * from {df_predict.physical_name} limit 10")</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        sql (str): The SQL to be queried.</span>
<span class="sd">        output_type (str): One of splink_df/splinkdf or pandas.</span>
<span class="sd">            This determines the type of table that your results are output in.</span>
<span class="sd">    """</span>

    <span class="n">output_tablename_templated</span> <span class="o">=</span> <span class="s2">"__splink__df_sql_query"</span>

    <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sql_to_splink_dataframe_checking_cache</span><span class="p">(</span>
        <span class="n">sql</span><span class="p">,</span>
        <span class="n">output_tablename_templated</span><span class="p">,</span>
        <span class="n">use_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">output_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"splink_df"</span><span class="p">,</span> <span class="s2">"splinkdf"</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">splink_dataframe</span>
    <span class="k">elif</span> <span class="n">output_type</span> <span class="o">==</span> <span class="s2">"pandas"</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">as_pandas_dataframe</span><span class="p">()</span>
        <span class="c1"># If pandas, drop the table to cleanup the db</span>
        <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">drop_table_from_database_and_remove_from_cache</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">out</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"output_type '</span><span class="si">{</span><span class="n">output_type</span><span class="si">}</span><span class="s2">' is not supported."</span><span class="p">,</span>
            <span class="s2">"Must be one of 'splink_df'/'splinkdf' or 'pandas'"</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.register_table" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">register_table</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.register_table" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Register a table to your backend database, to be used in one of the
splink methods, or simply to allow querying.</p>
<p>Tables can be of type: dictionary, record level dictionary,
pandas dataframe, pyarrow table and in the spark case, a spark df.</p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">test_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="p">[</span><span class="mi">666</span><span class="p">,</span><span class="mi">777</span><span class="p">,</span><span class="mi">888</span><span class="p">],</span><span class="s2">"b"</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]}</span>
<span class="n">linker</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span><span class="n">test_dict</span><span class="p">,</span> <span class="s2">"test_dict"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">query_sql</span><span class="p">(</span><span class="s2">"select * from test_dict"</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data you wish to register. This can be either a dictionary,
pandas dataframe, pyarrow table or a spark dataframe.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>table_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name you wish to assign to the table.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>overwrite</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Overwrite the table in the underlying database if it
exists</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An abstraction representing the table created by the sql
pipeline</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">register_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Register a table to your backend database, to be used in one of the</span>
<span class="sd">    splink methods, or simply to allow querying.</span>

<span class="sd">    Tables can be of type: dictionary, record level dictionary,</span>
<span class="sd">    pandas dataframe, pyarrow table and in the spark case, a spark df.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        test_dict = {"a": [666,777,888],"b": [4,5,6]}</span>
<span class="sd">        linker.register_table(test_dict, "test_dict")</span>
<span class="sd">        linker.query_sql("select * from test_dict")</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        input: The data you wish to register. This can be either a dictionary,</span>
<span class="sd">            pandas dataframe, pyarrow table or a spark dataframe.</span>
<span class="sd">        table_name (str): The name you wish to assign to the table.</span>
<span class="sd">        overwrite (bool): Overwrite the table in the underlying database if it</span>
<span class="sd">            exists</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame: An abstraction representing the table created by the sql</span>
<span class="sd">            pipeline</span>
<span class="sd">    """</span>

    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"register_table not implemented for </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.register_table_input_nodes_concat_with_tf" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">register_table_input_nodes_concat_with_tf</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.register_table_input_nodes_concat_with_tf" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Register a pre-computed version of the input_nodes_concat_with_tf table that
you want to re-use e.g. that you created in a previous run</p>
<p>This method allowed you to register this table in the Splink cache
so it will be used rather than Splink computing this table anew.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_data</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The data you wish to register. This can be either a dictionary,
pandas dataframe, pyarrow table or a spark dataframe.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>overwrite</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Overwrite the table in the underlying database if it
exists</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3822</span>
<span class="normal">3823</span>
<span class="normal">3824</span>
<span class="normal">3825</span>
<span class="normal">3826</span>
<span class="normal">3827</span>
<span class="normal">3828</span>
<span class="normal">3829</span>
<span class="normal">3830</span>
<span class="normal">3831</span>
<span class="normal">3832</span>
<span class="normal">3833</span>
<span class="normal">3834</span>
<span class="normal">3835</span>
<span class="normal">3836</span>
<span class="normal">3837</span>
<span class="normal">3838</span>
<span class="normal">3839</span>
<span class="normal">3840</span>
<span class="normal">3841</span>
<span class="normal">3842</span>
<span class="normal">3843</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">register_table_input_nodes_concat_with_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Register a pre-computed version of the input_nodes_concat_with_tf table that</span>
<span class="sd">    you want to re-use e.g. that you created in a previous run</span>

<span class="sd">    This method allowed you to register this table in the Splink cache</span>
<span class="sd">    so it will be used rather than Splink computing this table anew.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_data: The data you wish to register. This can be either a dictionary,</span>
<span class="sd">            pandas dataframe, pyarrow table or a spark dataframe.</span>
<span class="sd">        overwrite (bool): Overwrite the table in the underlying database if it</span>
<span class="sd">            exists</span>
<span class="sd">    """</span>

    <span class="n">table_name_physical</span> <span class="o">=</span> <span class="s2">"__splink__df_concat_with_tf_"</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_uid</span>
    <span class="n">splink_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span>
        <span class="n">input_data</span><span class="p">,</span> <span class="n">table_name_physical</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span>
    <span class="p">)</span>
    <span class="n">splink_dataframe</span><span class="o">.</span><span class="n">templated_name</span> <span class="o">=</span> <span class="s2">"__splink__df_concat_with_tf"</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_intermediate_table_cache</span><span class="p">[</span><span class="s2">"__splink__df_concat_with_tf"</span><span class="p">]</span> <span class="o">=</span> <span class="n">splink_dataframe</span>
    <span class="k">return</span> <span class="n">splink_dataframe</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.roc_chart_from_labels_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">roc_chart_from_labels_column</span><span class="p">(</span><span class="n">labels_column_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.roc_chart_from_labels_column" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a ROC chart from ground truth data, whereby the ground truth
is in a column in the input dataset called <code>labels_column_name</code></p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_column_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Column name containing labels in the input table</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the ROC chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">roc_chart_from_labels_column</span><span class="p">(</span><span class="s2">"labels"</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">roc_chart_from_labels_column</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_column_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a ROC chart from ground truth data, whereby the ground truth</span>
<span class="sd">    is in a column in the input dataset called `labels_column_name`</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_column_name (str): Column name containing labels in the input table</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the ROC chart. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.roc_chart_from_labels_column("labels")</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_column_name</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">roc_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.roc_chart_from_labels_table" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">roc_chart_from_labels_table</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.roc_chart_from_labels_table" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate a ROC chart from labelled (ground truth) data.</p>
<p>The table of labels should be in the following format, and should be registered
with your database:</p>
<table>
<thead>
<tr>
<th>source_dataset_l</th>
<th>unique_id_l</th>
<th>source_dataset_r</th>
<th>unique_id_r</th>
<th>clerical_match_score</th>
</tr>
</thead>
<tbody>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>2</td>
<td>0.99</td>
</tr>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>3</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>Note that <code>source_dataset</code> and <code>unique_id</code> should correspond to the values
specified in the settings dict, and the <code>input_table_aliases</code> passed to the
<code>linker</code> object.</p>
<p>For <code>dedupe_only</code> links, the <code>source_dataset</code> columns can be ommitted.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_splinkdataframe_or_table_name</code></td>
          <td>
                <code>str | <a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of table
containing labels in the database</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the ROC chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="splink.linker.Linker.roc_chart_from_labels_table--__tabbed_1_1" name="splink.linker.Linker.roc_chart_from_labels_table--__tabbed_1" type="radio"><input id="splink.linker.Linker.roc_chart_from_labels_table--__tabbed_1_2" name="splink.linker.Linker.roc_chart_from_labels_table--__tabbed_1" type="radio"><div class="tabbed-labels"><label for="splink.linker.Linker.roc_chart_from_labels_table--__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 0C5.363 0 0 5.363 0 12s5.363 12 12 12 12-5.363 12-12S18.637 0 12 0zM9.502 7.03a4.974 4.974 0 0 1 4.97 4.97 4.974 4.974 0 0 1-4.97 4.97A4.974 4.974 0 0 1 4.532 12a4.974 4.974 0 0 1 4.97-4.97zm6.563 3.183h2.351c.98 0 1.787.782 1.787 1.762s-.807 1.789-1.787 1.789h-2.351v-3.551z"></path></svg></span> DuckDB</label><label for="splink.linker.Linker.roc_chart_from_labels_table--__tabbed_1_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.593 3.593 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a551.9 551.9 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a4.874 4.874 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535c0 .023.002.045 0 .073-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098.349.117.697.231 1.045.347h.001c.02.012.045.02.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.783 2.783 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353.08 353.08 0 0 0-2.421-4.018 4.61 4.61 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.592.592 0 0 1 .189.211c.87 1.446 1.742 2.89 2.609 4.338.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217.367-.098.735-.193 1.103-.289a.399.399 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019c-.538-.18-1.077-.358-1.615-.539-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.398.398 0 0 1-.18.132c.035-.378.068-.757.104-1.136.149-1.572.297-3.144.451-4.716-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.595.595 0 0 1 .24-.134c1.797-.57 3.595-1.14 5.394-1.705.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441.241-1.363.483-2.726.726-4.088.068-.386.14-.771.21-1.157z"></path></svg></span> Spark</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"my_labels.csv"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="s2">"labels"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">roc_chart_from_labels_table</span><span class="p">(</span><span class="s2">"labels"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">labels</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">"my_labels.csv"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">labels</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="s2">"labels"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">roc_chart_from_labels_table</span><span class="p">(</span><span class="s2">"labels"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">roc_chart_from_labels_table</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">SplinkDataFrame</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate a ROC chart from labelled (ground truth) data.</span>

<span class="sd">    The table of labels should be in the following format, and should be registered</span>
<span class="sd">    with your database:</span>

<span class="sd">    |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">    |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">    |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">    |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">    Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">    specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">    `linker` object.</span>

<span class="sd">    For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">            containing labels in the database</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the ROC chart. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">            linker.register_table(labels, "labels")</span>
<span class="sd">            linker.roc_chart_from_labels_table("labels")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">            labels.createDataFrame("labels")</span>
<span class="sd">            linker.roc_chart_from_labels_table("labels")</span>
<span class="sd">            ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>
    <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
        <span class="n">labels_splinkdataframe_or_table_name</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
    <span class="n">df_truth_space</span> <span class="o">=</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_tablename</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="n">df_truth_space</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">roc_chart</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.save_model_to_json" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save_model_to_json</span><span class="p">(</span><span class="n">out_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.save_model_to_json" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Save the configuration and parameters of the linkage model to a <code>.json</code> file.</p>
<p>The model can later be loaded back in using <code>linker.load_model()</code>.
The settings dict is also returned in case you want to save it a different way.</p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">save_model_to_json</span><span class="p">(</span><span class="s2">"my_settings.json"</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
      



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The settings as a dictionary.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3668</span>
<span class="normal">3669</span>
<span class="normal">3670</span>
<span class="normal">3671</span>
<span class="normal">3672</span>
<span class="normal">3673</span>
<span class="normal">3674</span>
<span class="normal">3675</span>
<span class="normal">3676</span>
<span class="normal">3677</span>
<span class="normal">3678</span>
<span class="normal">3679</span>
<span class="normal">3680</span>
<span class="normal">3681</span>
<span class="normal">3682</span>
<span class="normal">3683</span>
<span class="normal">3684</span>
<span class="normal">3685</span>
<span class="normal">3686</span>
<span class="normal">3687</span>
<span class="normal">3688</span>
<span class="normal">3689</span>
<span class="normal">3690</span>
<span class="normal">3691</span>
<span class="normal">3692</span>
<span class="normal">3693</span>
<span class="normal">3694</span>
<span class="normal">3695</span>
<span class="normal">3696</span>
<span class="normal">3697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_model_to_json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Save the configuration and parameters of the linkage model to a `.json` file.</span>

<span class="sd">    The model can later be loaded back in using `linker.load_model()`.</span>
<span class="sd">    The settings dict is also returned in case you want to save it a different way.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.save_model_to_json("my_settings.json", overwrite=True)</span>
<span class="sd">        ```</span>
<span class="sd">    Args:</span>
<span class="sd">        out_path (str, optional): File path for json file. If None, don't save to</span>
<span class="sd">            file. Defaults to None.</span>
<span class="sd">        overwrite (bool, optional): Overwrite if already exists? Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The settings as a dictionary.</span>
<span class="sd">    """</span>
    <span class="n">model_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">out_path</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">out_path</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"The path </span><span class="si">{</span><span class="n">out_path</span><span class="si">}</span><span class="s2"> already exists. Please provide a different "</span>
                <span class="s2">"path or set overwrite=True"</span>
            <span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model_dict</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model_dict</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.save_settings_to_json" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">save_settings_to_json</span><span class="p">(</span><span class="n">out_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.save_settings_to_json" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>This function is deprecated. Use save_model_to_json() instead.</p>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3699</span>
<span class="normal">3700</span>
<span class="normal">3701</span>
<span class="normal">3702</span>
<span class="normal">3703</span>
<span class="normal">3704</span>
<span class="normal">3705</span>
<span class="normal">3706</span>
<span class="normal">3707</span>
<span class="normal">3708</span>
<span class="normal">3709</span>
<span class="normal">3710</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">save_settings_to_json</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    This function is deprecated. Use save_model_to_json() instead.</span>
<span class="sd">    """</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">"This function is deprecated. Use save_model_to_json() instead."</span><span class="p">,</span>
        <span class="n">SplinkDeprecated</span><span class="p">,</span>
        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_model_to_json</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.tf_adjustment_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">tf_adjustment_chart</span><span class="p">(</span><span class="n">output_column_name</span><span class="p">,</span> <span class="n">n_most_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_least_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">vals_to_include</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.tf_adjustment_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Display a chart showing the impact of term frequency adjustments on a
specific comparison level.
Each value</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output_column_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of an output column for which term frequency
 adjustment has been applied.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>n_most_freq</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of most frequent values to show. If this
 or <code>n_least_freq</code> set to None, all values will be shown.
Default to 10.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>n_least_freq</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of least frequent values to show. If
this or <code>n_most_freq</code> set to None, all values will be shown.
Default to 10.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr>
          <td><code>vals_to_include</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Specific values for which to show term
sfrequency adjustments.
Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tf_adjustment_chart</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">output_column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">n_most_freq</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">n_least_freq</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">vals_to_include</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Display a chart showing the impact of term frequency adjustments on a</span>
<span class="sd">    specific comparison level.</span>
<span class="sd">    Each value</span>

<span class="sd">    Args:</span>
<span class="sd">        output_column_name (str): Name of an output column for which term frequency</span>
<span class="sd">             adjustment has been applied.</span>
<span class="sd">        n_most_freq (int, optional): Number of most frequent values to show. If this</span>
<span class="sd">             or `n_least_freq` set to None, all values will be shown.</span>
<span class="sd">            Default to 10.</span>
<span class="sd">        n_least_freq (int, optional): Number of least frequent values to show. If</span>
<span class="sd">            this or `n_most_freq` set to None, all values will be shown.</span>
<span class="sd">            Default to 10.</span>
<span class="sd">        vals_to_include (list, optional): Specific values for which to show term</span>
<span class="sd">            sfrequency adjustments.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="c1"># Comparisons with TF adjustments</span>
    <span class="n">tf_comparisons</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">c</span><span class="o">.</span><span class="n">_output_column_name</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="o">.</span><span class="n">comparisons</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">cl</span><span class="o">.</span><span class="n">_has_tf_adjustments</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">comparison_levels</span><span class="p">])</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">output_column_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tf_comparisons</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">output_column_name</span><span class="si">}</span><span class="s2"> is not a valid comparison column, or does not"</span>
            <span class="sa">f</span><span class="s2">" have term frequency adjustment activated"</span>
        <span class="p">)</span>

    <span class="n">vals_to_include</span> <span class="o">=</span> <span class="n">ensure_is_list</span><span class="p">(</span><span class="n">vals_to_include</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tf_adjustment_chart</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output_column_name</span><span class="p">,</span>
        <span class="n">n_most_freq</span><span class="p">,</span>
        <span class="n">n_least_freq</span><span class="p">,</span>
        <span class="n">vals_to_include</span><span class="p">,</span>
        <span class="n">as_dict</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.truth_space_table_from_labels_column" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">truth_space_table_from_labels_column</span><span class="p">(</span><span class="n">labels_column_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.truth_space_table_from_labels_column" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate truth statistics (false positive etc.) for each threshold value of
match_probability, suitable for plotting a ROC chart.</p>
<p>Your labels_column_name should include the ground truth cluster (unique
identifier) that groups entities which are the same</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_tablename</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of table containing labels in the database</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the ROC chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">linker</span><span class="o">.</span><span class="n">truth_space_table_from_labels_column</span><span class="p">(</span><span class="s2">"cluster"</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>SplinkDataFrame</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Table of truth statistics</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">truth_space_table_from_labels_column</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_column_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate truth statistics (false positive etc.) for each threshold value of</span>
<span class="sd">    match_probability, suitable for plotting a ROC chart.</span>

<span class="sd">    Your labels_column_name should include the ground truth cluster (unique</span>
<span class="sd">    identifier) that groups entities which are the same</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_tablename (str): Name of table containing labels in the database</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the ROC chart. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        linker.truth_space_table_from_labels_column("cluster")</span>
<span class="sd">        ```</span>

<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame:  Table of truth statistics</span>
<span class="sd">    """</span>

    <span class="k">return</span> <span class="n">truth_space_table_from_labels_column</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">labels_column_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.truth_space_table_from_labels_table" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">truth_space_table_from_labels_table</span><span class="p">(</span><span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span> <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.truth_space_table_from_labels_table" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate truth statistics (false positive etc.) for each threshold value of
match_probability, suitable for plotting a ROC chart.</p>
<p>The table of labels should be in the following format, and should be registered
with your database:</p>
<table>
<thead>
<tr>
<th>source_dataset_l</th>
<th>unique_id_l</th>
<th>source_dataset_r</th>
<th>unique_id_r</th>
<th>clerical_match_score</th>
</tr>
</thead>
<tbody>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>2</td>
<td>0.99</td>
</tr>
<tr>
<td>df_1</td>
<td>1</td>
<td>df_2</td>
<td>3</td>
<td>0.2</td>
</tr>
</tbody>
</table>
<p>Note that <code>source_dataset</code> and <code>unique_id</code> should correspond to the values
specified in the settings dict, and the <code>input_table_aliases</code> passed to the
<code>linker</code> object.</p>
<p>For <code>dedupe_only</code> links, the <code>source_dataset</code> columns can be ommitted.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels_splinkdataframe_or_table_name</code></td>
          <td>
                <code>str | <a class="autorefs autorefs-internal" title="splink.splink_dataframe.SplinkDataFrame" href="SplinkDataFrame.html#splink.splink_dataframe.SplinkDataFrame">SplinkDataFrame</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of table
containing labels in the database</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>threshold_actual</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Where the <code>clerical_match_score</code>
provided by the user is a probability rather than binary, this value
is used as the threshold to classify <code>clerical_match_score</code>s as binary
matches or non matches. Defaults to 0.5.</p>
            </div>
          </td>
          <td>
                <code>0.5</code>
          </td>
        </tr>
        <tr>
          <td><code>match_weight_round_to_nearest</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When provided, thresholds
are rounded.  When large numbers of labels are provided, this is
sometimes necessary to reduce the size of the ROC table, and therefore
the number of points plotted on the ROC chart. Defaults to None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked id="splink.linker.Linker.truth_space_table_from_labels_table--__tabbed_1_1" name="splink.linker.Linker.truth_space_table_from_labels_table--__tabbed_1" type="radio"><input id="splink.linker.Linker.truth_space_table_from_labels_table--__tabbed_1_2" name="splink.linker.Linker.truth_space_table_from_labels_table--__tabbed_1" type="radio"><div class="tabbed-labels"><label for="splink.linker.Linker.truth_space_table_from_labels_table--__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 0C5.363 0 0 5.363 0 12s5.363 12 12 12 12-5.363 12-12S18.637 0 12 0zM9.502 7.03a4.974 4.974 0 0 1 4.97 4.97 4.974 4.974 0 0 1-4.97 4.97A4.974 4.974 0 0 1 4.532 12a4.974 4.974 0 0 1 4.97-4.97zm6.563 3.183h2.351c.98 0 1.787.782 1.787 1.762s-.807 1.789-1.787 1.789h-2.351v-3.551z"></path></svg></span> DuckDB</label><label for="splink.linker.Linker.truth_space_table_from_labels_table--__tabbed_1_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10.812 0c-.425.013-.845.215-1.196.605a3.593 3.593 0 0 0-.493.722c-.355.667-.425 1.415-.556 2.143a551.9 551.9 0 0 0-.726 4.087c-.027.16-.096.227-.244.273C5.83 8.386 4.06 8.94 2.3 9.514a4.874 4.874 0 0 0-1.114.506c-1.042.665-1.196 1.753-.415 2.71.346.422.79.715 1.284.936 1.1.49 2.202.976 3.3 1.47.019.01.036.013.053.019h-.004l1.306.535c0 .023.002.045 0 .073-.2 2.03-.39 4.063-.58 6.095-.04.419-.012.831.134 1.23.317.87 1.065 1.148 1.881.701.372-.204.666-.497.937-.818 1.372-1.623 2.746-3.244 4.113-4.872.111-.133.205-.15.363-.098.349.117.697.231 1.045.347h.001c.02.012.045.02.073.03l.142.042c1.248.416 2.68.775 3.929 1.19.4.132.622.164 1.045.098.311-.048.592-.062.828-.236.602-.33.995-.957.988-1.682-.005-.427-.154-.813-.35-1.186-.82-1.556-1.637-3.113-2.461-4.666-.078-.148-.076-.243.037-.375 1.381-1.615 2.756-3.236 4.133-4.855.272-.32.513-.658.653-1.058.308-.878-.09-1.57-1-1.741a2.783 2.783 0 0 0-1.235.069c-1.974.521-3.947 1.041-5.918 1.57-.175.047-.26.015-.355-.144a353.08 353.08 0 0 0-2.421-4.018 4.61 4.61 0 0 0-.652-.849c-.371-.37-.802-.549-1.227-.536zm.172 3.703a.592.592 0 0 1 .189.211c.87 1.446 1.742 2.89 2.609 4.338.07.118.135.16.277.121 1.525-.41 3.052-.813 4.579-1.217.367-.098.735-.193 1.103-.289a.399.399 0 0 1-.1.2c-1.259 1.48-2.516 2.962-3.779 4.438-.11.13-.12.22-.04.37.937 1.803 1.768 3.309 2.498 4.76l-3.696-1.019c-.538-.18-1.077-.358-1.615-.539-.163-.055-.25-.03-.36.1-1.248 1.488-2.504 2.97-3.759 4.454a.398.398 0 0 1-.18.132c.035-.378.068-.757.104-1.136.149-1.572.297-3.144.451-4.716-.03-.318.117-.405-.322-.545-1.493-.593-3.346-1.321-4.816-1.905a.595.595 0 0 1 .24-.134c1.797-.57 3.595-1.14 5.394-1.705.127-.04.199-.092.211-.233.013-.148.05-.294.076-.441.241-1.363.483-2.726.726-4.088.068-.386.14-.771.21-1.157z"></path></svg></span> Spark</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"my_labels.csv"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">register_table</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="s2">"labels"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">truth_space_table_from_labels_table</span><span class="p">(</span><span class="s2">"labels"</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">labels</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">"my_labels.csv"</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">labels</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="s2">"labels"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">truth_space_table_from_labels_table</span><span class="p">(</span><span class="s2">"labels"</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
      

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">truth_space_table_from_labels_table</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">labels_splinkdataframe_or_table_name</span><span class="p">,</span>
    <span class="n">threshold_actual</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">match_weight_round_to_nearest</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplinkDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Generate truth statistics (false positive etc.) for each threshold value of</span>
<span class="sd">    match_probability, suitable for plotting a ROC chart.</span>

<span class="sd">    The table of labels should be in the following format, and should be registered</span>
<span class="sd">    with your database:</span>

<span class="sd">    |source_dataset_l|unique_id_l|source_dataset_r|unique_id_r|clerical_match_score|</span>
<span class="sd">    |----------------|-----------|----------------|-----------|--------------------|</span>
<span class="sd">    |df_1            |1          |df_2            |2          |0.99                |</span>
<span class="sd">    |df_1            |1          |df_2            |3          |0.2                 |</span>

<span class="sd">    Note that `source_dataset` and `unique_id` should correspond to the values</span>
<span class="sd">    specified in the settings dict, and the `input_table_aliases` passed to the</span>
<span class="sd">    `linker` object.</span>

<span class="sd">    For `dedupe_only` links, the `source_dataset` columns can be ommitted.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels_splinkdataframe_or_table_name (str | SplinkDataFrame): Name of table</span>
<span class="sd">            containing labels in the database</span>
<span class="sd">        threshold_actual (float, optional): Where the `clerical_match_score`</span>
<span class="sd">            provided by the user is a probability rather than binary, this value</span>
<span class="sd">            is used as the threshold to classify `clerical_match_score`s as binary</span>
<span class="sd">            matches or non matches. Defaults to 0.5.</span>
<span class="sd">        match_weight_round_to_nearest (float, optional): When provided, thresholds</span>
<span class="sd">            are rounded.  When large numbers of labels are provided, this is</span>
<span class="sd">            sometimes necessary to reduce the size of the ROC table, and therefore</span>
<span class="sd">            the number of points plotted on the ROC chart. Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        === ":simple-duckdb: DuckDB"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = pd.read_csv("my_labels.csv")</span>
<span class="sd">            linker.register_table(labels, "labels")</span>
<span class="sd">            linker.truth_space_table_from_labels_table("labels")</span>
<span class="sd">            ```</span>
<span class="sd">        === ":simple-apachespark: Spark"</span>
<span class="sd">            ```py</span>
<span class="sd">            labels = spark.read.csv("my_labels.csv", header=True)</span>
<span class="sd">            labels.createDataFrame("labels")</span>
<span class="sd">            linker.truth_space_table_from_labels_table("labels")</span>
<span class="sd">            ```</span>
<span class="sd">    Returns:</span>
<span class="sd">        SplinkDataFrame:  Table of truth statistics</span>
<span class="sd">    """</span>
    <span class="n">labels_tablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_labels_tablename_from_input</span><span class="p">(</span>
        <span class="n">labels_splinkdataframe_or_table_name</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_accuracy_columns_not_computed</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">truth_space_table_from_labels_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels_tablename</span><span class="p">,</span>
        <span class="n">threshold_actual</span><span class="o">=</span><span class="n">threshold_actual</span><span class="p">,</span>
        <span class="n">match_weight_round_to_nearest</span><span class="o">=</span><span class="n">match_weight_round_to_nearest</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.unlinkables_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">unlinkables_chart</span><span class="p">(</span><span class="n">x_col</span><span class="o">=</span><span class="s1">'match_weight'</span><span class="p">,</span> <span class="n">source_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.unlinkables_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Generate an interactive chart displaying the proportion of records that
are "unlinkable" for a given splink score threshold and model parameters.</p>
<p>Unlinkable records are those that, even when compared with themselves, do not
contain enough information to confirm a match.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_col</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Column to use for the x-axis.
Defaults to "match_weight".</p>
            </div>
          </td>
          <td>
                <code>'match_weight'</code>
          </td>
        </tr>
        <tr>
          <td><code>source_dataset</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the source dataset to use for
the title of the output chart.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>as_dict</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, return a dict version of the chart.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



<p><strong>Examples:</strong></p>
    <p>For the simplest code pipeline, load a pre-trained model
and run this against the test data.
</p><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">splink.datasets</span> <span class="kn">import</span> <span class="n">splink_datasets</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">splink_datasets</span><span class="o">.</span><span class="n">fake_1000</span>
<span class="n">linker</span> <span class="o">=</span> <span class="n">DuckDBLinker</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">load_settings</span><span class="p">(</span><span class="s2">"saved_settings.json"</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">unlinkables_chart</span><span class="p">()</span>
</code></pre></div>
For more complex code pipelines, you can run an entire pipeline
that estimates your m and u values, before `unlinkables_chart().



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3095</span>
<span class="normal">3096</span>
<span class="normal">3097</span>
<span class="normal">3098</span>
<span class="normal">3099</span>
<span class="normal">3100</span>
<span class="normal">3101</span>
<span class="normal">3102</span>
<span class="normal">3103</span>
<span class="normal">3104</span>
<span class="normal">3105</span>
<span class="normal">3106</span>
<span class="normal">3107</span>
<span class="normal">3108</span>
<span class="normal">3109</span>
<span class="normal">3110</span>
<span class="normal">3111</span>
<span class="normal">3112</span>
<span class="normal">3113</span>
<span class="normal">3114</span>
<span class="normal">3115</span>
<span class="normal">3116</span>
<span class="normal">3117</span>
<span class="normal">3118</span>
<span class="normal">3119</span>
<span class="normal">3120</span>
<span class="normal">3121</span>
<span class="normal">3122</span>
<span class="normal">3123</span>
<span class="normal">3124</span>
<span class="normal">3125</span>
<span class="normal">3126</span>
<span class="normal">3127</span>
<span class="normal">3128</span>
<span class="normal">3129</span>
<span class="normal">3130</span>
<span class="normal">3131</span>
<span class="normal">3132</span>
<span class="normal">3133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">unlinkables_chart</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x_col</span><span class="o">=</span><span class="s2">"match_weight"</span><span class="p">,</span>
    <span class="n">source_dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Generate an interactive chart displaying the proportion of records that</span>
<span class="sd">    are "unlinkable" for a given splink score threshold and model parameters.</span>

<span class="sd">    Unlinkable records are those that, even when compared with themselves, do not</span>
<span class="sd">    contain enough information to confirm a match.</span>

<span class="sd">    Args:</span>
<span class="sd">        x_col (str, optional): Column to use for the x-axis.</span>
<span class="sd">            Defaults to "match_weight".</span>
<span class="sd">        source_dataset (str, optional): Name of the source dataset to use for</span>
<span class="sd">            the title of the output chart.</span>
<span class="sd">        as_dict (bool, optional): If True, return a dict version of the chart.</span>

<span class="sd">    Examples:</span>
<span class="sd">        For the simplest code pipeline, load a pre-trained model</span>
<span class="sd">        and run this against the test data.</span>
<span class="sd">        ```py</span>
<span class="sd">        from splink.datasets import splink_datasets</span>
<span class="sd">        df = splink_datasets.fake_1000</span>
<span class="sd">        linker = DuckDBLinker(df)</span>
<span class="sd">        linker.load_settings("saved_settings.json")</span>
<span class="sd">        linker.unlinkables_chart()</span>
<span class="sd">        ```</span>
<span class="sd">        For more complex code pipelines, you can run an entire pipeline</span>
<span class="sd">        that estimates your m and u values, before `unlinkables_chart().</span>

<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>
<span class="sd">    """</span>

    <span class="c1"># Link our initial df on itself and calculate the % of unlinkable entries</span>
    <span class="n">records</span> <span class="o">=</span> <span class="n">unlinkables_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unlinkables_chart</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">x_col</span><span class="p">,</span> <span class="n">source_dataset</span><span class="p">,</span> <span class="n">as_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splink.linker.Linker.waterfall_chart" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">waterfall_chart</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">filter_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_sensitive_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splink.linker.Linker.waterfall_chart" class="headerlink" title="Permanent link"></a></h2>


  <div class="doc doc-contents ">
  
      <p>Visualise how the final match weight is computed for the provided pairwise
record comparisons.</p>
<p>Records must be provided as a list of dictionaries. This would usually be
obtained from <code>df.as_record_dict(limit=n)</code> where <code>df</code> is a SplinkDataFrame.</p>



<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="n">df</span> <span class="o">=</span> <span class="n">linker</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">threshold_match_weight</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">records</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">as_record_dict</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">linker</span><span class="o">.</span><span class="n">waterfall_chart</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
</code></pre></div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>records</code></td>
          <td>
                <code>List[dict]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Usually be obtained from <code>df.as_record_dict(limit=n)</code>
where <code>df</code> is a SplinkDataFrame.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>filter_nulls</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the visualiation shows null
comparisons, which have no effect on final match weight. Defaults to
True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>remove_sensitive_data</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When True, The waterfall chart will
contain match weights only, and all of the (potentially sensitive) data
from the input tables will be removed prior to the chart being created.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>altair.Chart: An altair chart</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>splink/linker.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3058</span>
<span class="normal">3059</span>
<span class="normal">3060</span>
<span class="normal">3061</span>
<span class="normal">3062</span>
<span class="normal">3063</span>
<span class="normal">3064</span>
<span class="normal">3065</span>
<span class="normal">3066</span>
<span class="normal">3067</span>
<span class="normal">3068</span>
<span class="normal">3069</span>
<span class="normal">3070</span>
<span class="normal">3071</span>
<span class="normal">3072</span>
<span class="normal">3073</span>
<span class="normal">3074</span>
<span class="normal">3075</span>
<span class="normal">3076</span>
<span class="normal">3077</span>
<span class="normal">3078</span>
<span class="normal">3079</span>
<span class="normal">3080</span>
<span class="normal">3081</span>
<span class="normal">3082</span>
<span class="normal">3083</span>
<span class="normal">3084</span>
<span class="normal">3085</span>
<span class="normal">3086</span>
<span class="normal">3087</span>
<span class="normal">3088</span>
<span class="normal">3089</span>
<span class="normal">3090</span>
<span class="normal">3091</span>
<span class="normal">3092</span>
<span class="normal">3093</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">waterfall_chart</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">filter_nulls</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_sensitive_data</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Visualise how the final match weight is computed for the provided pairwise</span>
<span class="sd">    record comparisons.</span>

<span class="sd">    Records must be provided as a list of dictionaries. This would usually be</span>
<span class="sd">    obtained from `df.as_record_dict(limit=n)` where `df` is a SplinkDataFrame.</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```py</span>
<span class="sd">        df = linker.predict(threshold_match_weight=2)</span>
<span class="sd">        records = df.as_record_dict(limit=10)</span>
<span class="sd">        linker.waterfall_chart(records)</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        records (List[dict]): Usually be obtained from `df.as_record_dict(limit=n)`</span>
<span class="sd">            where `df` is a SplinkDataFrame.</span>
<span class="sd">        filter_nulls (bool, optional): Whether the visualiation shows null</span>
<span class="sd">            comparisons, which have no effect on final match weight. Defaults to</span>
<span class="sd">            True.</span>
<span class="sd">        remove_sensitive_data (bool, optional): When True, The waterfall chart will</span>
<span class="sd">            contain match weights only, and all of the (potentially sensitive) data</span>
<span class="sd">            from the input tables will be removed prior to the chart being created.</span>


<span class="sd">    Returns:</span>
<span class="sd">        altair.Chart: An altair chart</span>

<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_raise_error_if_necessary_waterfall_columns_not_computed</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">waterfall_chart</span><span class="p">(</span>
        <span class="n">records</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_settings_obj</span><span class="p">,</span> <span class="n">filter_nulls</span><span class="p">,</span> <span class="n">remove_sensitive_data</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div></div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-03-11T20:11:57+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-03-11</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-03-11T20:11:57+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-03-11</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/RossKen" class="md-author" title="@RossKen">
          
          <img src="https://avatars.githubusercontent.com/u/26222179?v=4&size=72" alt="RossKen">
        </a>
      
        <a href="https://github.com/ThomasHepworth" class="md-author" title="@ThomasHepworth">
          
          <img src="https://avatars.githubusercontent.com/u/45356472?v=4&size=72" alt="ThomasHepworth">
        </a>
      
        <a href="https://github.com/RobinL" class="md-author" title="@RobinL">
          
          <img src="https://avatars.githubusercontent.com/u/2608005?v=4&size=72" alt="RobinL">
        </a>
      
        <a href="https://github.com/mamonu" class="md-author" title="@mamonu">
          
          <img src="https://avatars.githubusercontent.com/u/3820011?v=4&size=72" alt="mamonu">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>


  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="linkerest.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Estimating model parameters">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Estimating model parameters
              </div>
            </div>
          </a>
        
        
          
          <a href="linkermodelviz.html" class="md-footer__link md-footer__link--next" aria-label="Next: Visualisation">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Visualisation
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/moj-analytical-services/splink" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/splink/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.robinlinacre.com/" target="_blank" rel="noopener" title="www.robinlinacre.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://moj-analytical-services.github.io/splink/feed_rss_created.xml" target="_blank" rel="noopener" title="moj-analytical-services.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64zm0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0zm32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "header.autohide", "search.highlight", "search.share", "search.suggest", "navigation.indexes", "navigation.footer", "content.action.edit", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "toc.follow"], "search": "assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.d7c377c4.min.js"></script>
      
        <script src="js/mkdocs-charts-plugin.js"></script>
      
        <script src="js/timeago.min.js"></script>
      
        <script src="js/timeago_mkdocs_material.js"></script>
      
        <script src="javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
      
    
  </body>
</html>